2023-03-11 11:48:39,914 - INFO - Rank 1 | Client Args: Namespace(dataset='./dist/repgnn_data/ogbn_arxiv128/', sampling='10-10', hidden_size=256, n_classes=60, batch_size=8000, dropout=0.2, lr=0.03, weight_decay=0, model_name='gcn', epoch=1, num_worker=1, cache_size=0, seed=None, log=True, dist_url='tcp://10.214.243.19:23456', world_size=2, rank=1, gpu=0, grpc_port='10.214.242.140:18110', mlp_layers=1, block='res+', conv='gen', gcn_aggr='max', norm='batch', t=1.0, p=1.0, y=0.0, learn_t=False, learn_p=False, learn_y=False, msg_norm=False, learn_msg_scale=False, distributed=True)
2023-03-11 11:48:41,929 - INFO - Rank 1 | Added key: store_based_barrier_key:1 to store for rank: 1
2023-03-11 11:48:41,929 - INFO - Rank 1 | Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
2023-03-11 11:48:41,939 - INFO - Rank 1 | Using 2 distributed GPUs in total for training...
2023-03-11 11:48:51,782 - INFO - Rank 1 | Reducer buckets have been rebuilt in this iteration.
2023-03-11 11:48:57,160 - INFO - Rank 1 | rank: 1, iter_num: 7
2023-03-11 11:48:58,771 - INFO - Rank 1 | -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      total epochs time         3.62%     341.802ms        99.09%        9.353s        9.353s     342.540ms         3.63%        9.354s        9.354s             1  
                                             fetch feat         0.20%      18.826ms        77.17%        7.285s        1.041s      22.016ms         0.23%        7.285s        1.041s             7  
                           fetch feat from cache server        73.86%        6.972s        73.87%        6.973s     249.038ms        6.973s        73.90%        6.973s     249.032ms            28  
                        gpu-compute with optimizer.step         0.08%       7.221ms        18.13%        1.711s     244.449ms       7.641ms         0.08%        1.711s     244.444ms             7  
                                           DDP backward         8.89%     839.614ms         8.90%     840.271ms     120.039ms     839.786ms         8.90%     840.243ms     120.035ms             7  
                                            DDP forward         0.01%     546.000us         8.85%     835.287ms     119.327ms     756.000us         0.01%     835.235ms     119.319ms             7  
                        DistributedDataParallel.forward         2.28%     215.465ms         8.84%     834.057ms     119.151ms     316.111ms         3.35%     834.006ms     119.144ms             7  
                                             CopyReduce         0.15%      13.908ms         4.86%     458.665ms      21.841ms     455.332ms         4.83%     460.313ms      21.920ms            21  
                                               aten::to         0.01%     793.000us         2.33%     220.254ms       2.591ms       1.277ms         0.01%     219.635ms       2.584ms            85  
                                         aten::_to_copy         0.02%       1.463ms         2.32%     218.855ms       2.842ms       2.583ms         0.03%     218.358ms       2.836ms            77  
                                            aten::copy_         0.16%      15.121ms         2.31%     217.677ms       1.674ms     216.545ms         2.30%     216.545ms       1.666ms           130  
                             move feats from CPU to GPU         0.02%       2.338ms         2.20%     207.622ms       7.415ms       2.993ms         0.03%     207.392ms       7.407ms            28  
                                          create frames         0.48%      44.957ms         0.52%      49.017ms       1.751ms      45.843ms         0.49%      48.792ms       1.743ms            28  
autograd::engine::evaluate_function: CopyReduceBackw...         0.01%     630.000us         0.32%      30.003ms       2.143ms     909.000us         0.01%      29.784ms       2.127ms            14  
                                     CopyReduceBackward         0.11%      10.597ms         0.31%      29.129ms       2.081ms      24.938ms         0.26%      28.875ms       2.062ms            14  
                                            aten::index         0.24%      23.125ms         0.28%      26.534ms     541.510us      23.990ms         0.25%      25.902ms     528.612us            49  
                                   DDP optimizer.step()         0.00%     361.000us         0.22%      21.143ms       3.020ms     526.000us         0.01%      21.083ms       3.012ms             7  
                               Optimizer.step#Adam.step         0.05%       4.473ms         0.21%      20.272ms       2.896ms       7.475ms         0.08%      20.215ms       2.888ms             7  
    autograd::engine::evaluate_function: AddmmBackward0         0.01%       1.197ms         0.20%      19.205ms     914.524us     880.000us         0.01%      20.047ms     954.619us            21  
                                         AddmmBackward0         0.01%     958.000us         0.14%      13.538ms     644.667us       1.140ms         0.01%      16.351ms     778.619us            21  
                                            get nf_nids         0.09%       8.140ms         0.16%      15.555ms       2.222ms       9.457ms         0.10%      15.478ms       2.211ms             7  
                                               aten::mm         0.04%       4.142ms         0.07%       6.656ms     190.171us      12.593ms         0.13%      12.593ms     359.800us            35  
                                            aten::zeros         0.06%       5.837ms         0.17%      15.678ms      69.372us       7.891ms         0.08%      12.083ms      53.465us           226  
                                           aten::linear         0.00%     319.000us         0.07%       6.574ms     313.048us     321.000us         0.00%      11.516ms     548.381us            21  
                                            aten::empty         0.08%       7.838ms         0.18%      16.665ms      25.404us      11.068ms         0.12%      11.068ms      16.872us           656  
                                            aten::addmm         0.04%       3.353ms         0.05%       5.056ms     240.762us      10.099ms         0.11%      10.431ms     496.714us            21  
autograd::engine::evaluate_function: torch::autograd...         0.04%       3.628ms         0.14%      13.003ms     309.595us       4.418ms         0.05%       9.884ms     235.333us            42  
                                            fetch label         0.01%     672.000us         0.08%       7.666ms       1.095ms     941.000us         0.01%       7.586ms       1.084ms             7  
                                          aten::dropout         0.00%     435.000us         0.05%       4.983ms     237.286us     246.000us         0.00%       7.212ms     343.429us            21  
                                   aten::_fused_dropout         0.01%       1.136ms         0.05%       4.296ms     204.571us       5.033ms         0.05%       6.966ms     331.714us            21  
                                            aten::zero_         0.02%       2.354ms         0.09%       8.388ms      29.851us       4.668ms         0.05%       6.206ms      22.085us           281  
autograd::engine::evaluate_function: FusedDropoutBac...         0.01%     535.000us         0.05%       5.071ms     362.214us     339.000us         0.00%       6.144ms     438.857us            14  
                                  FusedDropoutBackward0         0.00%     449.000us         0.05%       4.267ms     304.786us     434.000us         0.00%       5.805ms     414.643us            14  
                                              aten::div         0.02%       2.223ms         0.05%       4.569ms      59.338us       5.690ms         0.06%       5.690ms      73.896us            77  
                  convert byte features to float tensor         0.03%       3.096ms         0.06%       5.729ms     204.607us       3.820ms         0.04%       5.491ms     196.107us            28  
                                       aten::empty_like         0.01%       1.015ms         0.07%       6.495ms      86.600us       1.638ms         0.02%       5.485ms      73.133us            75  
                                    aten::_masked_scale         0.01%     833.000us         0.04%       3.582ms     255.857us       3.392ms         0.04%       5.371ms     383.643us            14  
                                                aten::t         0.02%       2.143ms         0.09%       8.773ms      89.520us       2.334ms         0.02%       5.125ms      52.296us            98  
                                        aten::clamp_min         0.01%     769.000us         0.03%       3.110ms      63.469us       2.505ms         0.03%       4.685ms      95.612us            49  
autograd::engine::evaluate_function: NllLossBackward...         0.00%     465.000us         0.05%       4.852ms     693.143us     270.000us         0.00%       4.455ms     636.429us             7  
                                asign frame to nodeflow         0.04%       3.981ms         0.05%       4.663ms     166.536us       4.220ms         0.04%       4.428ms     158.143us            28  
                                       NllLossBackward0         0.00%     297.000us         0.04%       4.063ms     580.429us     282.000us         0.00%       4.185ms     597.857us             7  
                                    aten::empty_strided         0.03%       3.089ms         0.06%       5.285ms      38.297us       4.099ms         0.04%       4.099ms      29.703us           138  
                                aten::nll_loss_backward         0.01%     515.000us         0.04%       3.654ms     522.000us       1.124ms         0.01%       3.903ms     557.571us             7  
                                     DDP calculate loss         0.01%     540.000us         0.03%       3.263ms     466.143us     379.000us         0.00%       3.864ms     552.000us             7  
     autograd::engine::evaluate_function: ReluBackward0         0.00%     440.000us         0.03%       2.513ms     179.500us      94.000us         0.00%       3.766ms     269.000us            14  
                                         aten::randperm         0.02%       1.857ms         0.04%       3.781ms       1.891ms       1.883ms         0.02%       3.753ms       1.877ms             2  
                                            aten::slice         0.02%       2.003ms         0.05%       5.002ms      44.661us       2.731ms         0.03%       3.702ms      33.054us           112  
                                          ReluBackward0         0.00%     389.000us         0.02%       1.859ms     132.786us     237.000us         0.00%       3.672ms     262.286us            14  
                                       aten::as_strided         0.04%       3.722ms         0.08%       7.574ms      20.470us       3.504ms         0.04%       3.504ms       9.470us           370  
                               aten::cross_entropy_loss         0.00%     149.000us         0.03%       2.607ms     372.429us     195.000us         0.00%       3.448ms     492.571us             7  
                               aten::threshold_backward         0.01%     784.000us         0.01%       1.255ms      89.643us       3.435ms         0.04%       3.435ms     245.357us            14  
                                             aten::add_         0.03%       2.758ms         0.05%       5.158ms      42.983us       3.353ms         0.04%       3.353ms      27.942us           120  
        autograd::engine::evaluate_function: TBackward0         0.01%     547.000us         0.04%       3.598ms     171.333us     817.000us         0.01%       3.216ms     153.143us            21  
                                          aten::reshape         0.01%       1.262ms         0.04%       4.007ms      38.162us       1.807ms         0.02%       2.977ms      28.352us           105  
                                       aten::zeros_like         0.00%     252.000us         0.03%       3.136ms     261.333us     595.000us         0.01%       2.954ms     246.167us            12  
                                        aten::new_empty         0.01%     626.000us         0.04%       3.689ms      65.875us     930.000us         0.01%       2.894ms      51.679us            56  
                                        aten::transpose         0.02%       1.422ms         0.06%       5.273ms      53.806us       1.862ms         0.02%       2.791ms      28.480us            98  
                                      aten::nll_loss_nd         0.00%      81.000us         0.02%       1.841ms     263.000us      99.000us         0.00%       2.710ms     387.143us             7  
                        torch::autograd::AccumulateGrad         0.01%     904.000us         0.05%       4.448ms     105.905us       1.115ms         0.01%       2.694ms      64.143us            42  
                                         aten::nll_loss         0.00%      97.000us         0.02%       1.723ms     246.143us      91.000us         0.00%       2.611ms     373.000us             7  
                                              aten::sum         0.02%       1.878ms         0.04%       3.316ms     157.905us       2.587ms         0.03%       2.587ms     123.190us            21  
                                     train data prepare         0.03%       2.497ms         0.03%       2.527ms       2.527ms       2.515ms         0.03%       2.520ms       2.520ms             1  
                                 aten::nll_loss_forward         0.00%     219.000us         0.02%       1.596ms     228.000us       2.458ms         0.03%       2.520ms     360.000us             7  
                                             TBackward0         0.00%     339.000us         0.03%       2.731ms     130.048us     656.000us         0.01%       2.399ms     114.238us            21  
                                             aten::sqrt         0.01%     954.000us         0.03%       2.713ms      64.595us       2.374ms         0.03%       2.374ms      56.524us            42  
                                             aten::relu         0.00%     310.000us         0.02%       1.833ms     130.929us      45.000us         0.00%       2.292ms     163.714us            14  
                                             aten::mul_         0.02%       1.465ms         0.03%       2.756ms      32.810us       2.038ms         0.02%       2.038ms      24.262us            84  
                                              aten::mul         0.02%       1.719ms         0.03%       3.033ms      72.214us       1.977ms         0.02%       1.977ms      47.071us            42  
                                            aten::fill_         0.02%       1.811ms         0.05%       5.065ms      61.024us       1.847ms         0.02%       1.847ms      22.253us            83  
                                           aten::unbind         0.00%     281.000us         0.02%       1.902ms     271.714us     653.000us         0.01%       1.831ms     261.571us             7  
                                   DDP optimizer.zero()         0.00%     203.000us         0.02%       2.105ms     300.714us     155.000us         0.00%       1.743ms     249.000us             7  
                     Optimizer.zero_grad#Adam.zero_grad         0.00%     299.000us         0.02%       1.543ms     220.429us     527.000us         0.01%       1.481ms     211.571us             7  
                                             aten::item         0.01%     542.000us         0.02%       1.706ms      40.619us     915.000us         0.01%       1.291ms      30.738us            42  
                                              aten::cat         0.00%     170.000us         0.01%       1.337ms     191.000us     237.000us         0.00%       1.266ms     180.857us             7  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%     228.000us         0.01%       1.314ms     187.714us     333.000us         0.00%       1.213ms     173.286us             7  
                                           aten::select         0.00%     432.000us         0.02%       1.546ms      36.810us     831.000us         0.01%       1.178ms      28.048us            42  
                                   aten::_reshape_alias         0.01%       1.277ms         0.02%       1.992ms      18.971us       1.170ms         0.01%       1.170ms      11.143us           105  
                                         aten::addcmul_         0.01%     804.000us         0.02%       1.462ms      34.810us       1.133ms         0.01%       1.133ms      26.976us            42  
                                         aten::addcdiv_         0.01%     779.000us         0.01%       1.412ms      33.619us       1.073ms         0.01%       1.073ms      25.548us            42  
                                             aten::_cat         0.00%     326.000us         0.01%       1.093ms     156.143us     526.000us         0.01%       1.029ms     147.000us             7  
                                    LogSoftmaxBackward0         0.00%     282.000us         0.01%     973.000us     139.000us     403.000us         0.00%     880.000us     125.714us             7  
                                            aten::clamp         0.01%     529.000us         0.01%       1.259ms      59.952us     353.000us         0.00%     643.000us      30.619us            21  
                                      aten::log_softmax         0.00%     110.000us         0.01%     581.000us      83.000us     189.000us         0.00%     543.000us      77.571us             7  
                                         aten::new_ones         0.00%     226.000us         0.02%       2.249ms     107.095us      94.000us         0.00%     518.000us      24.667us            21  
                       aten::_log_softmax_backward_data         0.00%     340.000us         0.01%     587.000us      83.857us     477.000us         0.01%     477.000us      68.143us             7  
                                             aten::ones         0.00%     303.000us         0.02%       1.874ms      89.238us     172.000us         0.00%     424.000us      20.190us            21  
                                        aten::ones_like         0.00%      58.000us         0.00%     462.000us      66.000us     132.000us         0.00%     423.000us      60.429us             7  
                aten::_has_compatible_shallow_copy_type         0.00%     384.000us         0.01%     831.000us      14.839us     395.000us         0.00%     395.000us       7.054us            56  
                              aten::_local_scalar_dense         0.00%     353.000us         0.01%     748.000us      17.810us     376.000us         0.00%     376.000us       8.952us            42  
                                           aten::narrow         0.00%      82.000us         0.00%     411.000us      58.714us     149.000us         0.00%     348.000us      49.714us             7  
                                           aten::expand         0.00%     160.000us         0.01%     495.000us      23.571us     231.000us         0.00%     332.000us      15.810us            21  
                                     aten::_log_softmax         0.00%     245.000us         0.00%     360.000us      51.429us     318.000us         0.00%     318.000us      45.429us             7  
                                     aten::resolve_conj         0.00%     297.000us         0.01%     630.000us      15.000us     302.000us         0.00%     302.000us       7.190us            42  
                                      aten::resolve_neg         0.00%     267.000us         0.01%     595.000us      14.167us     282.000us         0.00%     282.000us       6.714us            42  
                                             aten::view         0.01%     489.000us         0.01%     800.000us      38.095us     229.000us         0.00%     229.000us      10.905us            21  
                                           aten::detach         0.00%      81.000us         0.00%     348.000us      58.000us     129.000us         0.00%     209.000us      34.833us             6  
                                          aten::resize_         0.00%     357.000us         0.01%     910.000us      24.595us     171.000us         0.00%     171.000us       4.622us            37  
                                             aten::set_         0.00%     152.000us         0.00%     276.000us      30.667us     166.000us         0.00%     166.000us      18.444us             9  
                                                 detach         0.00%      94.000us         0.00%     166.000us      27.667us      80.000us         0.00%      80.000us      13.333us             6  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 9.440s
Self CUDA time total: 9.435s

2023-03-11 11:48:58,771 - INFO - Rank 1 | wait sampler total time: 0.3352322578430176, total iters: 7, avg iter time:0.04789032254900251
