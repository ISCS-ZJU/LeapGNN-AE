2023-03-12 21:48:21,723 - INFO - Rank 0 | Client Args: Namespace(dataset='./dist/repgnn_data/ogbn_products0/', sampling='10-10', hidden_size=256, n_classes=60, batch_size=800, dropout=0.2, lr=0.03, weight_decay=0, model_name='gcn', epoch=1, num_worker=1, cache_size=0, seed=None, log=True, dist_url='tcp://10.214.243.19:23456', world_size=2, rank=0, gpu=0, grpc_port='10.214.243.19:18110', mlp_layers=1, block='res+', conv='gen', gcn_aggr='max', norm='batch', t=1.0, p=1.0, y=0.0, learn_t=False, learn_p=False, learn_y=False, msg_norm=False, learn_msg_scale=False, distributed=True)
2023-03-12 21:48:22,495 - INFO - Rank 0 | Added key: store_based_barrier_key:1 to store for rank: 0
2023-03-12 21:48:22,506 - INFO - Rank 0 | Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
2023-03-12 21:48:22,506 - INFO - Rank 0 | Using 2 distributed GPUs in total for training...
2023-03-12 21:49:01,092 - INFO - Rank 0 | Reducer buckets have been rebuilt in this iteration.
2023-03-12 22:21:38,027 - INFO - Rank 0 | rank: 0, iter_num: 995
2023-03-12 22:26:25,779 - INFO - Rank 0 | -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      total epochs time         0.40%        7.962s        99.64%     1980.987s     1980.987s        8.021s         0.40%     1980.975s     1980.975s             1  
                                             fetch feat         0.20%        4.001s        69.98%     1391.203s        1.398s        4.254s         0.21%     1391.185s        1.398s           995  
                           fetch feat from cache server        66.06%     1313.287s        67.72%     1346.343s     338.277ms     1315.079s        66.16%     1346.312s     338.269ms          3980  
                        gpu-compute with optimizer.step         0.07%        1.458s        29.24%      581.268s     584.188ms        1.518s         0.08%      581.257s     584.178ms           995  
                                           DDP backward        25.60%      508.895s        25.60%      508.973s     511.530ms      508.909s        25.60%      508.964s     511.522ms           995  
                                            DDP forward         0.00%      45.403ms         3.44%       68.491s      68.835ms      64.281ms         0.00%       68.485s      68.829ms           995  
                        DistributedDataParallel.forward         2.74%       54.533s         3.44%       68.393s      68.737ms       56.902s         2.86%       68.387s      68.731ms           995  
                                            aten::copy_         1.47%       29.202s         2.48%       49.355s     801.873us       48.915s         2.46%       48.915s     794.727us         61550  
                             move feats from CPU to GPU         0.28%        5.627s         1.29%       25.685s       6.453ms        5.705s         0.29%       25.658s       6.447ms          3980  
                                               aten::to         0.02%     399.187ms         1.10%       21.868s       1.831ms     440.382ms         0.02%       21.803s       1.826ms         11941  
                                         aten::_to_copy         0.01%     137.424ms         1.08%       21.418s       1.957ms     245.288ms         0.01%       21.362s       1.952ms         10945  
                                          create frames         0.62%       12.248s         0.63%       12.503s       3.142ms       12.353s         0.62%       12.479s       3.135ms          3980  
                                             CopyReduce         0.05%        1.035s         0.17%        3.302s       1.106ms        4.362s         0.22%        4.850s       1.625ms          2985  
                                            aten::index         0.15%        3.015s         0.17%        3.384s     485.884us        3.117s         0.16%        3.314s     475.871us          6965  
                                            aten::slice         0.06%        1.147s         0.16%        3.247s      32.087us        1.784s         0.09%        2.448s      24.191us        101198  
autograd::engine::evaluate_function: CopyReduceBackw...         0.00%      59.594ms         0.11%        2.162s       1.087ms      83.724ms         0.00%        2.142s       1.077ms          1990  
                                     CopyReduceBackward         0.05%     897.978ms         0.10%        2.080s       1.045ms        1.855s         0.09%        2.059s       1.035ms          1990  
    autograd::engine::evaluate_function: AddmmBackward0         0.01%     118.103ms         0.09%        1.776s     594.826us     157.566ms         0.01%        1.791s     600.097us          2985  
                                   DDP optimizer.step()         0.00%      35.164ms         0.08%        1.654s       1.662ms      51.723ms         0.00%        1.648s       1.656ms           995  
                                          aten::reshape         0.04%     795.659ms         0.12%        2.466s      45.177us     953.508ms         0.05%        1.592s      29.162us         54579  
                               Optimizer.step#Adam.step         0.02%     365.179ms         0.08%        1.567s       1.575ms     634.452ms         0.03%        1.561s       1.569ms           995  
                                            get nf_nids         0.03%     563.751ms         0.07%        1.367s       1.374ms     711.004ms         0.04%        1.359s       1.366ms           995  
                                         AddmmBackward0         0.00%      94.463ms         0.06%        1.287s     431.280us     180.296ms         0.01%        1.207s     404.481us          2985  
autograd::engine::evaluate_function: torch::autograd...         0.01%     291.840ms         0.06%        1.172s     196.374us     396.322ms         0.02%     996.076ms     166.847us          5970  
                                       aten::as_strided         0.05%     948.764ms         0.10%        1.959s      14.297us     953.294ms         0.05%     953.294ms       6.957us        137024  
                                            aten::zeros         0.02%     301.796ms         0.06%        1.135s      40.728us     616.373ms         0.03%     942.419ms      33.825us         27862  
                                          aten::dropout         0.00%      34.923ms         0.02%     416.056ms     139.382us      37.259ms         0.00%     761.706ms     255.178us          2985  
                                   aten::_fused_dropout         0.01%     107.485ms         0.02%     349.525ms     117.094us     572.620ms         0.03%     724.447ms     242.696us          2985  
                                                aten::t         0.01%     218.906ms         0.05%     921.918ms      66.182us     283.077ms         0.01%     671.378ms      48.197us         13930  
                                   aten::_reshape_alias         0.03%     651.845ms         0.05%        1.012s      18.542us     638.114ms         0.03%     638.114ms      11.692us         54579  
                                            aten::empty         0.04%     748.050ms         0.06%        1.173s      14.034us     637.029ms         0.03%     637.029ms       7.621us         83592  
                                           aten::linear         0.00%      31.647ms         0.03%     538.925ms     180.544us      41.027ms         0.00%     630.714ms     211.294us          2985  
                                               aten::mm         0.02%     364.617ms         0.03%     575.777ms     115.734us     608.723ms         0.03%     608.723ms     122.356us          4975  
                                            aten::addmm         0.01%     238.191ms         0.02%     372.982ms     124.952us     480.541ms         0.02%     518.239ms     173.614us          2985  
autograd::engine::evaluate_function: FusedDropoutBac...         0.00%      58.239ms         0.02%     386.910ms     194.427us      60.054ms         0.00%     428.999ms     215.577us          1990  
                                asign frame to nodeflow         0.02%     361.023ms         0.02%     430.024ms     108.046us     386.735ms         0.02%     406.682ms     102.181us          3980  
                                             aten::add_         0.02%     305.646ms         0.03%     553.165ms      30.896us     397.931ms         0.02%     397.931ms      22.226us         17904  
                                              aten::sum         0.01%     158.676ms         0.01%     254.231ms      85.170us     394.167ms         0.02%     394.167ms     132.049us          2985  
                                        aten::transpose         0.01%     155.709ms         0.03%     567.520ms      40.741us     264.760ms         0.01%     388.301ms      27.875us         13930  
                                              aten::div         0.01%     227.982ms         0.02%     368.593ms      33.677us     386.617ms         0.02%     386.617ms      35.324us         10945  
                                            aten::zero_         0.01%     232.998ms         0.03%     578.239ms      16.600us     240.459ms         0.01%     373.404ms      10.720us         34833  
                                  FusedDropoutBackward0         0.00%      33.152ms         0.02%     304.226ms     152.877us      48.084ms         0.00%     368.945ms     185.399us          1990  
                                        aten::clamp_min         0.00%      91.011ms         0.01%     270.011ms      38.767us     189.267ms         0.01%     336.931ms      48.375us          6965  
        autograd::engine::evaluate_function: TBackward0         0.00%      54.077ms         0.02%     370.673ms     124.179us      83.925ms         0.00%     333.332ms     111.669us          2985  
                                            fetch label         0.00%      36.167ms         0.02%     328.924ms     330.577us      53.655ms         0.00%     323.905ms     325.533us           995  
                        torch::autograd::AccumulateGrad         0.00%      88.396ms         0.02%     427.428ms      71.596us     137.064ms         0.01%     323.188ms      54.135us          5970  
                                    aten::_masked_scale         0.00%      76.493ms         0.01%     248.510ms     124.879us     220.910ms         0.01%     320.861ms     161.237us          1990  
     autograd::engine::evaluate_function: ReluBackward0         0.00%      44.053ms         0.01%     239.776ms     120.490us      41.028ms         0.00%     288.153ms     144.801us          1990  
                                   DDP optimizer.zero()         0.00%      23.462ms         0.01%     282.392ms     283.811us      36.652ms         0.00%     277.777ms     279.173us           995  
                                       aten::empty_like         0.00%      88.308ms         0.02%     330.564ms      36.865us     140.906ms         0.01%     275.214ms      30.692us          8967  
autograd::engine::evaluate_function: NllLossBackward...         0.00%      46.737ms         0.02%     312.440ms     314.010us      51.485ms         0.00%     272.825ms     274.196us           995  
                                    aten::empty_strided         0.01%     276.178ms         0.02%     356.623ms      19.899us     262.742ms         0.01%     262.742ms      14.660us         17922  
                                             TBackward0         0.00%      37.877ms         0.01%     285.416ms      95.617us      67.834ms         0.00%     249.407ms      83.553us          2985  
                                          ReluBackward0         0.00%      34.637ms         0.01%     174.062ms      87.468us      37.694ms         0.00%     247.125ms     124.183us          1990  
                                             aten::mul_         0.01%     164.311ms         0.01%     290.170ms      24.302us     223.005ms         0.01%     223.005ms      18.677us         11940  
                                       NllLossBackward0         0.00%      22.965ms         0.01%     233.950ms     235.126us      37.904ms         0.00%     221.340ms     222.452us           995  
                                     DDP calculate loss         0.00%      56.872ms         0.01%     222.475ms     223.593us      41.010ms         0.00%     218.675ms     219.774us           995  
                     Optimizer.zero_grad#Adam.zero_grad         0.00%      42.137ms         0.01%     220.892ms     222.002us      71.008ms         0.00%     215.632ms     216.716us           995  
                                        aten::new_empty         0.00%      75.223ms         0.01%     286.376ms      35.977us     112.625ms         0.01%     215.245ms      27.041us          7960  
                               aten::threshold_backward         0.00%      71.872ms         0.01%     118.740ms      59.668us     209.431ms         0.01%     209.431ms     105.242us          1990  
                                           aten::unbind         0.00%      27.686ms         0.01%     214.063ms     215.139us      69.239ms         0.00%     206.472ms     207.510us           995  
                                              aten::mul         0.01%     153.479ms         0.01%     277.390ms      46.464us     197.810ms         0.01%     197.810ms      33.134us          5970  
                                aten::nll_loss_backward         0.00%      55.249ms         0.01%     193.815ms     194.789us      84.596ms         0.00%     183.436ms     184.358us           995  
                                             aten::relu         0.00%      31.126ms         0.01%     160.705ms      80.756us      16.503ms         0.00%     181.825ms      91.369us          1990  
                                            aten::fill_         0.01%     156.245ms         0.01%     274.145ms      25.034us     174.708ms         0.01%     174.708ms      15.954us         10951  
                               aten::cross_entropy_loss         0.00%      10.801ms         0.01%     152.011ms     152.775us      17.205ms         0.00%     173.699ms     174.572us           995  
                                             aten::item         0.00%      57.423ms         0.01%     187.560ms      31.417us      94.674ms         0.00%     142.428ms      23.857us          5970  
                                           aten::select         0.00%      56.807ms         0.01%     179.638ms      30.090us      99.479ms         0.01%     137.233ms      22.987us          5970  
                                              aten::cat         0.00%      16.776ms         0.01%     139.497ms     140.198us      23.375ms         0.00%     131.902ms     132.565us           995  
                                             aten::sqrt         0.01%     101.660ms         0.01%     164.093ms      27.486us     131.330ms         0.01%     131.330ms      21.998us          5970  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%      24.346ms         0.01%     128.966ms     129.614us      35.270ms         0.00%     118.715ms     119.312us           995  
                                         aten::addcdiv_         0.00%      84.339ms         0.01%     146.139ms      24.479us     116.448ms         0.01%     116.448ms      19.506us          5970  
                                         aten::addcmul_         0.00%      84.136ms         0.01%     147.122ms      24.644us     113.834ms         0.01%     113.834ms      19.068us          5970  
                                             aten::_cat         0.00%      30.824ms         0.01%     115.675ms     116.256us      53.010ms         0.00%     108.527ms     109.072us           995  
                                      aten::nll_loss_nd         0.00%       8.396ms         0.00%      77.647ms      78.037us      10.396ms         0.00%     100.844ms     101.351us           995  
                                         aten::new_ones         0.00%      26.208ms         0.01%     218.597ms      73.232us      23.237ms         0.00%      97.836ms      32.776us          2985  
                                         aten::nll_loss         0.00%       8.488ms         0.00%      66.787ms      67.123us       9.668ms         0.00%      90.448ms      90.903us           995  
                                    LogSoftmaxBackward0         0.00%      22.796ms         0.00%      93.377ms      93.846us      35.467ms         0.00%      83.445ms      83.864us           995  
                                 aten::nll_loss_forward         0.00%      25.879ms         0.00%      55.257ms      55.535us      74.208ms         0.00%      80.780ms      81.186us           995  
                                             aten::ones         0.00%      34.568ms         0.01%     174.561ms      58.479us      37.414ms         0.00%      74.599ms      24.991us          2985  
                                            aten::clamp         0.00%      58.005ms         0.01%     138.032ms      46.242us      35.011ms         0.00%      71.838ms      24.066us          2985  
                                      aten::log_softmax         0.00%      11.924ms         0.00%      59.991ms      60.292us      18.707ms         0.00%      55.650ms      55.930us           995  
                                        aten::ones_like         0.00%       8.636ms         0.00%      56.380ms      56.663us      14.614ms         0.00%      51.518ms      51.777us           995  
                       aten::_log_softmax_backward_data         0.00%      34.557ms         0.00%      59.697ms      59.997us      47.978ms         0.00%      47.978ms      48.219us           995  
                              aten::_local_scalar_dense         0.00%      45.322ms         0.00%      89.841ms      15.049us      47.754ms         0.00%      47.754ms       7.999us          5970  
                                           aten::narrow         0.00%      10.348ms         0.00%      46.242ms      46.474us      16.734ms         0.00%      39.131ms      39.328us           995  
                                           aten::expand         0.00%      23.048ms         0.00%      59.324ms      19.874us      27.003ms         0.00%      37.698ms      12.629us          2985  
                                     train data prepare         0.00%      34.487ms         0.00%      34.507ms      34.507ms      34.497ms         0.00%      34.501ms      34.501ms             1  
                                         aten::randperm         0.00%      16.967ms         0.00%      34.001ms      17.000ms      16.989ms         0.00%      33.984ms      16.992ms             2  
                                     aten::_log_softmax         0.00%      25.301ms         0.00%      37.134ms      37.321us      33.012ms         0.00%      33.012ms      33.178us           995  
                                             aten::view         0.00%      43.855ms         0.00%      82.052ms      27.488us      32.181ms         0.00%      32.181ms      10.781us          2985  
                                     aten::resolve_conj         0.00%      37.815ms         0.00%      72.243ms      12.101us      31.965ms         0.00%      31.965ms       5.354us          5970  
                                      aten::resolve_neg         0.00%      35.565ms         0.00%      69.820ms      11.695us      30.784ms         0.00%      30.784ms       5.156us          5970  
                                          aten::resize_         0.00%      42.939ms         0.00%      61.465ms      12.350us      21.947ms         0.00%      21.947ms       4.410us          4977  
                aten::_has_compatible_shallow_copy_type         0.00%      21.656ms         0.00%      42.755ms      10.742us      18.571ms         0.00%      18.571ms       4.666us          3980  
                                             aten::set_         0.00%      12.406ms         0.00%      20.292ms      20.353us      11.393ms         0.00%      11.393ms      11.427us           997  
                                       aten::zeros_like         0.00%     228.000us         0.00%       1.981ms     165.083us     489.000us         0.00%       1.838ms     153.167us            12  
                                           aten::detach         0.00%      53.000us         0.00%     220.000us      36.667us      96.000us         0.00%     155.000us      25.833us             6  
                                                 detach         0.00%      68.000us         0.00%     117.000us      19.500us      59.000us         0.00%      59.000us       9.833us             6  
                                    aten::scalar_tensor         0.00%      10.000us         0.00%      14.000us      14.000us       9.000us         0.00%       9.000us       9.000us             1  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 1988.132s
Self CUDA time total: 1987.616s

2023-03-12 22:26:25,780 - INFO - Rank 0 | wait sampler total time: 7.820415496826172, total iters: 995, avg iter time:0.007859714067161981
