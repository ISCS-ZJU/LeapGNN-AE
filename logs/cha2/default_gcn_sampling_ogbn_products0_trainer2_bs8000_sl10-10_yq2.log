2023-03-13 10:28:58,648 - INFO - Rank 0 | Client Args: Namespace(dataset='./dist/repgnn_data/ogbn_products0/', sampling='10-10', hidden_size=256, n_classes=60, batch_size=8000, dropout=0.2, lr=0.03, weight_decay=0, model_name='gcn', epoch=1, num_worker=1, cache_size=0, seed=None, log=True, dist_url='tcp://10.214.243.19:23456', world_size=2, rank=0, gpu=0, grpc_port='10.214.243.19:18110', mlp_layers=1, block='res+', conv='gen', gcn_aggr='max', norm='batch', t=1.0, p=1.0, y=0.0, learn_t=False, learn_p=False, learn_y=False, msg_norm=False, learn_msg_scale=False, distributed=True)
2023-03-13 10:28:59,168 - INFO - Rank 0 | Added key: store_based_barrier_key:1 to store for rank: 0
2023-03-13 10:28:59,169 - INFO - Rank 0 | Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
2023-03-13 10:28:59,169 - INFO - Rank 0 | Using 2 distributed GPUs in total for training...
2023-03-13 10:29:50,922 - INFO - Rank 0 | Reducer buckets have been rebuilt in this iteration.
2023-03-13 10:45:47,758 - INFO - Rank 0 | rank: 0, iter_num: 100
2023-03-13 10:46:45,527 - INFO - Rank 0 | -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      total epochs time         1.04%       10.335s        99.84%      994.468s      994.468s       10.341s         1.04%      994.463s      994.463s             1  
                                             fetch feat         0.19%        1.878s        79.87%      795.591s        7.956s        1.904s         0.19%      795.586s        7.956s           100  
                           fetch feat from cache server        76.53%      762.246s        78.01%      777.013s        1.943s      762.976s        76.60%      777.006s        1.943s           400  
                        gpu-compute with optimizer.step         0.02%     215.362ms        18.91%      188.361s        1.884s     219.801ms         0.02%      188.359s        1.884s           100  
                                           DDP backward        12.27%      122.226s        12.27%      122.236s        1.222s      122.219s        12.27%      122.223s        1.222s           100  
                                            DDP forward         0.00%       5.965ms         6.59%       65.619s     656.187ms       7.845ms         0.00%       65.618s     656.177ms           100  
                        DistributedDataParallel.forward         6.02%       59.955s         6.59%       65.607s     656.071ms       59.736s         6.00%       65.606s     656.061ms           100  
                                            aten::copy_         1.29%       12.824s         2.10%       20.891s       1.034ms       20.735s         2.08%       20.735s       1.026ms         20204  
                             move feats from CPU to GPU         0.32%        3.170s         1.12%       11.117s      27.792ms        3.180s         0.32%       11.114s      27.785ms           400  
                                               aten::to         0.00%      10.302ms         0.84%        8.322s       6.929ms      16.348ms         0.00%        8.315s       6.923ms          1201  
                                         aten::_to_copy         0.00%      18.289ms         0.83%        8.305s       7.550ms      31.580ms         0.00%        8.299s       7.544ms          1100  
                                          create frames         0.53%        5.320s         0.54%        5.345s      13.362ms        5.330s         0.54%        5.342s      13.356ms           400  
                                             CopyReduce         0.01%     115.518ms         0.16%        1.636s       5.452ms        3.222s         0.32%        3.346s      11.153ms           300  
                                            aten::index         0.16%        1.620s         0.17%        1.674s       2.391ms        1.633s         0.16%        1.661s       2.373ms           700  
                                            aten::slice         0.05%     509.028ms         0.13%        1.281s      33.450us     744.664ms         0.07%     984.331ms      25.703us         38296  
autograd::engine::evaluate_function: CopyReduceBackw...         0.00%       6.554ms         0.09%     862.256ms       4.311ms       8.676ms         0.00%     855.376ms       4.277ms           200  
                                     CopyReduceBackward         0.01%     118.087ms         0.09%     853.601ms       4.268ms     806.578ms         0.08%     846.700ms       4.234ms           200  
                                          aten::reshape         0.03%     320.825ms         0.09%     930.230ms      47.709us     382.753ms         0.04%     612.133ms      31.395us         19498  
    autograd::engine::evaluate_function: AddmmBackward0         0.00%      11.322ms         0.02%     182.300ms     607.667us      10.517ms         0.00%     306.615ms       1.022ms           300  
                                       aten::as_strided         0.03%     256.332ms         0.05%     540.901ms      12.909us     261.441ms         0.03%     261.441ms       6.239us         41902  
                                           aten::linear         0.00%       3.463ms         0.01%      65.042ms     216.807us       3.647ms         0.00%     254.274ms     847.580us           300  
                                            aten::addmm         0.00%      32.231ms         0.00%      46.778ms     155.927us     241.704ms         0.02%     245.019ms     816.730us           300  
                                          aten::dropout         0.00%       4.330ms         0.01%      50.852ms     169.507us       3.430ms         0.00%     238.533ms     795.110us           300  
                                   aten::_fused_dropout         0.00%      13.329ms         0.00%      43.356ms     144.520us     217.414ms         0.02%     235.103ms     783.677us           300  
                                   aten::_reshape_alias         0.02%     234.408ms         0.04%     364.403ms      18.689us     229.380ms         0.02%     229.380ms      11.764us         19498  
                                   DDP optimizer.step()         0.00%       4.518ms         0.02%     213.514ms       2.135ms       6.696ms         0.00%     212.788ms       2.128ms           100  
                                         AddmmBackward0         0.00%       9.698ms         0.01%     133.186ms     443.953us      12.901ms         0.00%     205.565ms     685.217us           300  
                               Optimizer.step#Adam.step         0.00%      47.036ms         0.02%     202.462ms       2.025ms      82.427ms         0.01%     201.720ms       2.017ms           100  
                                        aten::clamp_min         0.00%       9.584ms         0.00%      29.978ms      42.826us      86.057ms         0.01%     168.487ms     240.696us           700  
                                               aten::mm         0.00%      42.942ms         0.01%      65.945ms     131.890us     164.047ms         0.02%     164.047ms     328.094us           500  
                                              aten::div         0.00%      27.534ms         0.00%      44.261ms      40.237us     132.974ms         0.01%     132.974ms     120.885us          1100  
     autograd::engine::evaluate_function: ReluBackward0         0.00%       4.508ms         0.00%      25.195ms     125.975us       1.602ms         0.00%     125.790ms     628.950us           200  
                                          ReluBackward0         0.00%       3.464ms         0.00%      18.174ms      90.870us       2.931ms         0.00%     124.188ms     620.940us           200  
                               aten::threshold_backward         0.00%       7.100ms         0.00%      11.386ms      56.930us     121.257ms         0.01%     121.257ms     606.285us           200  
                                            fetch label         0.00%       4.907ms         0.01%     121.639ms       1.216ms       6.835ms         0.00%     120.303ms       1.203ms           100  
autograd::engine::evaluate_function: FusedDropoutBac...         0.00%       5.574ms         0.00%      41.348ms     206.740us       3.422ms         0.00%     120.135ms     600.675us           200  
                                  FusedDropoutBackward0         0.00%       3.392ms         0.00%      33.759ms     168.795us       6.038ms         0.00%     116.713ms     583.565us           200  
                                    aten::_masked_scale         0.00%       7.993ms         0.00%      26.877ms     134.385us      99.312ms         0.01%     110.675ms     553.375us           200  
                                            get nf_nids         0.00%      44.049ms         0.01%      97.837ms     978.370us      54.053ms         0.01%      97.283ms     972.830us           100  
                                            aten::zeros         0.00%      31.566ms         0.01%     119.147ms      42.522us      61.196ms         0.01%      95.991ms      34.258us          2802  
                                              aten::sum         0.00%      17.721ms         0.00%      28.004ms      93.347us      88.120ms         0.01%      88.120ms     293.733us           300  
                                             aten::relu         0.00%       3.525ms         0.00%      17.439ms      87.195us       1.530ms         0.00%      85.737ms     428.685us           200  
                                            aten::empty         0.01%      82.115ms         0.01%     135.600ms      16.120us      79.105ms         0.01%      79.105ms       9.404us          8412  
autograd::engine::evaluate_function: torch::autograd...         0.00%      28.376ms         0.01%     105.690ms     176.150us      18.686ms         0.00%      63.711ms     106.185us           600  
                                     DDP calculate loss         0.00%       7.036ms         0.00%      28.557ms     285.570us       4.466ms         0.00%      53.711ms     537.110us           100  
                               aten::cross_entropy_loss         0.00%       1.306ms         0.00%      20.129ms     201.290us       2.030ms         0.00%      48.823ms     488.230us           100  
                                asign frame to nodeflow         0.00%      43.815ms         0.01%      50.443ms     126.108us      46.116ms         0.00%      48.171ms     120.427us           400  
                                                aten::t         0.00%      22.860ms         0.01%      85.882ms      61.344us      20.566ms         0.00%      47.698ms      34.070us          1400  
                                    aten::empty_strided         0.00%      39.024ms         0.01%      56.477ms      31.168us      44.253ms         0.00%      44.253ms      24.422us          1812  
                                             aten::add_         0.00%      33.938ms         0.01%      60.422ms      33.680us      41.304ms         0.00%      41.304ms      23.023us          1794  
                                      aten::nll_loss_nd         0.00%     851.000us         0.00%      11.580ms     115.800us       1.505ms         0.00%      40.441ms     404.410us           100  
autograd::engine::evaluate_function: NllLossBackward...         0.00%       6.530ms         0.00%      38.663ms     386.630us       3.115ms         0.00%      39.642ms     396.420us           100  
                                         aten::nll_loss         0.00%     856.000us         0.00%       9.665ms      96.650us       1.096ms         0.00%      38.936ms     389.360us           100  
                                 aten::nll_loss_forward         0.00%       2.752ms         0.00%       8.443ms      84.430us      37.109ms         0.00%      37.840ms     378.400us           100  
                                       NllLossBackward0         0.00%       2.940ms         0.00%      27.830ms     278.300us       3.070ms         0.00%      36.527ms     365.270us           100  
                                            aten::zero_         0.00%      22.973ms         0.01%      60.374ms      17.210us      22.686ms         0.00%      35.490ms      10.117us          3508  
                                aten::nll_loss_backward         0.00%       7.271ms         0.00%      23.413ms     234.130us      21.773ms         0.00%      33.457ms     334.570us           100  
                                     train data prepare         0.00%      32.364ms         0.00%      32.384ms      32.384ms      32.374ms         0.00%      32.377ms      32.377ms             1  
                                       aten::empty_like         0.00%       8.870ms         0.00%      40.750ms      44.682us      13.123ms         0.00%      31.803ms      34.872us           912  
                                             aten::mul_         0.00%      20.233ms         0.00%      36.540ms      30.450us      27.919ms         0.00%      27.919ms      23.266us          1200  
                                        aten::new_empty         0.00%      10.268ms         0.00%      40.583ms      50.729us      10.584ms         0.00%      27.182ms      33.977us           800  
                                        aten::transpose         0.00%      15.465ms         0.01%      51.662ms      36.901us      18.481ms         0.00%      27.132ms      19.380us          1400  
        autograd::engine::evaluate_function: TBackward0         0.00%       5.310ms         0.00%      31.458ms     104.860us       6.697ms         0.00%      25.458ms      84.860us           300  
                        torch::autograd::AccumulateGrad         0.00%       8.417ms         0.00%      39.190ms      65.317us      10.412ms         0.00%      25.385ms      42.308us           600  
                                         aten::randperm         0.00%      11.627ms         0.00%      23.328ms      11.664ms      11.652ms         0.00%      23.312ms      11.656ms             2  
                                             TBackward0         0.00%       3.381ms         0.00%      23.587ms      78.623us       5.288ms         0.00%      18.761ms      62.537us           300  
                                            aten::fill_         0.00%      18.632ms         0.00%      32.912ms      29.758us      17.118ms         0.00%      17.118ms      15.477us          1106  
                                   DDP optimizer.zero()         0.00%       2.515ms         0.00%      28.797ms     287.970us       1.691ms         0.00%      17.074ms     170.740us           100  
                                             aten::sqrt         0.00%      12.435ms         0.00%      20.430ms      34.050us      16.259ms         0.00%      16.259ms      27.098us           600  
                                         aten::addcdiv_         0.00%      10.422ms         0.00%      19.701ms      32.835us      15.346ms         0.00%      15.346ms      25.577us           600  
                                              aten::mul         0.00%      15.123ms         0.00%      25.620ms      42.700us      14.923ms         0.00%      14.923ms      24.872us           600  
                                         aten::addcmul_         0.00%      10.523ms         0.00%      18.516ms      30.860us      14.119ms         0.00%      14.119ms      23.532us           600  
                                           aten::unbind         0.00%       1.868ms         0.00%      13.800ms     138.000us       4.749ms         0.00%      13.281ms     132.810us           100  
                     Optimizer.zero_grad#Adam.zero_grad         0.00%       4.546ms         0.00%      22.400ms     224.000us       3.404ms         0.00%      13.131ms     131.310us           100  
                                         aten::new_ones         0.00%       2.877ms         0.00%      26.329ms      87.763us       2.287ms         0.00%      10.350ms      34.500us           300  
                                              aten::cat         0.00%       1.250ms         0.00%      10.511ms     105.110us       1.697ms         0.00%       9.988ms      99.880us           100  
                                             aten::item         0.00%       3.614ms         0.00%      11.683ms      19.472us       6.110ms         0.00%       8.756ms      14.593us           600  
                                           aten::select         0.00%       3.565ms         0.00%      11.414ms      19.023us       6.186ms         0.00%       8.532ms      14.220us           600  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%       2.653ms         0.00%      13.905ms     139.050us       2.579ms         0.00%       8.456ms      84.560us           100  
                                             aten::_cat         0.00%       2.390ms         0.00%       8.778ms      87.780us       4.593ms         0.00%       8.291ms      82.910us           100  
                                             aten::ones         0.00%       3.860ms         0.00%      21.730ms      72.433us       3.663ms         0.00%       8.063ms      26.877us           300  
                                      aten::log_softmax         0.00%       1.122ms         0.00%       6.811ms      68.110us       1.982ms         0.00%       6.352ms      63.520us           100  
                                    LogSoftmaxBackward0         0.00%       2.472ms         0.00%      10.129ms     101.290us       1.770ms         0.00%       5.877ms      58.770us           100  
                                            aten::clamp         0.00%       6.828ms         0.00%      16.205ms      54.017us       2.250ms         0.00%       5.389ms      17.963us           300  
                       aten::_log_softmax_backward_data         0.00%       3.897ms         0.00%       6.566ms      65.660us       4.107ms         0.00%       4.107ms      41.070us           100  
                                     aten::_log_softmax         0.00%       2.798ms         0.00%       4.376ms      43.760us       3.942ms         0.00%       3.942ms      39.420us           100  
                                           aten::expand         0.00%       2.255ms         0.00%       5.990ms      19.967us       2.299ms         0.00%       3.315ms      11.050us           300  
                                        aten::ones_like         0.00%     772.000us         0.00%       6.338ms      63.380us       1.221ms         0.00%       3.252ms      32.520us           100  
                                       aten::zeros_like         0.00%     215.000us         0.00%       3.022ms     251.833us     484.000us         0.00%       2.877ms     239.750us            12  
                              aten::_local_scalar_dense         0.00%       3.283ms         0.00%       5.449ms       9.082us       2.646ms         0.00%       2.646ms       4.410us           600  
                                           aten::narrow         0.00%     699.000us         0.00%       3.103ms      31.030us       1.143ms         0.00%       2.618ms      26.180us           100  
                                     aten::resolve_conj         0.00%       3.187ms         0.00%       5.776ms       9.627us       2.584ms         0.00%       2.584ms       4.307us           600  
                                      aten::resolve_neg         0.00%       3.100ms         0.00%       5.652ms       9.420us       2.470ms         0.00%       2.470ms       4.117us           600  
                                             aten::view         0.00%       4.350ms         0.00%       7.147ms      23.823us       2.413ms         0.00%       2.413ms       8.043us           300  
                aten::_has_compatible_shallow_copy_type         0.00%       2.427ms         0.00%       5.272ms      13.180us       1.999ms         0.00%       1.999ms       4.997us           400  
                                          aten::resize_         0.00%       4.222ms         0.00%       7.395ms      14.731us       1.980ms         0.00%       1.980ms       3.944us           502  
                                             aten::set_         0.00%     918.000us         0.00%       1.309ms      12.833us     388.000us         0.00%     388.000us       3.804us           102  
                                           aten::detach         0.00%      58.000us         0.00%     200.000us      33.333us      84.000us         0.00%     137.000us      22.833us             6  
                                                 detach         0.00%      65.000us         0.00%     104.000us      17.333us      53.000us         0.00%      53.000us       8.833us             6  
                                    aten::scalar_tensor         0.00%      10.000us         0.00%      12.000us      12.000us       7.000us         0.00%       7.000us       7.000us             1  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 996.069s
Self CUDA time total: 996.026s

2023-03-13 10:46:45,527 - INFO - Rank 0 | wait sampler total time: 10.300254583358765, total iters: 100, avg iter time:0.10300254583358764
