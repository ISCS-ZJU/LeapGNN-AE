2023-03-12 21:47:23,776 - INFO - Rank 1 | Client Args: Namespace(dataset='./dist/repgnn_data/ogbn_products0/', sampling='10-10', hidden_size=256, n_classes=60, batch_size=800, dropout=0.2, lr=0.03, weight_decay=0, model_name='gcn', epoch=1, num_worker=1, cache_size=0, seed=None, log=True, dist_url='tcp://10.214.243.19:23456', world_size=2, rank=1, gpu=0, grpc_port='10.214.242.140:18110', mlp_layers=1, block='res+', conv='gen', gcn_aggr='max', norm='batch', t=1.0, p=1.0, y=0.0, learn_t=False, learn_p=False, learn_y=False, msg_norm=False, learn_msg_scale=False, distributed=True)
2023-03-12 21:47:24,790 - INFO - Rank 1 | Added key: store_based_barrier_key:1 to store for rank: 1
2023-03-12 21:47:24,791 - INFO - Rank 1 | Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
2023-03-12 21:47:24,801 - INFO - Rank 1 | Using 2 distributed GPUs in total for training...
2023-03-12 21:48:03,386 - INFO - Rank 1 | Reducer buckets have been rebuilt in this iteration.
2023-03-12 22:20:40,297 - INFO - Rank 1 | rank: 1, iter_num: 995
2023-03-12 22:25:54,161 - INFO - Rank 1 | -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      total epochs time         1.05%       20.848s        99.48%     1981.386s     1981.386s       20.966s         1.05%     1981.429s     1981.429s             1  
                                             fetch feat         0.28%        5.602s        91.86%     1829.598s        1.839s        6.075s         0.31%     1829.628s        1.839s           995  
                           fetch feat from cache server        84.04%     1673.791s        86.82%     1729.299s     434.497ms     1677.641s        84.25%     1729.293s     434.496ms          3980  
                        gpu-compute with optimizer.step         0.03%     661.127ms         6.51%      129.687s     130.339ms     753.966ms         0.04%      129.675s     130.327ms           995  
                                            aten::copy_         2.28%       45.470s         5.72%      114.021s       1.852ms      113.140s         5.68%      113.140s       1.838ms         61568  
                                            DDP forward         0.00%      94.057ms         5.50%      109.519s     110.069ms     135.117ms         0.01%      109.507s     110.057ms           995  
                        DistributedDataParallel.forward         4.57%       90.940s         5.49%      109.290s     109.839ms       96.780s         4.86%      109.278s     109.827ms           995  
                             move feats from CPU to GPU         0.29%        5.864s         3.73%       74.194s      18.642ms        6.045s         0.30%       74.133s      18.626ms          3980  
                                               aten::to         0.01%     142.453ms         3.52%       70.163s       5.876ms     248.856ms         0.01%       70.045s       5.866ms         11941  
                                         aten::_to_copy         0.01%     241.222ms         3.51%       69.895s       6.386ms     455.433ms         0.02%       69.797s       6.377ms         10945  
                                          create frames         0.82%       16.292s         0.84%       16.703s       4.197ms       16.473s         0.83%       16.662s       4.186ms          3980  
                                           DDP backward         0.82%       16.234s         0.82%       16.324s      16.406ms       16.254s         0.82%       16.318s      16.400ms           995  
                                            aten::slice         0.11%        2.224s         0.34%        6.690s      66.079us        3.742s         0.19%        5.136s      50.732us        101238  
                                            aten::index         0.21%        4.156s         0.24%        4.706s     675.689us        4.305s         0.22%        4.606s     661.304us          6965  
                                          aten::reshape         0.08%        1.629s         0.26%        5.238s      95.930us        2.020s         0.10%        3.433s      62.871us         54599  
                                             CopyReduce         0.06%        1.104s         0.13%        2.588s     866.842us        2.774s         0.14%        3.325s       1.114ms          2985  
autograd::engine::evaluate_function: CopyReduceBackw...         0.00%      89.710ms         0.15%        2.945s       1.480ms     129.683ms         0.01%        2.914s       1.464ms          1990  
                                     CopyReduceBackward         0.06%        1.246s         0.14%        2.818s       1.416ms        2.494s         0.13%        2.784s       1.399ms          1990  
    autograd::engine::evaluate_function: AddmmBackward0         0.02%     336.715ms         0.14%        2.776s     930.141us     372.798ms         0.02%        2.678s     897.311us          2985  
                                   DDP optimizer.step()         0.00%      41.516ms         0.10%        1.950s       1.960ms      63.925ms         0.00%        1.943s       1.953ms           995  
                                         AddmmBackward0         0.01%     134.369ms         0.09%        1.890s     633.079us     228.213ms         0.01%        1.893s     634.242us          2985  
                               Optimizer.step#Adam.step         0.02%     442.042ms         0.09%        1.844s       1.854ms     792.121ms         0.04%        1.837s       1.846ms           995  
                                            aten::zeros         0.03%     520.159ms         0.11%        2.095s      75.207us        1.105s         0.06%        1.751s      62.828us         27862  
                                       aten::as_strided         0.08%        1.556s         0.18%        3.529s      25.747us        1.744s         0.09%        1.744s      12.721us        137064  
                                          aten::dropout         0.00%      57.603ms         0.04%     718.293ms     240.634us      47.696ms         0.00%        1.563s     523.459us          2985  
autograd::engine::evaluate_function: torch::autograd...         0.02%     462.830ms         0.09%        1.825s     305.768us     638.706ms         0.03%        1.518s     254.220us          5970  
                                   aten::_fused_dropout         0.01%     172.314ms         0.03%     613.195ms     205.425us        1.238s         0.06%        1.515s     507.480us          2985  
                                   aten::_reshape_alias         0.07%        1.311s         0.11%        2.143s      39.241us        1.413s         0.07%        1.413s      25.874us         54599  
                                            get nf_nids         0.03%     552.921ms         0.07%        1.341s       1.348ms     696.854ms         0.03%        1.333s       1.340ms           995  
                                               aten::mm         0.03%     559.141ms         0.04%     850.430ms     170.941us        1.198s         0.06%        1.198s     240.776us          4975  
                                            aten::empty         0.05%        1.083s         0.10%        1.955s      23.388us        1.099s         0.06%        1.099s      13.146us         83592  
                                           aten::linear         0.00%      38.573ms         0.03%     662.168ms     221.832us      42.361ms         0.00%        1.087s     364.052us          2985  
                                            aten::addmm         0.01%     296.654ms         0.02%     456.111ms     152.801us     911.833ms         0.05%     954.177ms     319.657us          2985  
                                            fetch label         0.00%      93.765ms         0.04%     845.420ms     849.668us     140.450ms         0.01%     830.562ms     834.736us           995  
                                                aten::t         0.01%     293.379ms         0.07%        1.322s      94.876us     360.280ms         0.02%     829.053ms      59.516us         13930  
                                asign frame to nodeflow         0.03%     674.633ms         0.04%     832.431ms     209.154us     733.905ms         0.04%     781.753ms     196.420us          3980  
autograd::engine::evaluate_function: FusedDropoutBac...         0.00%      78.780ms         0.03%     574.869ms     288.879us      78.988ms         0.00%     728.448ms     366.054us          1990  
                                  FusedDropoutBackward0         0.00%      48.996ms         0.02%     462.057ms     232.189us      64.660ms         0.00%     649.460ms     326.362us          1990  
                                        aten::clamp_min         0.01%     145.554ms         0.02%     372.596ms      53.495us     364.642ms         0.02%     639.676ms      91.841us          6965  
                                     DDP calculate loss         0.00%      65.621ms         0.03%     591.691ms     594.664us      80.101ms         0.00%     585.767ms     588.711us           995  
                                    aten::_masked_scale         0.01%     111.855ms         0.02%     374.503ms     188.192us     437.322ms         0.02%     584.800ms     293.869us          1990  
                                            aten::zero_         0.02%     310.303ms         0.04%     875.081ms      25.122us     393.315ms         0.02%     543.985ms      15.617us         34833  
     autograd::engine::evaluate_function: ReluBackward0         0.00%      68.085ms         0.02%     377.784ms     189.841us      49.409ms         0.00%     526.782ms     264.715us          1990  
                                    aten::empty_strided         0.02%     478.331ms         0.03%     673.290ms      37.568us     516.019ms         0.03%     516.019ms      28.792us         17922  
                                             aten::add_         0.02%     398.525ms         0.04%     742.759ms      41.486us     515.001ms         0.03%     515.001ms      28.765us         17904  
        autograd::engine::evaluate_function: TBackward0         0.00%      80.503ms         0.03%     562.659ms     188.495us     126.502ms         0.01%     507.708ms     170.086us          2985  
                               aten::cross_entropy_loss         0.00%      12.493ms         0.03%     508.277ms     510.831us      21.404ms         0.00%     500.493ms     503.008us           995  
                        torch::autograd::AccumulateGrad         0.01%     126.267ms         0.03%     652.816ms     109.349us     202.747ms         0.01%     477.637ms      80.006us          5970  
                                          ReluBackward0         0.00%      53.111ms         0.01%     271.796ms     136.581us      37.159ms         0.00%     477.373ms     239.886us          1990  
                                              aten::div         0.01%     282.353ms         0.02%     468.853ms      42.837us     472.125ms         0.02%     472.125ms      43.136us         10945  
                                        aten::transpose         0.01%     215.127ms         0.04%     817.491ms      58.686us     327.237ms         0.02%     468.773ms      33.652us         13930  
                                       aten::empty_like         0.01%     121.967ms         0.03%     541.080ms      60.341us     228.550ms         0.01%     450.982ms      50.294us          8967  
                               aten::threshold_backward         0.01%     109.794ms         0.01%     185.394ms      93.163us     440.214ms         0.02%     440.214ms     221.213us          1990  
                                      aten::nll_loss_nd         0.00%       7.697ms         0.02%     414.440ms     416.523us      10.646ms         0.00%     410.146ms     412.207us           995  
                                         aten::nll_loss         0.00%       8.600ms         0.02%     401.422ms     403.439us       9.318ms         0.00%     399.500ms     401.508us           995  
                                 aten::nll_loss_forward         0.02%     352.398ms         0.02%     387.397ms     389.344us     381.600ms         0.02%     390.182ms     392.143us           995  
                                             TBackward0         0.00%      51.060ms         0.02%     426.253ms     142.798us     109.448ms         0.01%     381.206ms     127.707us          2985  
                                              aten::sum         0.01%     240.567ms         0.02%     375.320ms     125.735us     357.101ms         0.02%     357.101ms     119.632us          2985  
autograd::engine::evaluate_function: NllLossBackward...         0.00%      62.306ms         0.02%     406.111ms     408.152us      69.349ms         0.00%     355.781ms     357.569us           995  
                                   DDP optimizer.zero()         0.00%      27.139ms         0.02%     343.563ms     345.289us      45.488ms         0.00%     337.838ms     339.536us           995  
                                             aten::relu         0.00%      37.988ms         0.01%     239.989ms     120.597us       6.297ms         0.00%     329.717ms     165.687us          1990  
                                              aten::mul         0.01%     241.149ms         0.02%     434.508ms      72.782us     291.347ms         0.01%     291.347ms      48.802us          5970  
                                       NllLossBackward0         0.00%      29.891ms         0.02%     304.134ms     305.662us      50.107ms         0.00%     286.432ms     287.871us           995  
                                        aten::new_empty         0.00%      90.141ms         0.02%     382.759ms      48.085us     134.438ms         0.01%     270.394ms      33.969us          7960  
                     Optimizer.zero_grad#Adam.zero_grad         0.00%      53.757ms         0.01%     265.858ms     267.194us      92.053ms         0.00%     259.989ms     261.295us           995  
                                             aten::mul_         0.01%     186.526ms         0.02%     338.200ms      28.325us     250.675ms         0.01%     250.675ms      20.995us         11940  
                                aten::nll_loss_backward         0.00%      69.541ms         0.01%     254.361ms     255.639us     106.087ms         0.01%     236.325ms     237.513us           995  
                                           aten::unbind         0.00%      25.842ms         0.01%     212.217ms     213.283us      66.459ms         0.00%     204.693ms     205.722us           995  
                                            aten::fill_         0.01%     165.436ms         0.02%     325.863ms      29.756us     195.343ms         0.01%     195.343ms      17.838us         10951  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%      34.086ms         0.01%     183.783ms     184.707us      50.486ms         0.00%     165.777ms     166.610us           995  
                                             aten::sqrt         0.01%     111.486ms         0.01%     189.082ms      31.672us     148.117ms         0.01%     148.117ms      24.810us          5970  
                                           aten::select         0.00%      53.254ms         0.01%     179.137ms      30.006us     101.148ms         0.01%     138.234ms      23.155us          5970  
                                             aten::item         0.00%      50.120ms         0.01%     182.505ms      30.570us      90.717ms         0.00%     133.214ms      22.314us          5970  
                                              aten::cat         0.00%      16.166ms         0.01%     139.711ms     140.413us      23.309ms         0.00%     132.356ms     133.021us           995  
                                         aten::addcmul_         0.00%      95.818ms         0.01%     171.783ms      28.774us     129.476ms         0.01%     129.476ms      21.688us          5970  
                                         aten::addcdiv_         0.00%      96.324ms         0.01%     171.411ms      28.712us     128.521ms         0.01%     128.521ms      21.528us          5970  
                                    LogSoftmaxBackward0         0.00%      28.646ms         0.01%     129.747ms     130.399us      48.438ms         0.00%     115.291ms     115.870us           995  
                                             aten::_cat         0.00%      29.450ms         0.01%     116.390ms     116.975us      53.558ms         0.00%     109.047ms     109.595us           995  
                                            aten::clamp         0.00%      64.917ms         0.01%     168.582ms      56.476us      53.573ms         0.00%      98.846ms      33.114us          2985  
                                         aten::new_ones         0.00%      27.625ms         0.01%     257.569ms      86.288us      19.264ms         0.00%      95.291ms      31.923us          2985  
                                             aten::ones         0.00%      39.604ms         0.01%     209.639ms      70.231us      33.273ms         0.00%      76.027ms      25.470us          2985  
                                      aten::log_softmax         0.00%      11.671ms         0.00%      74.150ms      74.523us      23.829ms         0.00%      68.943ms      69.289us           995  
                       aten::_log_softmax_backward_data         0.00%      47.010ms         0.00%      82.184ms      82.597us      66.853ms         0.00%      66.853ms      67.189us           995  
                                        aten::ones_like         0.00%       8.236ms         0.00%      65.044ms      65.371us      17.887ms         0.00%      59.601ms      59.901us           995  
                                             aten::view         0.00%      63.378ms         0.01%     119.548ms      40.050us      55.360ms         0.00%      55.360ms      18.546us          2985  
                                     aten::resolve_conj         0.00%      44.844ms         0.01%     102.144ms      17.110us      46.156ms         0.00%      46.156ms       7.731us          5970  
                                      aten::resolve_neg         0.00%      42.342ms         0.00%      95.720ms      16.034us      43.785ms         0.00%      43.785ms       7.334us          5970  
                                         aten::randperm         0.00%      21.445ms         0.00%      42.997ms      21.498ms      21.480ms         0.00%      42.976ms      21.488ms             2  
                              aten::_local_scalar_dense         0.00%      38.024ms         0.00%      83.373ms      13.965us      42.497ms         0.00%      42.497ms       7.118us          5970  
                                           aten::expand         0.00%      22.662ms         0.00%      72.299ms      24.221us      31.071ms         0.00%      42.344ms      14.186us          2985  
                aten::_has_compatible_shallow_copy_type         0.00%      38.754ms         0.00%      91.375ms      22.959us      40.867ms         0.00%      40.867ms      10.268us          3980  
                                     aten::_log_softmax         0.00%      29.142ms         0.00%      45.495ms      45.724us      39.808ms         0.00%      39.808ms      40.008us           995  
                                           aten::narrow         0.00%       9.327ms         0.00%      47.337ms      47.575us      16.271ms         0.00%      39.627ms      39.826us           995  
                                     train data prepare         0.00%      36.578ms         0.00%      36.609ms      36.609ms      36.598ms         0.00%      36.602ms      36.602ms             1  
                                             aten::set_         0.00%      18.427ms         0.00%      33.283ms      33.383us      19.798ms         0.00%      19.798ms      19.858us           997  
                                          aten::resize_         0.00%      42.966ms         0.00%      70.371ms      14.139us      19.174ms         0.00%      19.174ms       3.853us          4977  
                                       aten::zeros_like         0.00%     139.000us         0.00%       1.365ms     113.750us     320.000us         0.00%       1.263ms     105.250us            12  
                                           aten::detach         0.00%      78.000us         0.00%     334.000us      55.667us     120.000us         0.00%     199.000us      33.167us             6  
                                                 detach         0.00%      98.000us         0.00%     174.000us      29.000us      79.000us         0.00%      79.000us      13.167us             6  
                                    aten::scalar_tensor         0.00%      10.000us         0.00%      14.000us      14.000us      10.000us         0.00%      10.000us      10.000us             1  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 1991.742s
Self CUDA time total: 1991.190s

2023-03-12 22:25:54,161 - INFO - Rank 1 | wait sampler total time: 20.607295989990234, total iters: 995, avg iter time:0.020710850241196215
