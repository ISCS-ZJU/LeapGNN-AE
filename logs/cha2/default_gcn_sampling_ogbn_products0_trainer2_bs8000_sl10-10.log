2023-03-13 10:27:58,879 - INFO - Rank 1 | Client Args: Namespace(dataset='./dist/repgnn_data/ogbn_products0/', sampling='10-10', hidden_size=256, n_classes=60, batch_size=8000, dropout=0.2, lr=0.03, weight_decay=0, model_name='gcn', epoch=1, num_worker=1, cache_size=0, seed=None, log=True, dist_url='tcp://10.214.243.19:23456', world_size=2, rank=1, gpu=0, grpc_port='10.214.242.140:18110', mlp_layers=1, block='res+', conv='gen', gcn_aggr='max', norm='batch', t=1.0, p=1.0, y=0.0, learn_t=False, learn_p=False, learn_y=False, msg_norm=False, learn_msg_scale=False, distributed=True)
2023-03-13 10:28:00,898 - INFO - Rank 1 | Added key: store_based_barrier_key:1 to store for rank: 1
2023-03-13 10:28:00,899 - INFO - Rank 1 | Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
2023-03-13 10:28:00,900 - INFO - Rank 1 | Using 2 distributed GPUs in total for training...
2023-03-13 10:28:52,652 - INFO - Rank 1 | Reducer buckets have been rebuilt in this iteration.
2023-03-13 10:44:49,476 - INFO - Rank 1 | rank: 1, iter_num: 100
2023-03-13 10:45:54,046 - INFO - Rank 1 | -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      total epochs time         2.07%       20.682s        99.74%      994.701s      994.701s       20.711s         2.08%      994.723s      994.723s             1  
                                             fetch feat         0.22%        2.204s        79.77%      795.563s        7.956s        2.246s         0.23%      795.578s        7.956s           100  
                           fetch feat from cache server        73.39%      731.949s        75.88%      756.734s        1.892s      733.464s        73.55%      756.748s        1.892s           400  
                        gpu-compute with optimizer.step         0.01%      63.916ms        17.86%      178.111s        1.781s      71.387ms         0.01%      178.114s        1.781s           100  
                                            DDP forward         0.00%      11.558ms        17.49%      174.427s        1.744s      15.510ms         0.00%      174.430s        1.744s           100  
                        DistributedDataParallel.forward        16.64%      165.937s        17.49%      174.403s        1.744s      168.149s        16.86%      174.405s        1.744s           100  
                                            aten::copy_         2.06%       20.529s         4.79%       47.774s       2.365ms       47.473s         4.76%       47.473s       2.350ms         20197  
                             move feats from CPU to GPU         0.26%        2.569s         2.96%       29.498s      73.744ms        2.586s         0.26%       29.492s      73.731ms           400  
                                               aten::to         0.00%      14.935ms         2.76%       27.541s      22.932ms      25.013ms         0.00%       27.531s      22.923ms          1201  
                                         aten::_to_copy         0.00%      26.559ms         2.76%       27.516s      25.014ms      48.869ms         0.00%       27.506s      25.005ms          1100  
                                          create frames         0.67%        6.697s         0.68%        6.733s      16.831ms        6.712s         0.67%        6.729s      16.823ms           400  
                                           DDP backward         0.32%        3.199s         0.32%        3.209s      32.089ms        3.202s         0.32%        3.208s      32.083ms           100  
                                            aten::index         0.26%        2.608s         0.27%        2.678s       3.826ms        2.624s         0.26%        2.663s       3.804ms           700  
                                            aten::slice         0.09%     897.039ms         0.26%        2.631s      68.723us        1.480s         0.15%        2.020s      52.767us         38286  
                                             CopyReduce         0.01%     125.648ms         0.07%     681.010ms       2.270ms        1.727s         0.17%        1.858s       6.192ms           300  
                                          aten::reshape         0.06%     595.807ms         0.19%        1.931s      99.063us     755.887ms         0.08%        1.292s      66.270us         19493  
autograd::engine::evaluate_function: CopyReduceBackw...         0.00%       8.584ms         0.12%        1.222s       6.109ms      10.174ms         0.00%        1.138s       5.690ms           200  
                                     CopyReduceBackward         0.01%     125.165ms         0.12%        1.208s       6.041ms        1.084s         0.11%        1.128s       5.639ms           200  
    autograd::engine::evaluate_function: AddmmBackward0         0.00%      15.323ms         0.02%     236.615ms     788.717us      11.332ms         0.00%     716.674ms       2.389ms           300  
                                         AddmmBackward0         0.00%      12.807ms         0.02%     170.441ms     568.137us      14.188ms         0.00%     588.260ms       1.961ms           300  
                                       aten::as_strided         0.05%     495.403ms         0.11%        1.133s      27.054us     568.669ms         0.06%     568.669ms      13.575us         41892  
                                          aten::dropout         0.00%       6.290ms         0.01%      85.752ms     285.840us       3.727ms         0.00%     556.084ms       1.854ms           300  
                                   aten::_fused_dropout         0.00%      19.355ms         0.01%      75.069ms     250.230us     518.816ms         0.05%     552.357ms       1.841ms           300  
                                           aten::linear         0.00%       4.197ms         0.01%      78.089ms     260.297us       2.758ms         0.00%     546.238ms       1.821ms           300  
                                               aten::mm         0.01%      52.503ms         0.01%      80.291ms     160.582us     545.204ms         0.05%     545.204ms       1.090ms           500  
                                            aten::addmm         0.00%      37.836ms         0.01%      56.396ms     187.987us     535.295ms         0.05%     537.834ms       1.793ms           300  
                                   aten::_reshape_alias         0.05%     485.596ms         0.08%     810.610ms      41.585us     535.923ms         0.05%     535.923ms      27.493us         19493  
                                        aten::clamp_min         0.00%      12.325ms         0.00%      39.276ms      56.109us     204.826ms         0.02%     406.107ms     580.153us           700  
                                   DDP optimizer.step()         0.00%       6.684ms         0.03%     312.597ms       3.126ms      11.309ms         0.00%     311.521ms       3.115ms           100  
     autograd::engine::evaluate_function: ReluBackward0         0.00%       5.623ms         0.00%      32.665ms     163.325us     634.000us         0.00%     296.294ms       1.481ms           200  
                                          ReluBackward0         0.00%       4.735ms         0.00%      24.371ms     121.855us     630.000us         0.00%     295.660ms       1.478ms           200  
                               aten::threshold_backward         0.00%       9.309ms         0.00%      15.787ms      78.935us     295.030ms         0.03%     295.030ms       1.475ms           200  
                               Optimizer.step#Adam.step         0.01%      72.736ms         0.03%     295.032ms       2.950ms     124.125ms         0.01%     293.941ms       2.939ms           100  
autograd::engine::evaluate_function: FusedDropoutBac...         0.00%       7.040ms         0.01%      56.376ms     281.880us       5.811ms         0.00%     263.757ms       1.319ms           200  
                                  FusedDropoutBackward0         0.00%       6.516ms         0.00%      46.595ms     232.975us       4.723ms         0.00%     257.946ms       1.290ms           200  
                                    aten::_masked_scale         0.00%      10.119ms         0.00%      37.348ms     186.740us     236.774ms         0.02%     253.223ms       1.266ms           200  
                                            fetch label         0.00%      11.916ms         0.02%     234.637ms       2.346ms      16.467ms         0.00%     233.182ms       2.332ms           100  
                                             aten::relu         0.00%       4.257ms         0.00%      23.684ms     118.420us     614.000us         0.00%     202.743ms       1.014ms           200  
                                            get nf_nids         0.01%      75.062ms         0.02%     174.523ms       1.745ms      92.115ms         0.01%     173.497ms       1.735ms           100  
                                            aten::zeros         0.01%      51.714ms         0.02%     219.278ms      78.258us     103.166ms         0.01%     165.869ms      59.197us          2802  
                                              aten::div         0.00%      35.905ms         0.01%      60.221ms      54.746us     161.209ms         0.02%     161.209ms     146.554us          1100  
                                              aten::sum         0.00%      23.222ms         0.00%      36.821ms     122.737us     114.554ms         0.01%     114.554ms     381.847us           300  
                                            aten::empty         0.01%     117.983ms         0.02%     207.513ms      24.669us     113.900ms         0.01%     113.900ms      13.540us          8412  
                                    aten::empty_strided         0.01%      60.310ms         0.01%      97.824ms      53.987us      78.456ms         0.01%      78.456ms      43.298us          1812  
                                asign frame to nodeflow         0.01%      60.677ms         0.01%      72.272ms     180.680us      64.748ms         0.01%      68.333ms     170.833us           400  
autograd::engine::evaluate_function: torch::autograd...         0.00%      40.678ms         0.02%     157.315ms     262.192us      15.764ms         0.00%      58.589ms      97.648us           600  
                                       aten::empty_like         0.00%      12.069ms         0.01%      68.606ms      75.226us      18.572ms         0.00%      54.588ms      59.855us           912  
                                             aten::add_         0.00%      48.713ms         0.01%      90.015ms      50.176us      54.259ms         0.01%      54.259ms      30.245us          1794  
                                            aten::zero_         0.00%      30.341ms         0.01%      82.363ms      23.479us      35.948ms         0.00%      51.585ms      14.705us          3508  
                                                aten::t         0.00%      28.213ms         0.01%     116.601ms      83.286us      19.953ms         0.00%      45.023ms      32.159us          1400  
                                         aten::randperm         0.00%      21.528ms         0.00%      43.168ms      21.584ms      21.572ms         0.00%      43.149ms      21.575ms             2  
                                             aten::mul_         0.00%      27.548ms         0.01%      54.166ms      45.138us      41.350ms         0.00%      41.350ms      34.458us          1200  
                                     DDP calculate loss         0.00%       8.359ms         0.00%      30.869ms     308.690us       5.173ms         0.00%      38.809ms     388.090us           100  
                                     train data prepare         0.00%      37.025ms         0.00%      37.057ms      37.057ms      37.044ms         0.00%      37.049ms      37.049ms             1  
autograd::engine::evaluate_function: NllLossBackward...         0.00%       6.837ms         0.00%      40.901ms     409.010us       3.769ms         0.00%      35.802ms     358.020us           100  
                               aten::cross_entropy_loss         0.00%       1.408ms         0.00%      20.861ms     208.610us       2.009ms         0.00%      33.128ms     331.280us           100  
                                       NllLossBackward0         0.00%       3.344ms         0.00%      30.094ms     300.940us       3.318ms         0.00%      32.033ms     320.330us           100  
                                   DDP optimizer.zero()         0.00%       2.890ms         0.00%      33.910ms     339.100us       3.395ms         0.00%      29.683ms     296.830us           100  
                                aten::nll_loss_backward         0.00%       7.303ms         0.00%      25.138ms     251.380us      16.687ms         0.00%      28.715ms     287.150us           100  
                                           aten::unbind         0.00%       3.180ms         0.00%      27.265ms     272.650us       8.289ms         0.00%      26.345ms     263.450us           100  
                                        aten::transpose         0.00%      19.345ms         0.01%      69.967ms      49.976us      16.502ms         0.00%      25.070ms      17.907us          1400  
                        torch::autograd::AccumulateGrad         0.00%      11.369ms         0.01%      58.909ms      98.182us       8.833ms         0.00%      24.841ms      41.402us           600  
                     Optimizer.zero_grad#Adam.zero_grad         0.00%       5.121ms         0.00%      24.949ms     249.490us       8.706ms         0.00%      24.391ms     243.910us           100  
                                             aten::sqrt         0.00%      17.413ms         0.00%      29.856ms      49.760us      23.773ms         0.00%      23.773ms      39.622us           600  
                                        aten::new_empty         0.00%       8.942ms         0.00%      43.414ms      54.267us       9.541ms         0.00%      23.460ms      29.325us           800  
                                      aten::nll_loss_nd         0.00%     860.000us         0.00%      10.594ms     105.940us     978.000us         0.00%      23.304ms     233.040us           100  
                                         aten::nll_loss         0.00%     903.000us         0.00%       9.193ms      91.930us     939.000us         0.00%      22.326ms     223.260us           100  
                                 aten::nll_loss_forward         0.00%       3.064ms         0.00%       7.859ms      78.590us      20.499ms         0.00%      21.387ms     213.870us           100  
                                         aten::addcmul_         0.00%      14.031ms         0.00%      26.068ms      43.447us      19.903ms         0.00%      19.903ms      33.172us           600  
                                         aten::addcdiv_         0.00%      14.282ms         0.00%      26.235ms      43.725us      19.898ms         0.00%      19.898ms      33.163us           600  
                                            aten::fill_         0.00%      19.071ms         0.00%      34.275ms      30.990us      19.161ms         0.00%      19.161ms      17.325us          1106  
        autograd::engine::evaluate_function: TBackward0         0.00%       6.996ms         0.00%      46.766ms     155.887us       4.767ms         0.00%      19.036ms      63.453us           300  
                                           aten::select         0.00%       8.217ms         0.00%      23.120ms      38.533us      13.447ms         0.00%      18.056ms      30.093us           600  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%       3.297ms         0.00%      19.628ms     196.280us       4.749ms         0.00%      16.337ms     163.370us           100  
                                              aten::cat         0.00%       1.988ms         0.00%      17.177ms     171.770us       2.878ms         0.00%      16.259ms     162.590us           100  
                                             aten::item         0.00%       6.468ms         0.00%      21.506ms      35.843us      11.000ms         0.00%      15.782ms      26.303us           600  
                                             TBackward0         0.00%       4.381ms         0.00%      35.714ms     119.047us       3.760ms         0.00%      14.269ms      47.563us           300  
                                              aten::mul         0.00%      21.470ms         0.00%      37.708ms      62.847us      13.596ms         0.00%      13.596ms      22.660us           600  
                                             aten::_cat         0.00%       3.864ms         0.00%      14.237ms     142.370us       6.527ms         0.00%      13.381ms     133.810us           100  
                                    LogSoftmaxBackward0         0.00%       3.109ms         0.00%      13.041ms     130.410us       4.643ms         0.00%      11.588ms     115.880us           100  
                                      aten::log_softmax         0.00%       1.251ms         0.00%       8.333ms      83.330us       2.285ms         0.00%       7.815ms      78.150us           100  
                       aten::_log_softmax_backward_data         0.00%       4.801ms         0.00%       8.414ms      84.140us       6.945ms         0.00%       6.945ms      69.450us           100  
                                            aten::clamp         0.00%       8.061ms         0.00%      20.100ms      67.000us       2.947ms         0.00%       6.044ms      20.147us           300  
                                        aten::ones_like         0.00%     848.000us         0.00%       6.493ms      64.930us       1.814ms         0.00%       5.951ms      59.510us           100  
                                     aten::_log_softmax         0.00%       3.487ms         0.00%       5.568ms      55.680us       5.028ms         0.00%       5.028ms      50.280us           100  
                                         aten::new_ones         0.00%       3.062ms         0.00%      29.786ms      99.287us     955.000us         0.00%       4.970ms      16.567us           300  
                                           aten::narrow         0.00%       1.160ms         0.00%       5.688ms      56.880us       2.046ms         0.00%       4.840ms      48.400us           100  
                              aten::_local_scalar_dense         0.00%       4.689ms         0.00%       9.665ms      16.108us       4.782ms         0.00%       4.782ms       7.970us           600  
                                     aten::resolve_conj         0.00%       4.169ms         0.00%      10.005ms      16.675us       4.217ms         0.00%       4.217ms       7.028us           600  
                                             aten::ones         0.00%       4.357ms         0.00%      24.637ms      82.123us       1.553ms         0.00%       4.015ms      13.383us           300  
                                      aten::resolve_neg         0.00%       3.861ms         0.00%       8.349ms      13.915us       3.861ms         0.00%       3.861ms       6.435us           600  
                aten::_has_compatible_shallow_copy_type         0.00%       3.215ms         0.00%       8.744ms      21.860us       3.233ms         0.00%       3.233ms       8.082us           400  
                                       aten::zeros_like         0.00%     212.000us         0.00%       3.325ms     277.083us     511.000us         0.00%       3.150ms     262.500us            12  
                                           aten::expand         0.00%       2.301ms         0.00%       6.802ms      22.673us       1.803ms         0.00%       2.539ms       8.463us           300  
                                             aten::view         0.00%       5.726ms         0.00%       9.789ms      32.630us       2.528ms         0.00%       2.528ms       8.427us           300  
                                          aten::resize_         0.00%       4.786ms         0.00%       8.446ms      16.825us       2.152ms         0.00%       2.152ms       4.287us           502  
                                             aten::set_         0.00%       1.387ms         0.00%       2.334ms      22.882us     139.000us         0.00%     139.000us       1.363us           102  
                                           aten::detach         0.00%      69.000us         0.00%     293.000us      48.833us      74.000us         0.00%     117.000us      19.500us             6  
                                                 detach         0.00%      79.000us         0.00%     145.000us      24.167us      43.000us         0.00%      43.000us       7.167us             6  
                                    aten::scalar_tensor         0.00%      11.000us         0.00%      15.000us      15.000us      10.000us         0.00%      10.000us      10.000us             1  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 997.313s
Self CUDA time total: 997.298s

2023-03-13 10:45:54,047 - INFO - Rank 1 | wait sampler total time: 20.632238149642944, total iters: 100, avg iter time:0.20632238149642945
