2023-03-12 18:49:35,452 - INFO - Rank 0 | Client Args: Namespace(dataset='./dist/repgnn_data/ogbn_products0/', sampling='10-10', hidden_size=256, n_classes=60, batch_size=80, dropout=0.2, lr=0.03, weight_decay=0, model_name='gcn', epoch=1, num_worker=1, cache_size=0, seed=None, log=True, dist_url='tcp://10.214.243.19:23456', world_size=2, rank=0, gpu=0, grpc_port='10.214.243.19:18110', mlp_layers=1, block='res+', conv='gen', gcn_aggr='max', norm='batch', t=1.0, p=1.0, y=0.0, learn_t=False, learn_p=False, learn_y=False, msg_norm=False, learn_msg_scale=False, distributed=True)
2023-03-12 18:49:35,922 - INFO - Rank 0 | Added key: store_based_barrier_key:1 to store for rank: 0
2023-03-12 18:49:35,922 - INFO - Rank 0 | Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
2023-03-12 18:49:35,922 - INFO - Rank 0 | Using 2 distributed GPUs in total for training...
2023-03-12 18:50:07,134 - INFO - Rank 0 | Reducer buckets have been rebuilt in this iteration.
2023-03-12 19:46:34,411 - INFO - Rank 0 | rank: 0, iter_num: 9950
2023-03-12 20:27:29,437 - INFO - Rank 0 | -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      total epochs time         0.38%       12.996s        98.25%     3404.421s     3404.421s       13.546s         0.39%     3404.402s     3404.402s             1  
                                             fetch feat         0.28%        9.538s        58.73%     2035.178s     204.540ms       12.045s         0.35%     2035.080s     204.531ms          9950  
                           fetch feat from cache server        54.96%     1904.325s        55.98%     1939.674s      48.736ms     1908.083s        55.14%     1939.401s      48.729ms         39800  
                        gpu-compute with optimizer.step         0.61%       21.249s        39.02%     1352.109s     135.890ms       21.828s         0.63%     1352.031s     135.882ms          9950  
                                           DDP backward        33.26%     1152.667s        33.28%     1153.387s     115.918ms     1152.805s        33.31%     1153.332s     115.913ms          9950  
                                            DDP forward         0.01%     451.625ms         4.52%      156.648s      15.744ms     635.053ms         0.02%      156.590s      15.738ms          9950  
                        DistributedDataParallel.forward         2.70%       93.557s         4.49%      155.670s      15.645ms      100.724s         2.91%      155.605s      15.639ms          9950  
                                            aten::copy_         0.92%       31.793s         1.88%       65.097s     251.813us       63.374s         1.83%       63.374s     245.147us        258513  
                                               aten::to         0.03%     900.946ms         1.24%       42.937s     359.601us        1.374s         0.04%       42.269s     354.010us        119401  
                                         aten::_to_copy         0.04%        1.304s         1.20%       41.476s     378.952us        2.406s         0.07%       40.895s     373.641us        109450  
                             move feats from CPU to GPU         0.05%        1.622s         1.06%       36.827s     925.289us        2.376s         0.07%       36.585s     919.234us         39800  
                                          create frames         0.55%       19.170s         0.62%       21.457s     539.115us       20.210s         0.58%       21.202s     532.726us         39800  
                                             CopyReduce         0.27%        9.222s         0.57%       19.783s     662.745us       13.581s         0.39%       19.511s     653.643us         29850  
                                            aten::index         0.39%       13.542s         0.49%       17.053s     244.845us       14.586s         0.42%       16.502s     236.923us         69650  
    autograd::engine::evaluate_function: AddmmBackward0         0.03%        1.094s         0.47%       16.250s     544.375us        1.731s         0.05%       15.965s     534.857us         29850  
                                            get nf_nids         0.16%        5.711s         0.44%       15.087s       1.516ms        7.222s         0.21%       15.002s       1.508ms          9950  
autograd::engine::evaluate_function: CopyReduceBackw...         0.02%     563.847ms         0.43%       14.795s     743.453us     783.417ms         0.02%       14.590s     733.142us         19900  
                                   DDP optimizer.step()         0.01%     308.327ms         0.41%       14.063s       1.413ms     451.700ms         0.01%       14.013s       1.408ms          9950  
                                     CopyReduceBackward         0.24%        8.280s         0.40%       14.010s     704.029us       12.010s         0.35%       13.806s     693.774us         19900  
                               Optimizer.step#Adam.step         0.09%        3.137s         0.38%       13.319s       1.339ms        5.315s         0.15%       13.266s       1.333ms          9950  
                                         AddmmBackward0         0.03%     885.647ms         0.34%       11.916s     399.205us        2.179s         0.06%       11.648s     390.221us         29850  
autograd::engine::evaluate_function: torch::autograd...         0.08%        2.907s         0.33%       11.413s     191.170us        4.395s         0.13%       10.762s     180.264us         59700  
                                            aten::zeros         0.09%        3.011s         0.32%       11.127s      39.938us        6.117s         0.18%        9.355s      33.580us        278602  
                                            aten::slice         0.11%        3.744s         0.29%       10.043s      34.852us        5.605s         0.16%        7.628s      26.471us        288163  
                                                aten::t         0.06%        2.172s         0.26%        8.844s      63.488us        3.354s         0.10%        7.559s      54.262us        139300  
                                            aten::empty         0.20%        7.000s         0.33%       11.349s      13.578us        6.098s         0.18%        6.098s       7.295us        835812  
                                           aten::linear         0.01%     326.508ms         0.15%        5.274s     176.683us     531.718ms         0.02%        5.367s     179.802us         29850  
                                          aten::reshape         0.07%        2.481s         0.22%        7.514s      39.788us        3.129s         0.09%        5.137s      27.199us        188857  
                                       aten::as_strided         0.15%        5.192s         0.29%       10.031s      15.520us        5.013s         0.14%        5.013s       7.756us        646369  
                                               aten::mm         0.10%        3.352s         0.15%        5.119s     102.903us        4.713s         0.14%        4.713s      94.736us         49750  
                                        aten::transpose         0.04%        1.544s         0.16%        5.409s      38.830us        2.854s         0.08%        4.204s      30.181us        139300  
                                          aten::dropout         0.01%     329.644ms         0.11%        3.969s     132.978us     365.991ms         0.01%        4.021s     134.696us         29850  
                                             aten::add_         0.09%        2.963s         0.14%        5.012s      27.985us        3.853s         0.11%        3.853s      21.515us        179094  
                                            aten::addmm         0.07%        2.260s         0.10%        3.581s     119.974us        3.285s         0.09%        3.758s     125.883us         29850  
                                   aten::_fused_dropout         0.03%        1.014s         0.10%        3.422s     114.644us        2.125s         0.06%        3.655s     122.435us         29850  
                                asign frame to nodeflow         0.09%        3.171s         0.11%        3.865s      97.113us        3.415s         0.10%        3.627s      91.122us         39800  
                                            aten::zero_         0.07%        2.334s         0.16%        5.647s      16.215us        2.399s         0.07%        3.612s      10.371us        348258  
                        torch::autograd::AccumulateGrad         0.02%     855.613ms         0.12%        4.126s      69.105us        1.507s         0.04%        3.551s      59.476us         59700  
autograd::engine::evaluate_function: FusedDropoutBac...         0.01%     510.413ms         0.10%        3.558s     178.800us     692.400ms         0.02%        3.346s     168.157us         19900  
                                           aten::unbind         0.01%     290.961ms         0.10%        3.370s     338.711us     703.764ms         0.02%        3.291s     330.753us          9950  
        autograd::engine::evaluate_function: TBackward0         0.02%     561.647ms         0.10%        3.525s     118.101us     825.093ms         0.02%        3.222s     107.938us         29850  
                                              aten::div         0.06%        2.180s         0.10%        3.336s      30.478us        2.902s         0.08%        2.902s      26.517us        109450  
                                   DDP optimizer.zero()         0.01%     232.588ms         0.08%        2.810s     282.397us     359.060ms         0.01%        2.765s     277.882us          9950  
                                       aten::empty_like         0.02%     848.093ms         0.09%        3.199s      35.713us        1.388s         0.04%        2.665s      29.760us         89562  
                                  FusedDropoutBackward0         0.01%     311.281ms         0.08%        2.832s     142.305us     513.598ms         0.01%        2.654s     133.363us         19900  
                                        aten::clamp_min         0.03%     940.203ms         0.08%        2.805s      40.276us        1.481s         0.04%        2.591s      37.195us         69650  
                                           aten::select         0.05%        1.759s         0.09%        3.010s      50.418us        2.201s         0.06%        2.587s      43.337us         59700  
autograd::engine::evaluate_function: NllLossBackward...         0.01%     387.042ms         0.08%        2.740s     275.358us     454.906ms         0.01%        2.451s     246.283us          9950  
                                             TBackward0         0.01%     347.857ms         0.08%        2.660s      89.119us     671.660ms         0.02%        2.397s      80.297us         29850  
                                    aten::empty_strided         0.07%        2.574s         0.10%        3.346s      18.682us        2.394s         0.07%        2.394s      13.367us        179112  
                                            fetch label         0.01%     365.368ms         0.07%        2.388s     240.033us     535.185ms         0.02%        2.328s     233.950us          9950  
                                              aten::sum         0.04%        1.425s         0.06%        2.163s      72.450us        2.199s         0.06%        2.199s      73.656us         29850  
                                        aten::new_empty         0.02%     765.982ms         0.08%        2.781s      34.936us        1.131s         0.03%        2.149s      26.996us         79600  
                     Optimizer.zero_grad#Adam.zero_grad         0.01%     443.489ms         0.06%        2.196s     220.701us     738.169ms         0.02%        2.147s     215.826us          9950  
                                    aten::_masked_scale         0.02%     743.803ms         0.07%        2.310s     116.086us        1.222s         0.04%        2.140s     107.554us         19900  
                                     DDP calculate loss         0.02%     562.646ms         0.06%        2.171s     218.222us     649.181ms         0.02%        2.125s     213.603us          9950  
     autograd::engine::evaluate_function: ReluBackward0         0.01%     427.778ms         0.07%        2.298s     115.501us     611.666ms         0.02%        2.109s     105.991us         19900  
                                              aten::mul         0.04%        1.525s         0.08%        2.643s      44.275us        2.044s         0.06%        2.044s      34.233us         59700  
                                   aten::_reshape_alias         0.06%        2.133s         0.09%        3.226s      17.082us        2.007s         0.06%        2.007s      10.629us        188857  
                                       NllLossBackward0         0.01%     206.174ms         0.06%        2.110s     212.076us     339.899ms         0.01%        1.996s     200.564us          9950  
                                             aten::mul_         0.04%        1.527s         0.07%        2.441s      20.445us        1.876s         0.05%        1.876s      15.715us        119400  
                                         aten::new_ones         0.01%     264.372ms         0.08%        2.721s      91.146us     264.653ms         0.01%        1.842s      61.713us         29850  
                                            aten::fill_         0.04%        1.513s         0.07%        2.588s      23.646us        1.774s         0.05%        1.774s      16.209us        109456  
                                aten::nll_loss_backward         0.01%     515.976ms         0.05%        1.776s     178.529us     755.062ms         0.02%        1.656s     166.403us          9950  
                                             aten::ones         0.03%     870.881ms         0.07%        2.284s      76.521us     993.445ms         0.03%        1.577s      52.847us         29850  
                                             aten::relu         0.01%     306.888ms         0.05%        1.686s      84.741us     277.200ms         0.01%        1.512s      76.001us         19900  
                                          ReluBackward0         0.01%     349.837ms         0.05%        1.671s      83.961us     556.358ms         0.02%        1.498s      75.254us         19900  
                               aten::cross_entropy_loss         0.00%     116.821ms         0.04%        1.482s     148.948us     181.861ms         0.01%        1.438s     144.557us          9950  
                                             aten::item         0.02%     593.774ms         0.05%        1.884s      31.550us     974.385ms         0.03%        1.408s      23.584us         59700  
                                              aten::cat         0.01%     177.419ms         0.04%        1.460s     146.737us     242.083ms         0.01%        1.377s     138.376us          9950  
                                            aten::clamp         0.02%     579.469ms         0.04%        1.401s      46.929us     673.428ms         0.02%        1.250s      41.889us         29850  
                                             aten::_cat         0.01%     315.618ms         0.03%        1.207s     121.306us     543.586ms         0.02%        1.135s     114.046us          9950  
                                             aten::sqrt         0.03%     929.782ms         0.04%        1.400s      23.456us        1.134s         0.03%        1.134s      19.002us         59700  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.01%     235.710ms         0.04%        1.231s     123.734us     340.800ms         0.01%        1.125s     113.108us          9950  
                                         aten::addcdiv_         0.02%     777.029ms         0.04%        1.240s      20.778us        1.059s         0.03%        1.059s      17.743us         59700  
                                         aten::addcmul_         0.02%     785.053ms         0.04%        1.249s      20.929us     973.803ms         0.03%     973.803ms      16.312us         59700  
                               aten::threshold_backward         0.02%     685.345ms         0.03%        1.114s      55.989us     941.204ms         0.03%     941.204ms      47.297us         19900  
                                    LogSoftmaxBackward0         0.01%     197.648ms         0.03%     882.402ms      88.684us     317.702ms         0.01%     784.624ms      78.857us          9950  
                                      aten::nll_loss_nd         0.00%      83.480ms         0.02%     735.708ms      73.941us     111.219ms         0.00%     703.107ms      70.664us          9950  
                                         aten::nll_loss         0.00%      84.598ms         0.02%     625.713ms      62.886us      99.713ms         0.00%     591.888ms      59.486us          9950  
                                      aten::log_softmax         0.00%     114.152ms         0.02%     596.152ms      59.915us     194.593ms         0.01%     553.372ms      55.615us          9950  
                                 aten::nll_loss_forward         0.01%     248.584ms         0.01%     512.148ms      51.472us     425.081ms         0.01%     492.175ms      49.465us          9950  
                                        aten::ones_like         0.00%      85.591ms         0.02%     539.912ms      54.263us     143.360ms         0.00%     491.405ms      49.387us          9950  
                                           aten::expand         0.01%     228.823ms         0.02%     613.178ms      20.542us     346.961ms         0.01%     472.263ms      15.821us         29850  
                       aten::_log_softmax_backward_data         0.01%     344.881ms         0.02%     576.667ms      57.956us     466.922ms         0.01%     466.922ms      46.927us          9950  
                              aten::_local_scalar_dense         0.01%     457.898ms         0.02%     858.428ms      14.379us     433.556ms         0.01%     433.556ms       7.262us         59700  
                                           aten::narrow         0.00%     108.629ms         0.01%     495.650ms      49.814us     173.176ms         0.01%     420.784ms      42.290us          9950  
                                             aten::view         0.01%     438.408ms         0.02%     759.044ms      25.429us     388.164ms         0.01%     388.164ms      13.004us         29850  
                                          aten::resize_         0.01%     434.517ms         0.02%     620.755ms      12.477us     351.136ms         0.01%     351.136ms       7.058us         49752  
                                     aten::resolve_conj         0.01%     377.910ms         0.02%     748.791ms      12.543us     330.861ms         0.01%     330.861ms       5.542us         59700  
                                     aten::_log_softmax         0.01%     249.603ms         0.01%     367.610ms      36.946us     323.304ms         0.01%     323.304ms      32.493us          9950  
                                      aten::resolve_neg         0.01%     363.236ms         0.02%     725.677ms      12.155us     319.939ms         0.01%     319.939ms       5.359us         59700  
                aten::_has_compatible_shallow_copy_type         0.01%     225.127ms         0.01%     442.888ms      11.128us     190.205ms         0.01%     190.205ms       4.779us         39800  
                                             aten::set_         0.00%     127.260ms         0.01%     219.103ms      22.016us     133.990ms         0.00%     133.990ms      13.464us          9952  
                                     train data prepare         0.00%      32.366ms         0.00%      32.384ms      32.384ms      32.374ms         0.00%      32.379ms      32.379ms             1  
                                         aten::randperm         0.00%      11.533ms         0.00%      23.136ms      11.568ms      11.559ms         0.00%      23.122ms      11.561ms             2  
                                       aten::zeros_like         0.00%     193.000us         0.00%       1.896ms     158.000us     442.000us         0.00%       1.762ms     146.833us            12  
                                           aten::detach         0.00%      71.000us         0.00%     292.000us      48.667us     139.000us         0.00%     230.000us      38.333us             6  
                                                 detach         0.00%      87.000us         0.00%     151.000us      25.167us      91.000us         0.00%      91.000us      15.167us             6  
                                    aten::scalar_tensor         0.00%      10.000us         0.00%      16.000us      16.000us       8.000us         0.00%       8.000us       8.000us             1  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 3465.219s
Self CUDA time total: 3460.448s

2023-03-12 20:27:29,437 - INFO - Rank 0 | wait sampler total time: 11.803465366363525, total iters: 9950, avg iter time:0.001186277926267691
