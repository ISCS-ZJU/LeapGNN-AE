2023-03-16 15:07:43,224 - INFO - Rank 0 | Client Args: Namespace(dataset='./dist/repgnn_data/ogbn_arxiv128/', sampling='10-10', hidden_size=256, n_classes=60, batch_size=8000, dropout=0.2, lr=0.03, weight_decay=0, model_name='gcn', epoch=1, num_worker=1, cache_size=0, seed=None, log=True, dist_url='tcp://10.214.242.140:23456', world_size=2, rank=0, gpu=0, grpc_port='10.214.242.140:18110', mlp_layers=1, block='res+', conv='gen', gcn_aggr='max', norm='batch', t=1.0, p=1.0, y=0.0, learn_t=False, learn_p=False, learn_y=False, msg_norm=False, learn_msg_scale=False, distributed=True)
2023-03-16 15:07:44,897 - INFO - Rank 0 | Added key: store_based_barrier_key:1 to store for rank: 0
2023-03-16 15:07:44,897 - INFO - Rank 0 | Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
2023-03-16 15:07:44,898 - INFO - Rank 0 | Using 2 distributed GPUs in total for training...
2023-03-16 15:07:58,507 - INFO - Rank 0 | Reducer buckets have been rebuilt in this iteration.
2023-03-16 15:08:03,789 - INFO - Rank 0 | rank: 0, iter_num: 7
2023-03-16 15:08:03,790 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 0 on rank 0: 582029 / 1096983 = 0.5305724883612599
2023-03-16 15:08:03,791 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 0.15 s, total_remote_feats_gather_time = 4.321 s
2023-03-16 15:08:03,792 - INFO - Rank 0 | => cur_epoch 0 finished on rank 0
2023-03-16 15:08:05,758 - INFO - Rank 0 | -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      total epochs time         3.16%     334.656ms        99.20%       10.518s       10.518s     335.800ms         3.17%       10.518s       10.518s             1  
                                             fetch feat         0.27%      29.100ms        65.11%        6.903s     986.195ms      34.039ms         0.32%        6.903s     986.201ms             7  
                           fetch feat from cache server        59.20%        6.277s        60.87%        6.454s     230.510ms        6.293s        59.38%        6.454s     230.499ms            28  
                        gpu-compute with optimizer.step         0.04%       3.867ms        30.76%        3.262s     465.941ms       4.589ms         0.04%        3.262s     465.931ms             7  
                                           DDP backward        21.77%        2.309s        21.78%        2.309s     329.910ms        2.309s        21.78%        2.309s     329.909ms             7  
                                            DDP forward         0.01%     885.000us         8.60%     911.380ms     130.197ms       1.266ms         0.01%     911.262ms     130.180ms             7  
                        DistributedDataParallel.forward         2.51%     266.632ms         8.58%     909.266ms     129.895ms     382.389ms         3.61%     909.145ms     129.878ms             7  
                                             CopyReduce         0.11%      11.668ms         4.37%     463.214ms      22.058ms     458.125ms         4.32%     463.697ms      22.081ms            21  
                                            aten::copy_         1.32%     139.959ms         3.99%     422.996ms       1.527ms     418.578ms         3.95%     418.578ms       1.511ms           277  
                             move feats from CPU to GPU         0.22%      23.177ms         2.94%     311.619ms      11.129ms      24.794ms         0.23%     311.019ms      11.108ms            28  
                                               aten::to         0.01%       1.335ms         2.85%     302.648ms       3.561ms       2.228ms         0.02%     301.522ms       3.547ms            85  
                                         aten::_to_copy         0.02%       2.225ms         2.83%     300.174ms       3.898ms       4.265ms         0.04%     299.294ms       3.887ms            77  
                                          create frames         0.56%      59.356ms         0.60%      63.264ms       2.259ms      60.992ms         0.58%      62.816ms       2.243ms            28  
autograd::engine::evaluate_function: CopyReduceBackw...         0.01%     605.000us         0.28%      30.196ms       2.157ms     853.000us         0.01%      30.002ms       2.143ms            14  
                                     CopyReduceBackward         0.10%      10.603ms         0.28%      29.370ms       2.098ms      24.619ms         0.23%      29.149ms       2.082ms            14  
                                            aten::index         0.23%      24.814ms         0.28%      29.683ms     605.776us      26.111ms         0.25%      28.797ms     587.694us            49  
                                   DDP optimizer.step()         0.00%     512.000us         0.26%      27.579ms       3.940ms     760.000us         0.01%      27.491ms       3.927ms             7  
                               Optimizer.step#Adam.step         0.06%       5.881ms         0.25%      26.345ms       3.764ms      10.302ms         0.10%      26.261ms       3.752ms             7  
                                            aten::slice         0.11%      11.676ms         0.31%      33.156ms      83.939us      19.003ms         0.18%      25.562ms      64.714us           395  
    autograd::engine::evaluate_function: AddmmBackward0         0.01%       1.148ms         0.19%      19.845ms     945.000us     926.000us         0.01%      20.618ms     981.810us            21  
                                            aten::zeros         0.07%       7.770ms         0.23%      24.802ms     125.263us      13.812ms         0.13%      20.134ms     101.687us           198  
                                            get nf_nids         0.07%       7.692ms         0.18%      18.626ms       2.661ms       9.455ms         0.09%      18.516ms       2.645ms             7  
                                         AddmmBackward0         0.01%     961.000us         0.13%      13.700ms     652.381us       1.155ms         0.01%      16.566ms     788.857us            21  
                                          aten::reshape         0.07%       7.498ms         0.23%      23.996ms     108.090us       9.542ms         0.09%      15.830ms      71.306us           222  
                                            aten::empty         0.10%      10.083ms         0.21%      21.828ms      36.380us      13.840ms         0.13%      13.840ms      23.067us           600  
                                           aten::linear         0.00%     358.000us         0.07%       7.565ms     360.238us     471.000us         0.00%      12.726ms     606.000us            21  
                                               aten::mm         0.04%       4.196ms         0.06%       6.755ms     193.000us      12.674ms         0.12%      12.674ms     362.114us            35  
                                            aten::addmm         0.03%       3.492ms         0.05%       5.651ms     269.095us      10.547ms         0.10%      11.052ms     526.286us            21  
                                            fetch label         0.01%     965.000us         0.10%      10.081ms       1.440ms       1.403ms         0.01%       9.931ms       1.419ms             7  
                                       aten::as_strided         0.08%       8.942ms         0.20%      20.708ms      31.712us       9.575ms         0.09%       9.575ms      14.663us           653  
autograd::engine::evaluate_function: torch::autograd...         0.03%       3.143ms         0.11%      12.110ms     288.333us       3.964ms         0.04%       9.302ms     221.476us            42  
                                          aten::dropout         0.00%     519.000us         0.07%       6.894ms     328.286us     379.000us         0.00%       8.850ms     421.429us            21  
                                    aten::empty_strided         0.04%       4.541ms         0.10%      10.416ms      75.478us       8.662ms         0.08%       8.662ms      62.768us           138  
                                   aten::_fused_dropout         0.01%       1.582ms         0.06%       6.010ms     286.190us       5.698ms         0.05%       8.471ms     403.381us            21  
                                       aten::empty_like         0.01%       1.292ms         0.08%       8.657ms     115.427us       2.170ms         0.02%       7.493ms      99.907us            75  
autograd::engine::evaluate_function: FusedDropoutBac...         0.01%     543.000us         0.05%       5.823ms     415.929us     314.000us         0.00%       6.934ms     495.286us            14  
                                asign frame to nodeflow         0.05%       5.704ms         0.07%       7.185ms     256.607us       6.183ms         0.06%       6.680ms     238.571us            28  
                                  FusedDropoutBackward0         0.00%     376.000us         0.05%       5.073ms     362.357us     427.000us         0.00%       6.620ms     472.857us            14  
                                              aten::div         0.03%       2.711ms         0.05%       5.499ms      71.416us       6.535ms         0.06%       6.535ms      84.870us            77  
                                   aten::_reshape_alias         0.06%       5.939ms         0.09%       9.978ms      44.946us       6.288ms         0.06%       6.288ms      28.324us           222  
                                    aten::_masked_scale         0.01%     844.000us         0.04%       4.477ms     319.786us       3.395ms         0.03%       6.193ms     442.357us            14  
                                            aten::zero_         0.03%       3.129ms         0.10%      11.111ms      43.917us       4.028ms         0.04%       6.002ms      23.723us           253  
                                                aten::t         0.02%       2.111ms         0.09%       9.062ms      92.469us       2.529ms         0.02%       5.555ms      56.684us            98  
                                        aten::clamp_min         0.01%     916.000us         0.04%       4.242ms      86.571us       2.573ms         0.02%       4.754ms      97.020us            49  
                                             aten::add_         0.03%       3.331ms         0.06%       6.310ms      52.583us       4.230ms         0.04%       4.230ms      35.250us           120  
                                     DDP calculate loss         0.01%     641.000us         0.04%       3.722ms     531.714us     427.000us         0.00%       4.121ms     588.714us             7  
                                         aten::randperm         0.02%       1.883ms         0.04%       3.884ms       1.942ms       1.916ms         0.02%       3.855ms       1.927ms             2  
     autograd::engine::evaluate_function: ReluBackward0         0.00%     423.000us         0.02%       2.589ms     184.929us     121.000us         0.00%       3.844ms     274.571us            14  
                                       aten::zeros_like         0.00%     348.000us         0.04%       3.993ms     332.750us     782.000us         0.01%       3.745ms     312.083us            12  
                                          ReluBackward0         0.00%     377.000us         0.02%       1.921ms     137.214us     266.000us         0.00%       3.723ms     265.929us            14  
                                        aten::new_empty         0.01%     725.000us         0.04%       4.678ms      83.536us       1.044ms         0.01%       3.699ms      66.054us            56  
                                           aten::unbind         0.00%     359.000us         0.04%       3.792ms     541.714us     852.000us         0.01%       3.692ms     527.429us             7  
                               aten::cross_entropy_loss         0.00%     148.000us         0.03%       2.922ms     417.429us     199.000us         0.00%       3.641ms     520.143us             7  
                               aten::threshold_backward         0.01%     825.000us         0.01%       1.314ms      93.857us       3.457ms         0.03%       3.457ms     246.929us            14  
                                        aten::transpose         0.01%       1.464ms         0.05%       5.574ms      56.878us       2.003ms         0.02%       3.026ms      30.878us            98  
        autograd::engine::evaluate_function: TBackward0         0.00%     513.000us         0.03%       3.557ms     169.381us     746.000us         0.01%       2.942ms     140.095us            21  
                                             aten::mul_         0.02%       2.046ms         0.04%       3.936ms      46.857us       2.917ms         0.03%       2.917ms      34.726us            84  
                                              aten::sum         0.02%       1.891ms         0.04%       3.767ms     179.381us       2.871ms         0.03%       2.871ms     136.714us            21  
                                           aten::select         0.01%     611.000us         0.03%       3.324ms      79.143us       2.356ms         0.02%       2.840ms      67.619us            42  
autograd::engine::evaluate_function: NllLossBackward...         0.00%     465.000us         0.03%       3.202ms     457.429us     339.000us         0.00%       2.820ms     402.857us             7  
                                      aten::nll_loss_nd         0.00%      79.000us         0.02%       2.026ms     289.429us      87.000us         0.00%       2.791ms     398.714us             7  
                                     train data prepare         0.03%       2.755ms         0.03%       2.789ms       2.789ms       2.774ms         0.03%       2.780ms       2.780ms             1  
                                   DDP optimizer.zero()         0.00%     260.000us         0.03%       2.822ms     403.143us     382.000us         0.00%       2.719ms     388.429us             7  
                                         aten::nll_loss         0.00%     101.000us         0.02%       1.887ms     269.571us     105.000us         0.00%       2.704ms     386.286us             7  
                        torch::autograd::AccumulateGrad         0.01%     828.000us         0.04%       4.302ms     102.429us       1.122ms         0.01%       2.704ms      64.381us            42  
                                 aten::nll_loss_forward         0.00%     289.000us         0.02%       1.722ms     246.000us       2.516ms         0.02%       2.599ms     371.286us             7  
                                       NllLossBackward0         0.00%     259.000us         0.02%       2.439ms     348.429us     283.000us         0.00%       2.481ms     354.429us             7  
                                             aten::relu         0.00%     380.000us         0.02%       2.481ms     177.214us      48.000us         0.00%       2.298ms     164.143us            14  
                                            aten::fill_         0.02%       1.748ms         0.03%       3.648ms      43.952us       2.247ms         0.02%       2.247ms      27.072us            83  
                                aten::nll_loss_backward         0.01%     535.000us         0.02%       2.022ms     288.857us       1.153ms         0.01%       2.198ms     314.000us             7  
                                             TBackward0         0.00%     329.000us         0.03%       2.698ms     128.476us     581.000us         0.01%       2.196ms     104.571us            21  
                     Optimizer.zero_grad#Adam.zero_grad         0.00%     427.000us         0.02%       2.114ms     302.000us     738.000us         0.01%       2.064ms     294.857us             7  
                                              aten::mul         0.02%       1.673ms         0.03%       2.960ms      70.476us       1.919ms         0.02%       1.919ms      45.690us            42  
                                             aten::sqrt         0.01%       1.254ms         0.02%       2.213ms      52.690us       1.711ms         0.02%       1.711ms      40.738us            42  
                                              aten::cat         0.00%     215.000us         0.02%       1.758ms     251.143us     315.000us         0.00%       1.657ms     236.714us             7  
                                             aten::item         0.01%     651.000us         0.02%       2.205ms      52.500us       1.122ms         0.01%       1.631ms      38.833us            42  
                                         aten::addcmul_         0.01%       1.105ms         0.02%       2.035ms      48.452us       1.530ms         0.01%       1.530ms      36.429us            42  
                                         aten::addcdiv_         0.01%       1.052ms         0.02%       2.017ms      48.024us       1.497ms         0.01%       1.497ms      35.643us            42  
                                             aten::_cat         0.00%     382.000us         0.01%       1.433ms     204.714us     655.000us         0.01%       1.342ms     191.714us             7  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%     227.000us         0.01%       1.295ms     185.000us     336.000us         0.00%       1.180ms     168.571us             7  
                                    LogSoftmaxBackward0         0.00%     229.000us         0.01%     937.000us     133.857us     345.000us         0.00%     844.000us     120.571us             7  
                                            aten::clamp         0.01%     610.000us         0.01%       1.549ms      73.762us     379.000us         0.00%     734.000us      34.952us            21  
                                      aten::log_softmax         0.00%     124.000us         0.01%     700.000us     100.000us     227.000us         0.00%     651.000us      93.000us             7  
                                        aten::ones_like         0.00%      74.000us         0.01%     582.000us      83.143us     170.000us         0.00%     530.000us      75.714us             7  
                              aten::_local_scalar_dense         0.00%     440.000us         0.01%     964.000us      22.952us     509.000us         0.00%     509.000us      12.119us            42  
                                           aten::expand         0.00%     229.000us         0.01%     674.000us      32.095us     358.000us         0.00%     505.000us      24.048us            21  
                       aten::_log_softmax_backward_data         0.00%     351.000us         0.01%     597.000us      85.286us     499.000us         0.00%     499.000us      71.286us             7  
                                           aten::narrow         0.00%     108.000us         0.01%     564.000us      80.571us     203.000us         0.00%     480.000us      68.571us             7  
                                     aten::resolve_conj         0.00%     444.000us         0.01%       1.024ms      24.381us     455.000us         0.00%     455.000us      10.833us            42  
                                      aten::resolve_neg         0.00%     394.000us         0.01%     931.000us      22.167us     439.000us         0.00%     439.000us      10.452us            42  
                                         aten::new_ones         0.00%     252.000us         0.02%       2.371ms     112.905us      99.000us         0.00%     438.000us      20.857us            21  
                aten::_has_compatible_shallow_copy_type         0.00%     367.000us         0.01%     867.000us      30.964us     384.000us         0.00%     384.000us      13.714us            28  
                                     aten::_log_softmax         0.00%     276.000us         0.00%     431.000us      61.571us     381.000us         0.00%     381.000us      54.429us             7  
                                             aten::ones         0.00%     341.000us         0.02%       1.911ms      91.000us     148.000us         0.00%     339.000us      16.143us            21  
                                             aten::view         0.00%     453.000us         0.01%     859.000us      40.905us     255.000us         0.00%     255.000us      12.143us            21  
                                          aten::resize_         0.00%     422.000us         0.01%       1.326ms      35.838us     225.000us         0.00%     225.000us       6.081us            37  
                                           aten::detach         0.00%      79.000us         0.00%     334.000us      55.667us     130.000us         0.00%     210.000us      35.000us             6  
                                             aten::set_         0.00%     164.000us         0.00%     295.000us      32.778us     182.000us         0.00%     182.000us      20.222us             9  
                                                 detach         0.00%     100.000us         0.00%     172.000us      28.667us      80.000us         0.00%      80.000us      13.333us             6  
                                    aten::scalar_tensor         0.00%      12.000us         0.00%      18.000us      18.000us      12.000us         0.00%      12.000us      12.000us             1  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 10.603s
Self CUDA time total: 10.598s

2023-03-16 15:08:05,758 - INFO - Rank 0 | wait sampler total time: 0.3276255130767822, total iters: 7, avg iter time:0.046803644725254605
