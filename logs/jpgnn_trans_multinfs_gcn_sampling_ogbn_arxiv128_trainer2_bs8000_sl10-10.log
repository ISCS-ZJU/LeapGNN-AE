2023-03-16 16:16:09,291 - INFO - Rank 0 | Client Args: Namespace(dataset='./dist/repgnn_data/ogbn_arxiv128/', num_gpu=1, sampling='10-10', hidden_size=256, n_classes=60, batch_size=8000, dropout=0.2, lr=0.03, weight_decay=0, model_name='gcn', epoch=1, num_worker=1, cache_size=0, ckpt_path='/dev/shm', seed=None, log=True, dist_url='tcp://10.214.242.140:23457', world_size=2, rank=0, gpu=0, grpc_port='10.214.242.140:18110', distributed=True)
2023-03-16 16:16:09,379 - INFO - Rank 0 | Added key: store_based_barrier_key:1 to store for rank: 0
2023-03-16 16:16:09,379 - INFO - Rank 0 | Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
2023-03-16 16:16:09,379 - INFO - Rank 0 | Using 2 distributed GPUs in total for training...
2023-03-16 16:16:16,204 - INFO - Rank 0 | n_sub_batches:55049
2023-03-16 16:16:19,464 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 16:16:19,494 - INFO - Rank 0 | Reducer buckets have been rebuilt in this iteration.
2023-03-16 16:16:19,554 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 16:16:20,453 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 16:16:20,531 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 16:16:21,384 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 16:16:21,463 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 16:16:22,343 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 16:16:22,421 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 16:16:23,274 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 16:16:23,356 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 16:16:24,269 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 16:16:24,343 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 16:16:25,108 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 16:16:25,182 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 16:16:25,204 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 0 on rank 0: 1388907 / 6572838 = 0.21131009162252287
2023-03-16 16:16:25,205 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 1.561 s, total_remote_feats_gather_time = 17.63 s
2023-03-16 16:16:25,205 - INFO - Rank 0 | => cur_epoch 0 finished on rank 0
2023-03-16 16:16:29,573 - INFO - Rank 0 | -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      total epochs time         3.71%     340.115ms        98.26%        9.018s        9.018s     342.736ms         3.74%        9.019s        9.019s             1  
                                             fetch feat         1.24%     113.521ms        59.38%        5.449s     778.495ms     121.083ms         1.32%        5.449s     778.491ms             7  
                           fetch feat from cache server        49.25%        4.520s        53.74%        4.932s     176.156ms        4.538s        49.52%        4.932s     176.146ms            28  
                                            gpu-compute        19.93%        1.829s        31.83%        2.921s     139.110ms        1.830s        19.96%        2.921s     139.096ms            21  
                        DistributedDataParallel.forward         3.44%     315.458ms        11.44%        1.050s      74.965ms     424.356ms         4.63%        1.049s      74.949ms            14  
                                             CopyReduce         0.28%      25.495ms         5.31%     487.040ms      11.596ms     468.949ms         5.12%     486.568ms      11.585ms            42  
                                            aten::copy_         1.67%     153.218ms         5.28%     484.821ms     632.926us     472.989ms         5.16%     472.989ms     617.479us           766  
                                               aten::to         0.18%      16.791ms         4.69%     430.059ms       1.054ms      22.030ms         0.24%     424.266ms       1.040ms           408  
                                         aten::_to_copy         0.34%      31.004ms         4.44%     407.384ms       1.039ms      42.696ms         0.47%     402.236ms       1.026ms           392  
            fetch feat from cache server - python while         0.84%      77.062ms         3.73%     341.966ms       2.164ms     109.624ms         1.20%     338.459ms       2.142ms           158  
                             move feats from CPU to GPU         0.12%      10.694ms         3.55%     325.662ms      11.631ms      13.411ms         0.15%     325.073ms      11.610ms            28  
                                         model transfer         1.81%     165.670ms         2.73%     250.725ms      17.909ms     171.973ms         1.88%     250.548ms      17.896ms            14  
                                            aten::slice         0.87%      79.797ms         1.68%     154.034ms     130.316us     104.156ms         1.14%     124.944ms     105.706us          1182  
                                            aten::zeros         0.40%      36.882ms         0.78%      71.738ms     193.364us      48.682ms         0.53%      63.703ms     171.706us           371  
                                            aten::index         0.55%      50.478ms         0.69%      63.107ms     643.949us      53.346ms         0.58%      61.354ms     626.061us            98  
autograd::engine::evaluate_function: CopyReduceBackw...         0.01%       1.220ms         0.51%      46.859ms       1.674ms       3.845ms         0.04%      46.408ms       1.657ms            28  
                                     CopyReduceBackward         0.22%      20.539ms         0.49%      45.096ms       1.611ms      36.818ms         0.40%      42.563ms       1.520ms            28  
    autograd::engine::evaluate_function: AddmmBackward0         0.03%       2.490ms         0.43%      39.034ms     929.381us       2.799ms         0.03%      38.168ms     908.762us            42  
                               Optimizer.step#Adam.step         0.14%      12.563ms         0.33%      30.563ms       4.366ms      16.550ms         0.18%      30.489ms       4.356ms             7  
                                          aten::reshape         0.20%      18.526ms         0.45%      41.174ms     138.168us      21.319ms         0.23%      29.030ms      97.416us           298  
                                         AddmmBackward0         0.02%       2.155ms         0.30%      27.345ms     651.071us       3.093ms         0.03%      28.995ms     690.357us            42  
                                       aten::as_strided         0.28%      25.698ms         0.59%      54.185ms      33.697us      26.149ms         0.29%      26.149ms      16.262us          1608  
                                            aten::empty         0.23%      20.855ms         0.46%      42.653ms      37.813us      24.841ms         0.27%      24.841ms      22.022us          1128  
                                           aten::linear         0.03%       2.940ms         0.21%      19.659ms     468.071us       3.283ms         0.04%      24.579ms     585.214us            42  
autograd::engine::evaluate_function: torch::autograd...         0.07%       6.517ms         0.28%      25.740ms     306.429us       9.977ms         0.11%      24.367ms     290.083us            84  
                                       aten::zeros_like         0.07%       6.205ms         0.27%      25.029ms     260.719us       8.726ms         0.10%      23.687ms     246.740us            96  
                                            fetch label         0.03%       2.668ms         0.22%      19.798ms       1.414ms       3.476ms         0.04%      19.542ms       1.396ms            14  
                                    aten::empty_strided         0.17%      15.360ms         0.30%      27.646ms      47.177us      19.537ms         0.21%      19.537ms      33.340us           586  
                                          aten::dropout         0.02%       2.086ms         0.19%      17.476ms     416.095us       1.931ms         0.02%      19.294ms     459.381us            42  
                                               aten::mm         0.08%       7.749ms         0.13%      12.339ms     176.271us      19.102ms         0.21%      19.102ms     272.886us            70  
                                       aten::empty_like         0.09%       8.134ms         0.23%      20.681ms      93.158us      11.262ms         0.12%      17.952ms      80.865us           222  
                                   aten::_fused_dropout         0.05%       4.730ms         0.16%      14.731ms     350.738us       9.831ms         0.11%      17.363ms     413.405us            42  
                                            aten::addmm         0.07%       6.650ms         0.12%      11.280ms     268.571us      14.459ms         0.16%      16.635ms     396.071us            42  
                                                aten::t         0.06%       5.525ms         0.24%      21.641ms     110.413us       6.974ms         0.08%      15.349ms      78.311us           196  
                                            aten::zero_         0.08%       7.666ms         0.25%      23.163ms      48.156us       8.666ms         0.09%      15.286ms      31.780us           481  
                                            get nf_nids         0.03%       2.737ms         0.16%      14.528ms       2.075ms       3.130ms         0.03%      14.404ms       2.058ms             7  
                                     train data prepare         0.14%      13.202ms         0.14%      13.240ms      13.240ms      13.227ms         0.14%      13.233ms      13.233ms             1  
autograd::engine::evaluate_function: FusedDropoutBac...         0.01%       1.076ms         0.10%       9.210ms     328.929us     888.000us         0.01%       9.357ms     334.179us            28  
        autograd::engine::evaluate_function: TBackward0         0.01%       1.141ms         0.11%       9.761ms     232.405us       3.771ms         0.04%       9.141ms     217.643us            42  
                                        aten::clamp_min         0.04%       3.892ms         0.11%       9.746ms      99.449us       4.588ms         0.05%       9.083ms      92.684us            98  
                                asign frame to nodeflow         0.08%       7.620ms         0.10%       9.020ms     322.143us       8.127ms         0.09%       8.559ms     305.679us            28  
                                  FusedDropoutBackward0         0.01%     736.000us         0.08%       7.617ms     272.036us     849.000us         0.01%       8.469ms     302.464us            28  
                                        aten::transpose         0.05%       4.261ms         0.14%      13.090ms      66.786us       6.005ms         0.07%       8.375ms      42.730us           196  
                        torch::autograd::AccumulateGrad         0.02%       1.844ms         0.10%       9.397ms     111.869us       3.478ms         0.04%       8.166ms      97.214us            84  
                                        aten::new_empty         0.04%       3.487ms         0.10%       9.373ms      83.688us       4.646ms         0.05%       8.055ms      71.920us           112  
                                            aten::fill_         0.08%       7.224ms         0.11%       9.648ms      87.709us       7.949ms         0.09%       7.949ms      72.264us           110  
                                   aten::_reshape_alias         0.08%       7.412ms         0.13%      12.338ms      41.403us       7.711ms         0.08%       7.711ms      25.876us           298  
                                    fetch feat overhead         0.06%       5.216ms         0.09%       8.041ms     287.179us       6.321ms         0.07%       7.673ms     274.036us            28  
                                    aten::_masked_scale         0.02%       1.647ms         0.07%       6.394ms     228.357us       4.464ms         0.05%       7.620ms     272.143us            28  
                                              aten::div         0.04%       3.945ms         0.08%       6.988ms      62.393us       7.487ms         0.08%       7.487ms      66.848us           112  
                                 sync for each sub_iter         0.07%       6.639ms         0.08%       7.216ms     515.429us       6.875ms         0.08%       7.042ms     503.000us            14  
                                             aten::add_         0.05%       4.690ms         0.10%       9.123ms      56.315us       6.931ms         0.08%       6.931ms      42.784us           162  
                               aten::cross_entropy_loss         0.01%     640.000us         0.07%       6.143ms     438.786us     768.000us         0.01%       6.608ms     472.000us            14  
     autograd::engine::evaluate_function: ReluBackward0         0.01%     925.000us         0.06%       5.324ms     190.143us     517.000us         0.01%       5.886ms     210.214us            28  
                                              aten::sum         0.04%       3.476ms         0.07%       6.746ms     160.619us       5.666ms         0.06%       5.666ms     134.905us            42  
autograd::engine::evaluate_function: NllLossBackward...         0.01%     774.000us         0.07%       5.976ms     426.857us     877.000us         0.01%       5.403ms     385.929us            14  
                                             TBackward0         0.01%     749.000us         0.07%       6.001ms     142.881us       1.482ms         0.02%       5.370ms     127.857us            42  
                                          ReluBackward0         0.01%     786.000us         0.04%       3.906ms     139.500us     818.000us         0.01%       5.369ms     191.750us            28  
                                              aten::mul         0.04%       3.257ms         0.07%       6.003ms      71.464us       4.637ms         0.05%       4.637ms      55.202us            84  
                               aten::threshold_backward         0.02%       1.549ms         0.03%       2.612ms      93.286us       4.551ms         0.05%       4.551ms     162.536us            28  
                                       NllLossBackward0         0.01%     466.000us         0.05%       4.723ms     337.357us     555.000us         0.01%       4.526ms     323.286us            14  
                                      aten::nll_loss_nd         0.00%     349.000us         0.04%       3.600ms     257.143us     372.000us         0.00%       4.183ms     298.786us            14  
                                             aten::relu         0.01%       1.367ms         0.08%       6.933ms     247.607us      98.000us         0.00%       4.167ms     148.821us            28  
                                aten::nll_loss_backward         0.01%       1.052ms         0.04%       4.027ms     287.643us       2.257ms         0.02%       3.971ms     283.643us            14  
                                         aten::nll_loss         0.00%     356.000us         0.03%       3.148ms     224.857us     383.000us         0.00%       3.811ms     272.214us            14  
                                            aten::clamp         0.02%       2.042ms         0.04%       3.979ms      94.738us       2.404ms         0.03%       3.625ms      86.310us            42  
                                         create sampler         0.04%       3.314ms         0.04%       3.436ms       3.436ms       3.367ms         0.04%       3.428ms       3.428ms             1  
                                 aten::nll_loss_forward         0.01%     907.000us         0.03%       2.665ms     190.357us       3.247ms         0.04%       3.428ms     244.857us            14  
                                         aten::new_ones         0.01%       1.346ms         0.08%       7.347ms     174.929us     662.000us         0.01%       3.340ms      79.524us            42  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.01%     478.000us         0.03%       3.180ms     227.143us     731.000us         0.01%       2.921ms     208.643us            14  
                                             aten::ones         0.03%       2.325ms         0.06%       5.532ms     131.714us       1.425ms         0.02%       2.678ms      63.762us            42  
                                             aten::mul_         0.02%       1.883ms         0.04%       3.617ms      43.060us       2.663ms         0.03%       2.663ms      31.702us            84  
                                    LogSoftmaxBackward0         0.00%     444.000us         0.03%       2.416ms     172.571us     708.000us         0.01%       2.190ms     156.429us            14  
                                           aten::expand         0.02%       1.517ms         0.03%       2.531ms      60.262us       1.866ms         0.02%       2.176ms      51.810us            42  
                                        aten::ones_like         0.01%     518.000us         0.02%       1.841ms     131.500us     727.000us         0.01%       1.716ms     122.571us            14  
                                      aten::log_softmax         0.01%     609.000us         0.02%       1.771ms     126.500us     833.000us         0.01%       1.657ms     118.357us            14  
                                             aten::sqrt         0.01%       1.126ms         0.02%       2.009ms      47.833us       1.545ms         0.02%       1.545ms      36.786us            42  
                       aten::_log_softmax_backward_data         0.01%     727.000us         0.02%       1.697ms     121.214us       1.482ms         0.02%       1.482ms     105.857us            14  
                                         aten::addcdiv_         0.01%     963.000us         0.02%       1.836ms      43.714us       1.371ms         0.01%       1.371ms      32.643us            42  
                                         aten::addcmul_         0.01%     979.000us         0.02%       1.799ms      42.833us       1.340ms         0.01%       1.340ms      31.905us            42  
                                          aten::resize_         0.01%     605.000us         0.02%       1.391ms      24.839us     851.000us         0.01%     851.000us      15.196us            56  
                aten::_has_compatible_shallow_copy_type         0.01%     765.000us         0.02%       1.726ms      30.821us     742.000us         0.01%     742.000us      13.250us            56  
                                     aten::_log_softmax         0.01%     545.000us         0.01%     850.000us      60.714us     739.000us         0.01%     739.000us      52.786us            14  
                                             aten::view         0.01%     905.000us         0.02%       1.694ms      40.333us     708.000us         0.01%     708.000us      16.857us            42  
                                     aten::resolve_conj         0.01%     598.000us         0.01%       1.349ms      24.089us     586.000us         0.01%     586.000us      10.464us            56  
                                      aten::resolve_neg         0.01%     573.000us         0.01%       1.302ms      23.250us     583.000us         0.01%     583.000us      10.411us            56  
                                             aten::set_         0.00%     295.000us         0.01%     566.000us      35.375us     324.000us         0.00%     324.000us      20.250us            16  
                                           aten::detach         0.00%     109.000us         0.00%     401.000us      66.833us     199.000us         0.00%     313.000us      52.167us             6  
                                                 detach         0.00%     102.000us         0.00%     199.000us      33.167us     114.000us         0.00%     114.000us      19.000us             6  
                                          aten::detach_         0.00%      22.000us         0.00%      43.000us      43.000us      27.000us         0.00%      35.000us      35.000us             1  
                                                detach_         0.00%       7.000us         0.00%      14.000us      14.000us       8.000us         0.00%       8.000us       8.000us             1  
                                        cudaEventCreate         0.84%      76.924ms         0.84%      76.959ms       3.394us       0.000us         0.00%       0.000us       0.000us         22678  
                                        cudaEventRecord         1.44%     132.037ms         1.44%     132.047ms       5.786us       0.000us         0.00%       0.000us       0.000us         22821  
                                        cudaMemcpyAsync         3.41%     312.820ms         3.41%     312.820ms     610.977us       0.000us         0.00%       0.000us       0.000us           512  
                                  cudaStreamSynchronize         0.06%       5.618ms         0.06%       5.618ms      18.006us       0.000us         0.00%       0.000us       0.000us           312  
                                  cudaStreamIsCapturing         0.00%     142.000us         0.00%     142.000us       2.152us       0.000us         0.00%       0.000us       0.000us            66  
                                             cudaMalloc         1.04%      95.302ms         1.04%      95.302ms     312.466us       0.000us         0.00%       0.000us       0.000us           305  
                               cudaEventCreateWithFlags         0.00%     300.000us         0.00%     300.000us       2.778us       0.000us         0.00%       0.000us       0.000us           108  
                                       cudaLaunchKernel         0.21%      19.454ms         0.21%      19.454ms      12.583us       0.000us         0.00%       0.000us       0.000us          1546  
                                             cudaMemcpy         0.27%      25.134ms         0.27%      25.134ms      98.953us       0.000us         0.00%       0.000us       0.000us           254  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 9.178s
Self CUDA time total: 9.166s

2023-03-16 16:16:29,573 - INFO - Rank 0 | wait sampler total time: 0.32105302810668945, total sub_iters: 7, avg sub_iter time:0.045864718300955634
