2023-03-16 15:10:27,091 - INFO - Rank 0 | Client Args: Namespace(dataset='./dist/repgnn_data/ogbn_arxiv128/', num_gpu=1, sampling='10-10', hidden_size=256, n_classes=60, batch_size=8000, dropout=0.2, lr=0.03, weight_decay=0, model_name='gcn', epoch=1, num_worker=1, cache_size=0, ckpt_path='/dev/shm', seed=None, log=True, dist_url='tcp://10.214.242.140:23456', world_size=2, rank=0, gpu=0, grpc_port='10.214.242.140:18110', distributed=True)
2023-03-16 15:10:29,518 - INFO - Rank 0 | Added key: store_based_barrier_key:1 to store for rank: 0
2023-03-16 15:10:29,519 - INFO - Rank 0 | Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
2023-03-16 15:10:29,520 - INFO - Rank 0 | Using 2 distributed GPUs in total for training...
2023-03-16 15:10:35,262 - INFO - Rank 0 | n_sub_batches:55049
2023-03-16 15:10:37,734 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 15:10:38,600 - INFO - Rank 0 | Reducer buckets have been rebuilt in this iteration.
2023-03-16 15:10:38,654 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 15:10:39,561 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 15:10:40,480 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 15:10:41,308 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 15:10:42,133 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 15:10:42,950 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 15:10:43,776 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 15:10:44,604 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 15:10:45,447 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 15:10:46,297 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 15:10:47,126 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 15:10:47,893 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 15:10:48,642 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 15:10:48,668 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 0 on rank 0: 562870 / 2405320 = 0.23401044351687095
2023-03-16 15:10:48,669 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 0.61 s, total_remote_feats_gather_time = 4.47 s
2023-03-16 15:10:48,669 - INFO - Rank 0 | => cur_epoch 0 finished on rank 0
2023-03-16 15:10:54,414 - INFO - Rank 0 | -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      total epochs time         2.65%     359.792ms        98.86%       13.427s       13.427s     362.142ms         2.67%       13.428s       13.428s             1  
                                             fetch feat         1.65%     223.721ms        78.87%       10.712s     765.120ms     234.838ms         1.73%       10.712s     765.123ms            14  
                           fetch feat from cache server        66.69%        9.058s        71.57%        9.720s     173.572ms        9.083s        66.93%        9.720s     173.566ms            56  
                                            gpu-compute         7.09%     962.492ms        15.09%        2.050s      97.600ms     962.883ms         7.10%        2.049s      97.589ms            21  
                        DistributedDataParallel.forward         2.37%     322.417ms         7.73%        1.050s      74.985ms     426.917ms         3.15%        1.050s      74.973ms            14  
                                            aten::copy_         1.80%     244.613ms         6.41%     870.204ms     807.239us     857.402ms         6.32%     857.402ms     795.364us          1078  
                                               aten::to         0.14%      19.214ms         5.40%     733.150ms       1.373ms      24.237ms         0.18%     727.443ms       1.362ms           534  
                                         aten::_to_copy         0.27%      36.904ms         5.22%     708.347ms       1.367ms      47.614ms         0.35%     703.206ms       1.358ms           518  
                             move feats from CPU to GPU         0.14%      18.784ms         4.64%     630.415ms      11.257ms      24.590ms         0.18%     629.596ms      11.243ms            56  
            fetch feat from cache server - python while         0.99%     134.184ms         4.06%     551.091ms       1.744ms     171.624ms         1.26%     546.180ms       1.728ms           316  
                                             CopyReduce         0.22%      29.874ms         3.63%     493.410ms      11.748ms     478.126ms         3.52%     493.135ms      11.741ms            42  
                                         model transfer         1.30%     176.123ms         1.81%     245.778ms      17.556ms     180.491ms         1.33%     245.653ms      17.547ms            14  
                                            aten::slice         0.85%     115.358ms         1.54%     208.806ms      95.695us     148.913ms         1.10%     177.562ms      81.376us          2182  
                                            aten::zeros         0.46%      63.153ms         0.79%     107.158ms     163.600us      77.863ms         0.57%      96.578ms     147.447us           655  
                                            aten::index         0.36%      48.713ms         0.43%      58.542ms     597.367us      50.666ms         0.37%      57.181ms     583.480us            98  
autograd::engine::evaluate_function: CopyReduceBackw...         0.01%       1.244ms         0.33%      44.600ms       1.593ms       1.697ms         0.01%      44.207ms       1.579ms            28  
                                     CopyReduceBackward         0.15%      20.976ms         0.32%      42.927ms       1.533ms      37.221ms         0.27%      42.510ms       1.518ms            28  
                                          aten::reshape         0.20%      27.494ms         0.43%      57.820ms     126.798us      29.331ms         0.22%      42.126ms      92.382us           456  
    autograd::engine::evaluate_function: AddmmBackward0         0.03%       3.938ms         0.29%      38.744ms     922.476us       3.929ms         0.03%      38.111ms     907.405us            42  
                                       aten::as_strided         0.24%      32.684ms         0.53%      72.432ms      27.773us      34.627ms         0.26%      34.627ms      13.277us          2608  
                                            aten::empty         0.19%      26.386ms         0.38%      51.153ms      29.197us      28.569ms         0.21%      28.569ms      16.307us          1752  
                                         AddmmBackward0         0.02%       2.161ms         0.19%      26.130ms     622.143us       2.896ms         0.02%      28.070ms     668.333us            42  
                               Optimizer.step#Adam.step         0.09%      12.424ms         0.19%      26.419ms       3.774ms      15.383ms         0.11%      26.363ms       3.766ms             7  
                                           aten::linear         0.02%       2.785ms         0.15%      19.910ms     474.048us       2.943ms         0.02%      25.101ms     597.643us            42  
                                            get nf_nids         0.03%       4.016ms         0.18%      24.108ms       1.722ms       4.587ms         0.03%      23.923ms       1.709ms            14  
autograd::engine::evaluate_function: torch::autograd...         0.05%       6.687ms         0.18%      24.923ms     296.702us       9.694ms         0.07%      23.343ms     277.893us            84  
                                    aten::empty_strided         0.13%      17.934ms         0.21%      29.198ms      41.008us      21.882ms         0.16%      21.882ms      30.733us           712  
                                       aten::zeros_like         0.04%       5.110ms         0.15%      20.551ms     214.073us       6.795ms         0.05%      19.639ms     204.573us            96  
                                               aten::mm         0.06%       8.007ms         0.09%      12.451ms     177.871us      19.181ms         0.14%      19.181ms     274.014us            70  
                                          aten::dropout         0.02%       2.184ms         0.13%      17.009ms     404.976us       1.948ms         0.01%      19.030ms     453.095us            42  
                                            fetch label         0.02%       2.819ms         0.14%      19.169ms       1.369ms       3.443ms         0.03%      18.959ms       1.354ms            14  
                                asign frame to nodeflow         0.12%      16.286ms         0.14%      18.409ms     328.732us      17.043ms         0.13%      17.697ms     316.018us            56  
                                   aten::_fused_dropout         0.04%       5.105ms         0.11%      14.286ms     340.143us      10.244ms         0.08%      17.082ms     406.714us            42  
                                            aten::addmm         0.05%       7.237ms         0.08%      11.242ms     267.667us      14.983ms         0.11%      16.799ms     399.976us            42  
                                       aten::empty_like         0.05%       7.303ms         0.14%      18.489ms      83.284us       9.742ms         0.07%      16.464ms      74.162us           222  
                                            aten::zero_         0.07%       9.171ms         0.19%      25.358ms      33.148us       9.861ms         0.07%      16.194ms      21.169us           765  
                                     train data prepare         0.11%      15.200ms         0.11%      15.233ms      15.233ms      15.221ms         0.11%      15.227ms      15.227ms             1  
                                                aten::t         0.04%       5.376ms         0.15%      20.461ms     104.393us       6.204ms         0.05%      14.760ms      75.306us           196  
                                    fetch feat overhead         0.07%       9.867ms         0.10%      14.218ms     253.893us      11.482ms         0.08%      13.647ms     243.696us            56  
                                   aten::_reshape_alias         0.08%      10.831ms         0.14%      18.458ms      40.478us      12.795ms         0.09%      12.795ms      28.059us           456  
autograd::engine::evaluate_function: FusedDropoutBac...         0.01%       1.084ms         0.07%       9.153ms     326.893us     780.000us         0.01%       9.378ms     334.929us            28  
                                 sync for each sub_iter         0.06%       8.630ms         0.07%       9.083ms     648.786us       8.817ms         0.06%       8.939ms     638.500us            14  
                                  FusedDropoutBackward0         0.01%     749.000us         0.06%       7.636ms     272.714us     777.000us         0.01%       8.598ms     307.071us            28  
                                        aten::transpose         0.03%       4.056ms         0.09%      12.664ms      64.612us       5.187ms         0.04%       8.556ms      43.653us           196  
        autograd::engine::evaluate_function: TBackward0         0.01%       1.125ms         0.06%       8.810ms     209.762us       3.482ms         0.03%       8.240ms     196.190us            42  
                                        aten::clamp_min         0.03%       3.756ms         0.06%       8.754ms      89.327us       4.000ms         0.03%       7.956ms      81.184us            98  
                                    aten::_masked_scale         0.01%       1.632ms         0.05%       6.481ms     231.464us       4.404ms         0.03%       7.821ms     279.321us            28  
                        torch::autograd::AccumulateGrad         0.01%       1.876ms         0.06%       8.789ms     104.631us       3.052ms         0.02%       7.586ms      90.310us            84  
                                            aten::fill_         0.05%       6.945ms         0.06%       8.741ms      79.464us       7.401ms         0.05%       7.401ms      67.282us           110  
                                              aten::div         0.03%       3.664ms         0.05%       6.242ms      55.732us       7.102ms         0.05%       7.102ms      63.411us           112  
                                        aten::new_empty         0.02%       3.180ms         0.06%       7.880ms      70.357us       3.854ms         0.03%       6.656ms      59.429us           112  
                                             aten::add_         0.04%       4.876ms         0.06%       8.414ms      51.938us       6.623ms         0.05%       6.623ms      40.883us           162  
                               aten::cross_entropy_loss         0.00%     671.000us         0.04%       5.489ms     392.071us     746.000us         0.01%       6.126ms     437.571us            14  
     autograd::engine::evaluate_function: ReluBackward0         0.01%     912.000us         0.04%       5.059ms     180.679us     372.000us         0.00%       5.729ms     204.607us            28  
autograd::engine::evaluate_function: NllLossBackward...         0.01%     925.000us         0.05%       6.274ms     448.143us     943.000us         0.01%       5.514ms     393.857us            14  
                                              aten::sum         0.03%       3.450ms         0.05%       6.482ms     154.333us       5.460ms         0.04%       5.460ms     130.000us            42  
                                          ReluBackward0         0.01%     757.000us         0.03%       3.729ms     133.179us     799.000us         0.01%       5.357ms     191.321us            28  
                                             TBackward0         0.01%     722.000us         0.04%       5.260ms     125.238us       1.350ms         0.01%       4.758ms     113.286us            42  
                                       NllLossBackward0         0.00%     548.000us         0.04%       4.781ms     341.500us     579.000us         0.00%       4.571ms     326.500us            14  
                               aten::threshold_backward         0.01%       1.527ms         0.02%       2.574ms      91.929us       4.558ms         0.03%       4.558ms     162.786us            28  
                                              aten::mul         0.02%       3.322ms         0.04%       5.645ms      67.202us       4.487ms         0.03%       4.487ms      53.417us            84  
                                         create sampler         0.03%       4.053ms         0.03%       4.154ms       4.154ms       4.103ms         0.03%       4.149ms       4.149ms             1  
                                aten::nll_loss_backward         0.01%       1.109ms         0.03%       4.018ms     287.000us       2.256ms         0.02%       3.992ms     285.143us            14  
                                      aten::nll_loss_nd         0.00%     326.000us         0.02%       3.217ms     229.786us     333.000us         0.00%       3.933ms     280.929us            14  
                                             aten::relu         0.01%       1.344ms         0.05%       6.345ms     226.607us      86.000us         0.00%       3.640ms     130.000us            28  
                                         aten::nll_loss         0.00%     325.000us         0.02%       2.822ms     201.571us     336.000us         0.00%       3.600ms     257.143us            14  
                                 aten::nll_loss_forward         0.01%     827.000us         0.02%       2.426ms     173.286us       3.142ms         0.02%       3.264ms     233.143us            14  
                                            aten::clamp         0.01%       1.873ms         0.03%       3.457ms      82.310us       2.127ms         0.02%       3.208ms      76.381us            42  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%     477.000us         0.02%       3.090ms     220.714us     671.000us         0.00%       2.873ms     205.214us            14  
                                         aten::new_ones         0.01%       1.269ms         0.05%       6.367ms     151.595us     457.000us         0.00%       2.592ms      61.714us            42  
                                     aten::resolve_conj         0.01%     996.000us         0.02%       3.386ms      30.232us       2.263ms         0.02%       2.263ms      20.205us           112  
                                    LogSoftmaxBackward0         0.00%     466.000us         0.02%       2.377ms     169.786us     692.000us         0.01%       2.202ms     157.286us            14  
                                             aten::mul_         0.01%       1.607ms         0.02%       2.857ms      34.012us       2.143ms         0.02%       2.143ms      25.512us            84  
                                             aten::ones         0.02%       2.161ms         0.04%       4.774ms     113.667us       1.124ms         0.01%       2.135ms      50.833us            42  
                                           aten::expand         0.01%       1.357ms         0.02%       2.067ms      49.214us       1.572ms         0.01%       1.816ms      43.238us            42  
                       aten::_log_softmax_backward_data         0.01%     691.000us         0.01%       1.714ms     122.429us       1.510ms         0.01%       1.510ms     107.857us            14  
                                        aten::ones_like         0.00%     516.000us         0.01%       1.622ms     115.857us     626.000us         0.00%       1.503ms     107.357us            14  
                                      aten::log_softmax         0.00%     559.000us         0.01%       1.529ms     109.214us     706.000us         0.01%       1.447ms     103.357us            14  
                                             aten::sqrt         0.01%       1.037ms         0.01%       1.657ms      39.452us       1.320ms         0.01%       1.320ms      31.429us            42  
                aten::_has_compatible_shallow_copy_type         0.01%       1.234ms         0.02%       2.682ms      23.946us       1.198ms         0.01%       1.198ms      10.696us           112  
                                         aten::addcmul_         0.01%     879.000us         0.01%       1.471ms      35.024us       1.112ms         0.01%       1.112ms      26.476us            42  
                                         aten::addcdiv_         0.01%     851.000us         0.01%       1.446ms      34.429us       1.094ms         0.01%       1.094ms      26.048us            42  
                                      aten::resolve_neg         0.01%     929.000us         0.01%       2.026ms      18.089us     922.000us         0.01%     922.000us       8.232us           112  
                                          aten::resize_         0.00%     558.000us         0.01%       1.177ms      21.018us     719.000us         0.01%     719.000us      12.839us            56  
                                     aten::_log_softmax         0.00%     501.000us         0.01%     753.000us      53.786us     673.000us         0.00%     673.000us      48.071us            14  
                                             aten::view         0.01%     914.000us         0.01%       1.552ms      36.952us     652.000us         0.00%     652.000us      15.524us            42  
                                           aten::detach         0.00%     110.000us         0.00%     360.000us      60.000us     192.000us         0.00%     291.000us      48.500us             6  
                                             aten::set_         0.00%     276.000us         0.00%     485.000us      30.312us     276.000us         0.00%     276.000us      17.250us            16  
                                                 detach         0.00%      95.000us         0.00%     178.000us      29.667us      99.000us         0.00%      99.000us      16.500us             6  
                                          aten::detach_         0.00%      17.000us         0.00%      31.000us      31.000us      21.000us         0.00%      26.000us      26.000us             1  
                                                detach_         0.00%       7.000us         0.00%      10.000us      10.000us       5.000us         0.00%       5.000us       5.000us             1  
                                        cudaEventCreate         0.60%      81.930ms         0.60%      81.930ms       2.562us       0.000us         0.00%       0.000us       0.000us         31978  
                                        cudaEventRecord         1.03%     139.862ms         1.03%     139.862ms       4.354us       0.000us         0.00%       0.000us       0.000us         32121  
                                        cudaMemcpyAsync         4.42%     600.356ms         4.42%     600.356ms     940.997us       0.000us         0.00%       0.000us       0.000us           638  
                                  cudaStreamSynchronize         0.07%      10.022ms         0.07%      10.022ms      22.881us       0.000us         0.00%       0.000us       0.000us           438  
                                  cudaStreamIsCapturing         0.00%     142.000us         0.00%     142.000us       2.119us       0.000us         0.00%       0.000us       0.000us            67  
                                             cudaMalloc         0.70%      95.416ms         0.70%      95.416ms     312.839us       0.000us         0.00%       0.000us       0.000us           305  
                               cudaEventCreateWithFlags         0.00%     176.000us         0.00%     176.000us       1.630us       0.000us         0.00%       0.000us       0.000us           108  
                                       cudaLaunchKernel         0.14%      18.651ms         0.14%      18.651ms      12.064us       0.000us         0.00%       0.000us       0.000us          1546  
                                             cudaMemcpy         0.17%      22.996ms         0.17%      22.996ms      90.535us       0.000us         0.00%       0.000us       0.000us           254  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 13.582s
Self CUDA time total: 13.570s

2023-03-16 15:10:54,414 - INFO - Rank 0 | wait sampler total time: 0.3382761478424072, total sub_iters: 7, avg sub_iter time:0.04832516397748675
