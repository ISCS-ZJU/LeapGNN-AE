2023-03-16 16:18:06,128 - INFO - Rank 0 | Client Args: Namespace(dataset='./dist/repgnn_data/ogbn_arxiv128/', num_gpu=1, sampling='10-10', hidden_size=256, n_classes=60, batch_size=8000, dropout=0.2, lr=0.03, weight_decay=0, model_name='gcn', epoch=1, num_worker=1, cache_size=0, ckpt_path='/dev/shm', seed=None, log=True, dist_url='tcp://10.214.242.140:23457', world_size=2, rank=0, gpu=0, grpc_port='10.214.242.140:18110', distributed=True)
2023-03-16 16:18:06,258 - INFO - Rank 0 | Added key: store_based_barrier_key:1 to store for rank: 0
2023-03-16 16:18:06,258 - INFO - Rank 0 | Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
2023-03-16 16:18:06,258 - INFO - Rank 0 | Using 2 distributed GPUs in total for training...
2023-03-16 16:18:12,103 - INFO - Rank 0 | n_sub_batches:55049
2023-03-16 16:18:14,593 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 16:18:15,118 - INFO - Rank 0 | Reducer buckets have been rebuilt in this iteration.
2023-03-16 16:18:15,179 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 16:18:15,691 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 16:18:16,213 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 16:18:16,727 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 16:18:17,194 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 16:18:17,683 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 16:18:18,183 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 16:18:18,683 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 16:18:19,205 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 16:18:19,742 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 16:18:20,271 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 16:18:20,783 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 16:18:21,283 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-16 16:18:21,304 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 0 on rank 0: 1671763 / 7776987 = 0.21496281271911602
2023-03-16 16:18:21,305 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 1.887 s, total_remote_feats_gather_time = 19.918 s
2023-03-16 16:18:21,305 - INFO - Rank 0 | => cur_epoch 0 finished on rank 0
2023-03-16 16:18:25,175 - INFO - Rank 0 | -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      total epochs time         3.08%     287.678ms        98.80%        9.219s        9.219s     289.966ms         3.11%        9.219s        9.219s             1  
                                             fetch feat         0.63%      58.855ms        64.90%        6.056s     432.591ms      67.055ms         0.72%        6.056s     432.586ms            14  
                           fetch feat from cache server        56.00%        5.225s        57.89%        5.402s      96.468ms        5.244s        56.25%        5.402s      96.457ms            56  
                                            gpu-compute        15.21%        1.420s        27.32%        2.549s     121.394ms        1.420s        15.23%        2.549s     121.384ms            21  
                        DistributedDataParallel.forward         3.85%     358.891ms        11.76%        1.098s      78.403ms     476.157ms         5.11%        1.097s      78.390ms            14  
                                            aten::copy_         1.46%     136.309ms         5.51%     514.403ms     746.594us     506.604ms         5.43%     506.604ms     735.274us           689  
                                             CopyReduce         0.27%      25.311ms         5.16%     481.667ms      11.468ms     463.591ms         4.97%     479.914ms      11.427ms            42  
                                               aten::to         0.13%      11.756ms         4.85%     452.525ms       1.339ms      15.047ms         0.16%     448.861ms       1.328ms           338  
                                         aten::_to_copy         0.24%      22.446ms         4.68%     436.983ms       1.357ms      29.357ms         0.31%     433.814ms       1.347ms           322  
                             move feats from CPU to GPU         0.14%      12.784ms         4.18%     389.994ms       6.964ms      15.379ms         0.16%     389.099ms       6.948ms            56  
                                         model transfer         2.11%     197.052ms         2.87%     267.750ms      19.125ms     201.598ms         2.16%     267.628ms      19.116ms            14  
                                          create frames         0.77%      71.804ms         0.84%      78.595ms       1.403ms      74.842ms         0.80%      77.843ms       1.390ms            56  
                                            aten::index         0.60%      55.988ms         0.72%      67.320ms     686.939us      58.307ms         0.63%      65.676ms     670.163us            98  
                                            get nf_nids         0.28%      25.707ms         0.70%      65.687ms       4.692ms      29.054ms         0.31%      65.484ms       4.677ms            14  
                                            aten::slice         0.38%      35.258ms         0.69%      64.182ms      98.439us      44.087ms         0.47%      54.441ms      83.498us           652  
                                            aten::zeros         0.31%      28.510ms         0.58%      53.828ms     158.785us      37.978ms         0.41%      47.694ms     140.690us           339  
autograd::engine::evaluate_function: CopyReduceBackw...         0.01%     821.000us         0.36%      33.452ms       1.195ms       1.159ms         0.01%      33.188ms       1.185ms            28  
                                     CopyReduceBackward         0.14%      13.530ms         0.35%      32.335ms       1.155ms      27.906ms         0.30%      32.029ms       1.144ms            28  
    autograd::engine::evaluate_function: AddmmBackward0         0.02%       1.627ms         0.30%      27.721ms     660.024us       1.513ms         0.02%      29.613ms     705.071us            42  
                                          aten::reshape         0.21%      19.664ms         0.43%      39.849ms     119.667us      21.306ms         0.23%      28.972ms      87.003us           333  
                                           aten::linear         0.03%       2.755ms         0.21%      19.156ms     456.095us       2.995ms         0.03%      24.314ms     578.905us            42  
                                         AddmmBackward0         0.03%       2.943ms         0.22%      20.403ms     485.786us       3.286ms         0.04%      23.818ms     567.095us            42  
                               Optimizer.step#Adam.step         0.10%       9.185ms         0.23%      21.238ms       3.034ms      11.864ms         0.13%      21.187ms       3.027ms             7  
                                       aten::zeros_like         0.05%       4.804ms         0.23%      21.486ms     223.812us       6.566ms         0.07%      20.565ms     214.219us            96  
                                            fetch label         0.03%       2.754ms         0.22%      20.562ms       1.469ms       3.420ms         0.04%      20.354ms       1.454ms            14  
                                          aten::dropout         0.02%       2.116ms         0.19%      17.379ms     413.786us       1.955ms         0.02%      19.291ms     459.310us            42  
                                            aten::empty         0.17%      15.427ms         0.35%      32.564ms      30.208us      17.811ms         0.19%      17.811ms      16.522us          1078  
                                   aten::_fused_dropout         0.05%       5.089ms         0.16%      14.653ms     348.881us      10.251ms         0.11%      17.336ms     412.762us            42  
                                            aten::addmm         0.08%       7.122ms         0.12%      11.535ms     274.643us      15.128ms         0.16%      17.056ms     406.095us            42  
                                       aten::as_strided         0.13%      12.560ms         0.32%      30.298ms      26.074us      16.346ms         0.18%      16.346ms      14.067us          1162  
                                       aten::empty_like         0.07%       6.932ms         0.19%      18.190ms      81.937us       9.230ms         0.10%      16.191ms      72.932us           222  
                                    aten::empty_strided         0.13%      11.752ms         0.22%      20.995ms      40.688us      15.965ms         0.17%      15.965ms      30.940us           516  
                                               aten::mm         0.06%       5.322ms         0.09%       8.661ms     123.729us      15.560ms         0.17%      15.560ms     222.286us            70  
                                           aten::unbind         0.08%       7.324ms         0.16%      15.308ms       1.093ms       8.335ms         0.09%      15.115ms       1.080ms            14  
                                asign frame to nodeflow         0.14%      12.785ms         0.16%      15.302ms     273.250us      13.715ms         0.15%      14.477ms     258.518us            56  
autograd::engine::evaluate_function: torch::autograd...         0.05%       4.446ms         0.18%      17.048ms     202.952us       4.819ms         0.05%      13.032ms     155.143us            84  
                                     train data prepare         0.14%      12.774ms         0.14%      12.805ms      12.805ms      12.793ms         0.14%      12.798ms      12.798ms             1  
                                            aten::zero_         0.06%       5.419ms         0.19%      17.765ms      39.566us       6.268ms         0.07%      12.515ms      27.873us           449  
                                                aten::t         0.04%       4.092ms         0.17%      15.635ms      79.770us       4.652ms         0.05%      11.308ms      57.694us           196  
                                 sync for each sub_iter         0.10%       9.350ms         0.10%       9.753ms     696.643us       9.527ms         0.10%       9.632ms     688.000us            14  
autograd::engine::evaluate_function: FusedDropoutBac...         0.01%     672.000us         0.08%       7.230ms     258.214us     496.000us         0.01%       8.259ms     294.964us            28  
                                        aten::clamp_min         0.04%       3.678ms         0.10%       9.048ms      92.327us       4.149ms         0.04%       8.041ms      82.051us            98  
                                  FusedDropoutBackward0         0.01%     520.000us         0.07%       6.284ms     224.429us       1.868ms         0.02%       7.763ms     277.250us            28  
                                   aten::_reshape_alias         0.08%       7.294ms         0.13%      11.778ms      35.369us       7.666ms         0.08%       7.666ms      23.021us           333  
                                            aten::fill_         0.08%       7.102ms         0.09%       8.818ms      80.164us       7.502ms         0.08%       7.502ms      68.200us           110  
                                              aten::cat         0.01%     995.000us         0.08%       7.482ms     534.429us       1.193ms         0.01%       7.306ms     521.857us            14  
                                             aten::item         0.05%       4.822ms         0.09%       7.955ms      94.702us       5.942ms         0.06%       6.913ms      82.298us            84  
                                           aten::select         0.05%       4.812ms         0.08%       7.784ms      92.667us       5.875ms         0.06%       6.780ms      80.714us            84  
                                        aten::new_empty         0.03%       2.887ms         0.08%       7.781ms      69.473us       3.592ms         0.04%       6.680ms      59.643us           112  
                                        aten::transpose         0.03%       3.116ms         0.10%       9.764ms      49.816us       3.947ms         0.04%       6.656ms      33.959us           196  
                                              aten::div         0.03%       2.878ms         0.06%       5.161ms      46.080us       6.291ms         0.07%       6.291ms      56.170us           112  
                                             aten::_cat         0.03%       2.873ms         0.07%       6.291ms     449.357us       3.413ms         0.04%       6.113ms     436.643us            14  
                               aten::cross_entropy_loss         0.01%     595.000us         0.06%       5.494ms     392.429us     685.000us         0.01%       6.101ms     435.786us            14  
                                    aten::_masked_scale         0.03%       2.400ms         0.06%       5.493ms     196.179us       3.752ms         0.04%       5.895ms     210.536us            28  
     autograd::engine::evaluate_function: ReluBackward0         0.01%     541.000us         0.05%       4.405ms     157.321us     213.000us         0.00%       5.628ms     201.000us            28  
                                          ReluBackward0         0.01%     522.000us         0.04%       3.614ms     129.071us     369.000us         0.00%       5.415ms     193.393us            28  
                               aten::threshold_backward         0.02%       2.252ms         0.03%       2.857ms     102.036us       5.046ms         0.05%       5.046ms     180.214us            28  
                        torch::autograd::AccumulateGrad         0.01%       1.235ms         0.07%       6.244ms      74.333us       1.797ms         0.02%       4.602ms      54.786us            84  
                                              aten::sum         0.02%       2.261ms         0.05%       4.220ms     100.476us       3.954ms         0.04%       3.954ms      94.143us            42  
                                      aten::nll_loss_nd         0.00%     305.000us         0.03%       3.217ms     229.786us     328.000us         0.00%       3.910ms     279.286us            14  
                                             aten::add_         0.03%       3.030ms         0.06%       5.761ms      35.562us       3.898ms         0.04%       3.898ms      24.062us           162  
        autograd::engine::evaluate_function: TBackward0         0.01%     681.000us         0.05%       4.674ms     111.286us     939.000us         0.01%       3.790ms      90.238us            42  
autograd::engine::evaluate_function: NllLossBackward...         0.01%     547.000us         0.04%       4.054ms     289.571us     485.000us         0.01%       3.754ms     268.143us            14  
                                             aten::relu         0.01%       1.305ms         0.07%       6.423ms     229.393us     107.000us         0.00%       3.655ms     130.536us            28  
                                         aten::nll_loss         0.00%     315.000us         0.03%       2.829ms     202.071us     329.000us         0.00%       3.582ms     255.857us            14  
                                            aten::clamp         0.02%       1.954ms         0.04%       3.739ms      89.024us       2.265ms         0.02%       3.447ms      82.071us            42  
                                         create sampler         0.04%       3.293ms         0.04%       3.389ms       3.389ms       3.336ms         0.04%       3.384ms       3.384ms             1  
                                       NllLossBackward0         0.00%     386.000us         0.03%       3.196ms     228.286us     429.000us         0.00%       3.269ms     233.500us            14  
                                 aten::nll_loss_forward         0.01%     795.000us         0.03%       2.433ms     173.786us       3.113ms         0.03%       3.253ms     232.357us            14  
                                         aten::new_ones         0.01%       1.269ms         0.07%       6.800ms     161.905us     519.000us         0.01%       3.000ms      71.429us            42  
                                             TBackward0         0.00%     451.000us         0.04%       3.560ms      84.762us     778.000us         0.01%       2.851ms      67.881us            42  
                                aten::nll_loss_backward         0.01%     672.000us         0.03%       2.669ms     190.643us       1.783ms         0.02%       2.840ms     202.857us            14  
                                              aten::mul         0.02%       2.212ms         0.04%       3.923ms      46.702us       2.545ms         0.03%       2.545ms      30.298us            84  
                                             aten::ones         0.02%       2.190ms         0.05%       5.109ms     121.643us       1.275ms         0.01%       2.481ms      59.071us            42  
                                           aten::narrow         0.01%     835.000us         0.03%       2.481ms     177.214us       1.022ms         0.01%       2.306ms     164.714us            14  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%     290.000us         0.02%       2.205ms     157.500us     410.000us         0.00%       2.060ms     147.143us            14  
                                           aten::expand         0.01%       1.359ms         0.02%       2.219ms      52.833us       1.666ms         0.02%       1.928ms      45.905us            42  
                                             aten::mul_         0.01%       1.317ms         0.03%       2.529ms      30.107us       1.857ms         0.02%       1.857ms      22.107us            84  
                                    LogSoftmaxBackward0         0.00%     317.000us         0.02%       1.771ms     126.500us     461.000us         0.00%       1.650ms     117.857us            14  
                                        aten::ones_like         0.01%     476.000us         0.02%       1.617ms     115.500us     651.000us         0.01%       1.520ms     108.571us            14  
                                      aten::log_softmax         0.01%     556.000us         0.02%       1.598ms     114.143us     750.000us         0.01%       1.506ms     107.571us            14  
                       aten::_log_softmax_backward_data         0.01%     478.000us         0.01%       1.316ms      94.000us       1.189ms         0.01%       1.189ms      84.929us            14  
                                             aten::sqrt         0.01%     802.000us         0.01%       1.389ms      33.071us       1.085ms         0.01%       1.085ms      25.833us            42  
                              aten::_local_scalar_dense         0.01%     898.000us         0.02%       2.023ms      24.083us     971.000us         0.01%     971.000us      11.560us            84  
                                         aten::addcdiv_         0.01%     682.000us         0.01%       1.258ms      29.952us     937.000us         0.01%     937.000us      22.310us            42  
                                         aten::addcmul_         0.01%     663.000us         0.01%       1.234ms      29.381us     932.000us         0.01%     932.000us      22.190us            42  
                                     aten::resolve_conj         0.01%     843.000us         0.02%       1.952ms      23.238us     902.000us         0.01%     902.000us      10.738us            84  
                                          aten::resize_         0.01%     737.000us         0.02%       1.630ms      23.286us     899.000us         0.01%     899.000us      12.843us            70  
                                      aten::resolve_neg         0.01%     780.000us         0.02%       1.912ms      22.762us     881.000us         0.01%     881.000us      10.488us            84  
                aten::_has_compatible_shallow_copy_type         0.01%     664.000us         0.02%       1.500ms      26.786us     703.000us         0.01%     703.000us      12.554us            56  
                                     aten::_log_softmax         0.01%     488.000us         0.01%     774.000us      55.286us     680.000us         0.01%     680.000us      48.571us            14  
                                           aten::detach         0.00%     438.000us         0.01%     705.000us     117.500us     511.000us         0.01%     612.000us     102.000us             6  
                                             aten::view         0.01%     599.000us         0.01%       1.040ms      24.762us     328.000us         0.00%     328.000us       7.810us            42  
                                             aten::set_         0.00%     214.000us         0.00%     373.000us      23.312us     161.000us         0.00%     161.000us      10.062us            16  
                                                 detach         0.00%      98.000us         0.00%     183.000us      30.500us     101.000us         0.00%     101.000us      16.833us             6  
                                          aten::detach_         0.00%      17.000us         0.00%      34.000us      34.000us      23.000us         0.00%      29.000us      29.000us             1  
                                                detach_         0.00%       7.000us         0.00%      12.000us      12.000us       6.000us         0.00%       6.000us       6.000us             1  
                                        cudaEventCreate         0.54%      50.220ms         0.54%      50.234ms       2.420us       0.000us         0.00%       0.000us       0.000us         20756  
                                        cudaEventRecord         0.96%      89.431ms         0.96%      89.431ms       4.279us       0.000us         0.00%       0.000us       0.000us         20899  
                                  cudaStreamIsCapturing         0.00%     154.000us         0.00%     154.000us       2.444us       0.000us         0.00%       0.000us       0.000us            63  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 9.331s
Self CUDA time total: 9.322s

2023-03-16 16:18:25,175 - INFO - Rank 0 | wait sampler total time: 0.2724184989929199, total sub_iters: 14, avg sub_iter time:0.019458464213779995
