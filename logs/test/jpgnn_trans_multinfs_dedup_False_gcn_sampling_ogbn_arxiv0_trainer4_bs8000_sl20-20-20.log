2023-04-05 08:13:12,782 - INFO - Rank 0 | Client Args: Namespace(dataset='./dist/repgnn_data/ogbn_arxiv0/', num_gpu=1, sampling='20-20-20', hidden_size=256, n_classes=6, batch_size=8000, dropout=0.5, lr=0.03, weight_decay=0, model_name='gcn', epoch=5, num_worker=1, cache_size=0, ckpt_path='/dev/shm', seed=None, log=True, dist_url='tcp://10.214.241.227:23457', world_size=4, rank=0, gpu=0, grpc_port='10.214.241.227:18112', deduplicate=False, distributed=True)
2023-04-05 08:13:26,583 - INFO - Rank 0 | Added key: store_based_barrier_key:1 to store for rank: 0
2023-04-05 08:13:26,604 - INFO - Rank 0 | Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
2023-04-05 08:13:26,605 - INFO - Rank 0 | Using 4 distributed GPUs in total for training...
2023-04-05 08:13:31,718 - INFO - Rank 0 | -> 调用不去冗余的 fetch_multiple_nfs_v2 函数
2023-04-05 08:13:33,016 - INFO - Rank 0 | n_sub_batches:27559
2023-04-05 08:13:37,634 - INFO - Rank 0 | Reducer buckets have been rebuilt in this iteration.
2023-04-05 08:13:47,328 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 0 on rank 0: 955378 / 1776616 = 0.5377515456350725
2023-04-05 08:13:47,328 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 0.178 s, total_remote_feats_gather_time = 7.519 s
2023-04-05 08:13:47,329 - INFO - Rank 0 | => cur_epoch 0 finished on rank 0
2023-04-05 08:13:47,347 - INFO - Rank 0 | n_sub_batches:27559
2023-04-05 08:14:01,132 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 1 on rank 0: 1921556 / 3567063 = 0.5386941581912066
2023-04-05 08:14:01,133 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 0.323 s, total_remote_feats_gather_time = 15.363 s
2023-04-05 08:14:01,133 - INFO - Rank 0 | => cur_epoch 1 finished on rank 0
2023-04-05 08:14:01,152 - INFO - Rank 0 | n_sub_batches:27559
2023-04-05 08:14:15,187 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 2 on rank 0: 2883468 / 5352709 = 0.5386932112319202
2023-04-05 08:14:15,188 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 0.46 s, total_remote_feats_gather_time = 23.132 s
2023-04-05 08:14:15,188 - INFO - Rank 0 | => cur_epoch 2 finished on rank 0
2023-04-05 08:14:15,207 - INFO - Rank 0 | n_sub_batches:27559
2023-04-05 08:14:29,080 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 3 on rank 0: 3844121 / 7135398 = 0.5387395349215278
2023-04-05 08:14:29,081 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 0.596 s, total_remote_feats_gather_time = 30.753 s
2023-04-05 08:14:29,081 - INFO - Rank 0 | => cur_epoch 3 finished on rank 0
2023-04-05 08:14:29,100 - INFO - Rank 0 | n_sub_batches:27559
2023-04-05 08:14:42,654 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 4 on rank 0: 4811282 / 8927123 = 0.5389510147894232
2023-04-05 08:14:42,655 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 0.74 s, total_remote_feats_gather_time = 38.087 s
2023-04-05 08:14:42,655 - INFO - Rank 0 | => cur_epoch 4 finished on rank 0
2023-04-05 08:15:05,774 - INFO - Rank 0 | -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      total epochs time         4.35%        3.061s        98.95%       69.656s       69.656s        3.067s         4.36%       69.656s       69.656s             1  
                                             fetch feat         0.59%     412.783ms        70.70%       49.772s        2.489s     429.596ms         0.61%       49.771s        2.489s            20  
                           fetch feat from cache server        65.56%       46.153s        65.63%       46.202s     462.022ms       46.168s        65.63%       46.202s     462.015ms           100  
                                            gpu-compute        15.70%       11.049s        20.97%       14.764s     147.640ms       11.049s        15.71%       14.763s     147.632ms           100  
                        DistributedDataParallel.forward         2.80%        1.971s         5.13%        3.610s      45.122ms        2.056s         2.92%        3.609s      45.116ms            80  
                                         model transfer         2.12%        1.492s         2.63%        1.854s      23.181ms        1.514s         2.15%        1.854s      23.174ms            80  
                                            aten::copy_         0.58%     407.424ms         1.55%        1.089s     234.411us        1.064s         1.51%        1.064s     229.012us          4646  
                                               aten::to         0.10%      69.716ms         1.53%        1.076s     319.418us      79.665ms         0.11%        1.055s     313.131us          3370  
                                         aten::_to_copy         0.18%     125.772ms         1.41%     991.618ms     344.312us     154.640ms         0.22%     975.585ms     338.745us          2880  
                                             CopyReduce         0.19%     131.259ms         1.26%     883.508ms       2.761ms     791.643ms         1.13%     887.991ms       2.775ms           320  
                               concat all fetched feats         0.21%     147.585ms         1.24%     875.366ms       8.754ms     148.488ms         0.21%     874.884ms       8.749ms           100  
                                      deduplicate tnids         1.12%     790.611ms         1.13%     795.255ms       7.953ms     794.281ms         1.13%     794.720ms       7.947ms           100  
                                              aten::cat         0.00%       3.094ms         1.03%     726.468ms       7.265ms       3.349ms         0.00%     725.992ms       7.260ms           100  
                                             aten::_cat         0.94%     664.813ms         1.03%     723.073ms       7.231ms     671.709ms         0.95%     722.643ms       7.226ms           100  
                                            fill frames         0.06%      44.610ms         0.92%     650.983ms       6.510ms      55.798ms         0.08%     650.491ms       6.505ms           100  
                             move feats from CPU to GPU         0.04%      26.521ms         0.90%     635.005ms       6.350ms      32.122ms         0.05%     634.542ms       6.345ms           100  
                                            aten::index         0.77%     543.088ms         0.87%     614.054ms     548.263us     555.772ms         0.79%     603.980ms     539.268us          1120  
autograd::engine::evaluate_function: CopyReduceBackw...         0.01%       6.809ms         0.32%     223.435ms     930.979us      10.133ms         0.01%     221.204ms     921.683us           240  
                                     CopyReduceBackward         0.15%     104.360ms         0.30%     214.443ms     893.513us     178.783ms         0.25%     211.071ms     879.462us           240  
    autograd::engine::evaluate_function: AddmmBackward0         0.02%      12.102ms         0.26%     185.763ms     580.509us      14.829ms         0.02%     204.164ms     638.013us           320  
                                         AddmmBackward0         0.02%      11.097ms         0.19%     133.380ms     416.812us      18.325ms         0.03%     154.735ms     483.547us           320  
                                            aten::slice         0.12%      86.641ms         0.20%     139.216ms      37.707us      98.100ms         0.14%     115.719ms      31.343us          3692  
autograd::engine::evaluate_function: torch::autograd...         0.04%      28.551ms         0.19%     134.669ms     210.420us      34.206ms         0.05%     114.050ms     178.203us           640  
                                       aten::zeros_like         0.04%      26.112ms         0.16%     112.157ms     170.971us      33.571ms         0.05%     107.687ms     164.157us           656  
                                           aten::linear         0.02%      16.974ms         0.13%      91.454ms     285.794us      18.440ms         0.03%     107.151ms     334.847us           320  
                                               aten::mm         0.06%      38.735ms         0.08%      59.596ms     106.421us      92.952ms         0.13%      92.952ms     165.986us           560  
                                                aten::t         0.04%      29.909ms         0.15%     106.637ms      70.156us      39.514ms         0.06%      84.427ms      55.544us          1520  
                                     train data prepare         0.12%      81.800ms         0.12%      81.925ms      16.385ms      81.851ms         0.12%      81.890ms      16.378ms             5  
                                          aten::reshape         0.08%      56.463ms         0.14%      99.790ms      38.799us      60.809ms         0.09%      77.663ms      30.196us          2572  
                                          aten::dropout         0.01%       9.257ms         0.10%      67.310ms     210.344us       8.859ms         0.01%      74.637ms     233.241us           320  
                                            aten::zero_         0.03%      21.385ms         0.11%      79.152ms      37.566us      21.086ms         0.03%      67.051ms      31.823us          2107  
                                            aten::zeros         0.06%      44.089ms         0.11%      75.036ms      61.962us      53.280ms         0.08%      66.540ms      54.946us          1211  
                                   aten::_fused_dropout         0.03%      20.192ms         0.08%      56.371ms     176.159us      38.667ms         0.05%      65.778ms     205.556us           320  
                                       aten::empty_like         0.05%      36.287ms         0.11%      76.292ms      47.210us      43.466ms         0.06%      64.325ms      39.805us          1616  
                                            aten::addmm         0.04%      28.130ms         0.07%      46.919ms     146.622us      52.900ms         0.08%      63.759ms     199.247us           320  
                                    aten::empty_strided         0.08%      57.243ms         0.12%      81.319ms      19.107us      56.870ms         0.08%      56.870ms      13.362us          4256  
                               Optimizer.step#Adam.step         0.04%      26.475ms         0.08%      56.455ms       2.823ms      32.417ms         0.05%      56.354ms       2.818ms            20  
                        torch::autograd::AccumulateGrad         0.04%      30.948ms         0.09%      64.654ms     101.022us      35.056ms         0.05%      54.755ms      85.555us           640  
                                            aten::fill_         0.07%      50.882ms         0.08%      58.722ms      65.538us      52.245ms         0.07%      52.245ms      58.309us           896  
                                 sync for each sub_iter         0.07%      50.664ms         0.07%      52.579ms     657.237us      51.546ms         0.07%      52.040ms     650.500us            80  
                                        aten::clamp_min         0.03%      23.569ms         0.07%      48.244ms      60.305us      29.068ms         0.04%      49.830ms      62.288us           800  
                                           aten::narrow         0.03%      18.528ms         0.08%      55.131ms      48.702us      21.772ms         0.03%      48.946ms      43.239us          1132  
                                            aten::empty         0.08%      56.706ms         0.12%      86.128ms      14.814us      46.370ms         0.07%      46.370ms       7.976us          5814  
                                       aten::as_strided         0.08%      54.181ms         0.13%      89.916ms      12.317us      45.328ms         0.06%      45.328ms       6.209us          7300  
                                        aten::transpose         0.03%      23.923ms         0.09%      65.051ms      42.797us      31.886ms         0.05%      44.913ms      29.548us          1520  
                                              aten::div         0.02%      17.531ms         0.04%      29.096ms      40.411us      43.954ms         0.06%      43.954ms      61.047us           720  
                                            get nf_nids         0.01%       9.057ms         0.06%      44.100ms       2.205ms      10.145ms         0.01%      43.872ms       2.194ms            20  
autograd::engine::evaluate_function: FusedDropoutBac...         0.01%       5.943ms         0.06%      42.062ms     175.258us       6.281ms         0.01%      42.211ms     175.879us           240  
                                        aten::new_empty         0.03%      19.756ms         0.06%      45.534ms      51.743us      25.998ms         0.04%      37.359ms      42.453us           880  
                                  FusedDropoutBackward0         0.01%       3.836ms         0.05%      33.920ms     141.333us       5.090ms         0.01%      35.930ms     149.708us           240  
                                              aten::sum         0.02%      16.424ms         0.04%      28.899ms      90.309us      32.075ms         0.05%      32.075ms     100.234us           320  
                                            fetch label         0.01%       6.119ms         0.05%      32.526ms     406.575us       7.557ms         0.01%      32.049ms     400.613us            80  
                                    aten::_masked_scale         0.01%       8.746ms         0.04%      27.708ms     115.450us      19.381ms         0.03%      30.840ms     128.500us           240  
                                             aten::relu         0.01%       8.062ms         0.05%      36.029ms     150.121us       3.578ms         0.01%      30.180ms     125.750us           240  
        autograd::engine::evaluate_function: TBackward0         0.01%       5.760ms         0.05%      35.494ms     110.919us       7.551ms         0.01%      29.648ms      92.650us           320  
     autograd::engine::evaluate_function: ReluBackward0         0.01%       5.126ms         0.04%      27.155ms     113.146us       4.794ms         0.01%      28.706ms     119.608us           240  
                               aten::cross_entropy_loss         0.00%       3.470ms         0.03%      21.626ms     270.325us       3.896ms         0.01%      25.861ms     323.262us            80  
                                             aten::add_         0.03%      19.413ms         0.05%      34.100ms      35.819us      24.391ms         0.03%      24.391ms      25.621us           952  
                                          ReluBackward0         0.01%       4.217ms         0.03%      19.912ms      82.967us       4.897ms         0.01%      23.912ms      99.633us           240  
                                             TBackward0         0.01%       3.850ms         0.04%      27.002ms      84.381us       6.080ms         0.01%      22.097ms      69.053us           320  
                                         aten::new_ones         0.01%       7.637ms         0.05%      37.069ms     115.841us       4.275ms         0.01%      20.851ms      65.159us           320  
autograd::engine::evaluate_function: NllLossBackward...         0.01%       4.225ms         0.03%      20.837ms     260.462us       3.986ms         0.01%      19.235ms     240.438us            80  
                               aten::threshold_backward         0.01%       7.988ms         0.02%      13.557ms      56.487us      19.015ms         0.03%      19.015ms      79.229us           240  
                                              aten::mul         0.02%      15.597ms         0.04%      27.542ms      43.034us      18.304ms         0.03%      18.304ms      28.600us           640  
                                            aten::clamp         0.02%      11.021ms         0.03%      19.594ms      61.231us      12.349ms         0.02%      18.178ms      56.806us           320  
                                          create frames         0.02%      12.534ms         0.03%      17.988ms     179.880us      14.045ms         0.02%      17.033ms     170.330us           100  
                                   aten::_reshape_alias         0.03%      21.347ms         0.04%      28.272ms      10.992us      16.854ms         0.02%      16.854ms       6.553us          2572  
                                             aten::ones         0.02%      14.668ms         0.04%      28.065ms      87.703us       9.905ms         0.01%      16.576ms      51.800us           320  
                                asign frame to nodeflow         0.02%      15.751ms         0.02%      16.947ms     169.470us      16.040ms         0.02%      16.463ms     164.630us           100  
                                      aten::nll_loss_nd         0.00%       1.507ms         0.02%      11.558ms     144.475us       1.792ms         0.00%      15.960ms     199.500us            80  
                                       NllLossBackward0         0.00%       1.604ms         0.02%      15.152ms     189.400us       1.925ms         0.00%      15.249ms     190.613us            80  
                                         aten::nll_loss         0.00%       1.680ms         0.01%       9.881ms     123.513us       1.572ms         0.00%      14.168ms     177.100us            80  
                                aten::nll_loss_backward         0.01%       3.988ms         0.02%      12.709ms     158.863us       7.109ms         0.01%      13.324ms     166.550us            80  
                                 aten::nll_loss_forward         0.01%       3.771ms         0.01%       8.032ms     100.400us      12.088ms         0.02%      12.596ms     157.450us            80  
                                           aten::expand         0.01%       8.935ms         0.02%      12.283ms      38.384us       9.639ms         0.01%      10.859ms      33.934us           320  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%       1.906ms         0.02%      11.100ms     138.750us       3.903ms         0.01%      10.183ms     127.287us            80  
                     Optimizer.zero_grad#Adam.zero_grad         0.00%       3.036ms         0.01%       9.579ms     478.950us       3.874ms         0.01%       9.479ms     473.950us            20  
                                         create sampler         0.01%       6.611ms         0.01%       6.946ms       1.389ms       6.736ms         0.01%       6.922ms       1.384ms             5  
                                    LogSoftmaxBackward0         0.00%       1.715ms         0.01%       8.370ms     104.625us       2.449ms         0.00%       6.280ms      78.500us            80  
                                      aten::log_softmax         0.00%       2.611ms         0.01%       6.348ms      79.350us       3.096ms         0.00%       6.005ms      75.062us            80  
                                        aten::ones_like         0.00%       2.378ms         0.01%       7.121ms      89.013us       2.179ms         0.00%       5.237ms      65.463us            80  
                                             aten::mul_         0.01%       4.235ms         0.01%       6.437ms      20.116us       4.923ms         0.01%       4.923ms      15.384us           320  
                                          aten::resize_         0.01%       5.206ms         0.01%       6.613ms      13.226us       4.332ms         0.01%       4.332ms       8.664us           500  
                       aten::_log_softmax_backward_data         0.00%       2.762ms         0.01%       4.651ms      58.138us       3.831ms         0.01%       3.831ms      47.888us            80  
                                      aten::resolve_neg         0.00%       2.306ms         0.01%       5.077ms      12.693us       3.120ms         0.00%       3.120ms       7.800us           400  
                                             aten::sqrt         0.00%       2.586ms         0.01%       3.717ms      23.231us       3.024ms         0.00%       3.024ms      18.900us           160  
                                         aten::addcdiv_         0.00%       2.210ms         0.00%       3.313ms      20.706us       2.768ms         0.00%       2.768ms      17.300us           160  
                                     aten::_log_softmax         0.00%       2.049ms         0.00%       2.934ms      36.675us       2.645ms         0.00%       2.645ms      33.062us            80  
                                         aten::addcmul_         0.00%       2.167ms         0.00%       3.295ms      20.594us       2.571ms         0.00%       2.571ms      16.069us           160  
                                             aten::view         0.01%       4.473ms         0.01%       7.335ms      22.922us       2.525ms         0.00%       2.525ms       7.891us           320  
                                     aten::resolve_conj         0.00%       2.392ms         0.01%       3.792ms       9.480us       1.737ms         0.00%       1.737ms       4.343us           400  
                aten::_has_compatible_shallow_copy_type         0.00%       2.248ms         0.01%       4.077ms      10.193us       1.624ms         0.00%       1.624ms       4.060us           400  
                                             aten::set_         0.00%     999.000us         0.00%       1.676ms      20.439us     813.000us         0.00%     813.000us       9.915us            82  
                                           aten::detach         0.00%      83.000us         0.00%     276.000us      34.500us     128.000us         0.00%     213.000us      26.625us             8  
                                          aten::detach_         0.00%      82.000us         0.00%     133.000us      26.600us      94.000us         0.00%     114.000us      22.800us             5  
                                                 detach         0.00%      93.000us         0.00%     144.000us      18.000us      85.000us         0.00%      85.000us      10.625us             8  
                                                detach_         0.00%      30.000us         0.00%      40.000us       8.000us      20.000us         0.00%      20.000us       4.000us             5  
                                        cudaEventCreate         0.21%     148.894ms         0.21%     148.894ms       1.092us       0.000us         0.00%       0.000us       0.000us        136346  
                                        cudaEventRecord         0.33%     231.017ms         0.33%     231.027ms       1.687us       0.000us         0.00%       0.000us       0.000us        136985  
                                  cudaStreamIsCapturing         0.00%     394.000us         0.00%     394.000us       1.077us       0.000us         0.00%       0.000us       0.000us           366  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 70.395s
Self CUDA time total: 70.349s

2023-04-05 08:15:05,774 - INFO - Rank 0 | wait sampler total time: 0.5988059043884277, total sub_iters: 4, avg sub_iter time:0.14970147609710693
