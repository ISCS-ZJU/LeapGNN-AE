2023-04-05 06:05:43,189 - INFO - Rank 0 | Client Args: Namespace(dataset='./dist/repgnn_data/ogbn_arxiv0/', num_gpu=1, sampling='10-10', hidden_size=256, n_classes=6, batch_size=8000, dropout=0.5, lr=0.03, weight_decay=0, model_name='gcn', epoch=10, num_worker=1, cache_size=0, ckpt_path='/dev/shm', seed=None, log=True, dist_url='tcp://10.214.241.227:23457', world_size=4, rank=0, gpu=0, grpc_port='10.214.241.227:18112', distributed=True)
2023-04-05 06:05:55,564 - INFO - Rank 0 | Added key: store_based_barrier_key:1 to store for rank: 0
2023-04-05 06:05:55,585 - INFO - Rank 0 | Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
2023-04-05 06:05:55,585 - INFO - Rank 0 | Using 4 distributed GPUs in total for training...
2023-04-05 06:06:01,591 - INFO - Rank 0 | n_sub_batches:27559
2023-04-05 06:06:03,676 - INFO - Rank 0 | Reducer buckets have been rebuilt in this iteration.
2023-04-05 06:06:07,832 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 0 on rank 0: 285508 / 729468 = 0.39139208299747213
2023-04-05 06:06:07,833 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 0.078 s, total_remote_feats_gather_time = 2.231 s
2023-04-05 06:06:07,833 - INFO - Rank 0 | => cur_epoch 0 finished on rank 0
2023-04-05 06:06:07,855 - INFO - Rank 0 | n_sub_batches:27559
2023-04-05 06:06:12,635 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 1 on rank 0: 572843 / 1463645 = 0.3913811067574446
2023-04-05 06:06:12,636 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 0.15 s, total_remote_feats_gather_time = 4.421 s
2023-04-05 06:06:12,637 - INFO - Rank 0 | => cur_epoch 1 finished on rank 0
2023-04-05 06:06:12,659 - INFO - Rank 0 | n_sub_batches:27559
2023-04-05 06:06:17,481 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 2 on rank 0: 859228 / 2196630 = 0.39115736377997207
2023-04-05 06:06:17,484 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 0.218 s, total_remote_feats_gather_time = 6.667 s
2023-04-05 06:06:17,484 - INFO - Rank 0 | => cur_epoch 2 finished on rank 0
2023-04-05 06:06:17,505 - INFO - Rank 0 | n_sub_batches:27559
2023-04-05 06:06:22,323 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 3 on rank 0: 1145082 / 2927468 = 0.39115098781609225
2023-04-05 06:06:22,324 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 0.295 s, total_remote_feats_gather_time = 8.939 s
2023-04-05 06:06:22,325 - INFO - Rank 0 | => cur_epoch 3 finished on rank 0
2023-04-05 06:06:22,343 - INFO - Rank 0 | n_sub_batches:27559
2023-04-05 06:06:27,208 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 4 on rank 0: 1431182 / 3659761 = 0.39105886969121756
2023-04-05 06:06:27,209 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 0.367 s, total_remote_feats_gather_time = 11.175 s
2023-04-05 06:06:27,210 - INFO - Rank 0 | => cur_epoch 4 finished on rank 0
2023-04-05 06:06:27,231 - INFO - Rank 0 | n_sub_batches:27559
2023-04-05 06:06:32,239 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 5 on rank 0: 1718546 / 4393542 = 0.3911527419107408
2023-04-05 06:06:32,240 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 0.437 s, total_remote_feats_gather_time = 13.399000000000001 s
2023-04-05 06:06:32,240 - INFO - Rank 0 | => cur_epoch 5 finished on rank 0
2023-04-05 06:06:32,258 - INFO - Rank 0 | n_sub_batches:27559
2023-04-05 06:06:37,190 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 6 on rank 0: 2006384 / 5127311 = 0.39131310739684017
2023-04-05 06:06:37,191 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 0.506 s, total_remote_feats_gather_time = 15.606 s
2023-04-05 06:06:37,191 - INFO - Rank 0 | => cur_epoch 6 finished on rank 0
2023-04-05 06:06:37,213 - INFO - Rank 0 | n_sub_batches:27559
2023-04-05 06:06:42,143 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 7 on rank 0: 2292664 / 5859724 = 0.39125801829574225
2023-04-05 06:06:42,145 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 0.583 s, total_remote_feats_gather_time = 17.830000000000002 s
2023-04-05 06:06:42,145 - INFO - Rank 0 | => cur_epoch 7 finished on rank 0
2023-04-05 06:06:42,166 - INFO - Rank 0 | n_sub_batches:27559
2023-04-05 06:06:47,159 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 8 on rank 0: 2580667 / 6594406 = 0.39134184337452077
2023-04-05 06:06:47,161 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 0.653 s, total_remote_feats_gather_time = 20.104 s
2023-04-05 06:06:47,161 - INFO - Rank 0 | => cur_epoch 8 finished on rank 0
2023-04-05 06:06:47,180 - INFO - Rank 0 | n_sub_batches:27559
2023-04-05 06:06:52,041 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 9 on rank 0: 2866602 / 7326073 = 0.39128766530172443
2023-04-05 06:06:52,042 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 0.725 s, total_remote_feats_gather_time = 22.388 s
2023-04-05 06:06:52,042 - INFO - Rank 0 | => cur_epoch 9 finished on rank 0
2023-04-05 06:07:30,079 - INFO - Rank 0 | -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      total epochs time         1.45%     747.424ms        97.80%       50.468s       50.468s     763.051ms         1.48%       50.468s       50.468s             1  
                                             fetch feat         0.35%     179.224ms        64.97%       33.526s     209.536ms     210.652ms         0.41%       33.524s     209.527ms           160  
                           fetch feat from cache server        60.66%       31.300s        61.64%       31.807s      49.699ms       31.337s        60.84%       31.804s      49.694ms           640  
                                            gpu-compute        17.58%        9.069s        24.93%       12.863s      64.314ms        9.070s        17.61%       12.861s      64.307ms           200  
                        DistributedDataParallel.forward         2.80%        1.443s         6.78%        3.499s      21.871ms        1.590s         3.09%        3.499s      21.866ms           160  
                                         model transfer         4.36%        2.249s         5.54%        2.861s      17.882ms        2.287s         4.44%        2.860s      17.873ms           160  
                                            aten::copy_         1.04%     539.067ms         2.47%        1.274s     183.285us        1.233s         2.39%        1.233s     177.306us          6953  
                                               aten::to         0.18%      92.322ms         2.32%        1.196s     309.875us     108.398ms         0.21%        1.169s     302.753us          3860  
                                         aten::_to_copy         0.33%     171.406ms         2.10%        1.082s     294.025us     214.066ms         0.42%        1.060s     288.106us          3680  
                                             CopyReduce         0.37%     191.327ms         2.02%        1.040s       2.167ms     887.121ms         1.72%        1.036s       2.159ms           480  
                             move feats from CPU to GPU         0.08%      40.971ms         1.38%     711.369ms       1.112ms      51.254ms         0.10%     708.136ms       1.106ms           640  
                                            aten::index         0.64%     331.571ms         0.78%     400.071ms     357.206us     344.294ms         0.67%     390.708ms     348.846us          1120  
                                            get nf_nids         0.26%     136.326ms         0.68%     353.011ms       2.206ms     155.159ms         0.30%     351.917ms       2.199ms           160  
    autograd::engine::evaluate_function: AddmmBackward0         0.04%      20.436ms         0.59%     304.793ms     634.985us      29.837ms         0.06%     308.293ms     642.277us           480  
autograd::engine::evaluate_function: CopyReduceBackw...         0.02%      10.124ms         0.53%     274.425ms     857.578us      13.641ms         0.03%     271.041ms     847.003us           320  
                                     CopyReduceBackward         0.31%     158.015ms         0.51%     260.927ms     815.397us     219.633ms         0.43%     257.400ms     804.375us           320  
                                          create frames         0.40%     205.868ms         0.46%     238.345ms     372.414us     222.371ms         0.43%     235.147ms     367.417us           640  
                                            aten::zeros         0.28%     143.433ms         0.49%     252.249ms      66.016us     184.633ms         0.36%     228.200ms      59.723us          3821  
                                         AddmmBackward0         0.04%      18.740ms         0.43%     220.619ms     459.623us      36.119ms         0.07%     227.589ms     474.144us           480  
autograd::engine::evaluate_function: torch::autograd...         0.14%      73.138ms         0.43%     222.871ms     232.157us      98.755ms         0.19%     206.833ms     215.451us           960  
                                            aten::slice         0.27%     139.141ms         0.44%     229.217ms      41.315us     161.423ms         0.31%     192.395ms      34.678us          5548  
                               Optimizer.step#Adam.step         0.18%      93.763ms         0.36%     184.678ms       4.617ms     113.844ms         0.22%     184.276ms       4.607ms            40  
                                     train data prepare         0.35%     182.164ms         0.35%     182.519ms      18.252ms     182.291ms         0.35%     182.409ms      18.241ms            10  
                                       aten::zeros_like         0.09%      47.827ms         0.35%     178.218ms     183.352us      61.689ms         0.12%     170.157ms     175.059us           972  
                                           aten::linear         0.05%      25.248ms         0.27%     141.785ms     295.385us      27.930ms         0.05%     151.709ms     316.060us           480  
                                                aten::t         0.10%      49.081ms         0.33%     171.764ms      76.680us      67.981ms         0.13%     147.903ms      66.028us          2240  
                                 sync for each sub_iter         0.26%     133.533ms         0.27%     139.294ms     870.587us     135.683ms         0.26%     137.517ms     859.481us           160  
                                            aten::zero_         0.10%      52.227ms         0.29%     148.388ms      28.575us      54.048ms         0.10%     114.419ms      22.033us          5193  
                                               aten::mm         0.13%      64.584ms         0.19%      99.018ms     123.772us     110.050ms         0.21%     110.050ms     137.562us           800  
                                       aten::empty_like         0.11%      58.364ms         0.23%     118.491ms      49.126us      71.448ms         0.14%     102.248ms      42.391us          2412  
                                          aten::reshape         0.14%      70.538ms         0.24%     124.139ms      42.124us      76.903ms         0.15%      97.388ms      33.046us          2947  
                                          aten::dropout         0.02%      12.453ms         0.19%      96.543ms     201.131us      12.052ms         0.02%      96.403ms     200.840us           480  
                                            aten::empty         0.21%     106.293ms         0.31%     162.090ms      13.353us      90.693ms         0.18%      90.693ms       7.471us         12139  
                                            aten::addmm         0.09%      45.460ms         0.15%      75.658ms     157.621us      70.739ms         0.14%      87.256ms     181.783us           480  
                                   aten::_fused_dropout         0.06%      28.870ms         0.15%      78.383ms     163.298us      48.497ms         0.09%      84.351ms     175.731us           480  
                                        aten::transpose         0.07%      37.963ms         0.20%     102.225ms      45.636us      57.341ms         0.11%      79.922ms      35.679us          2240  
                                    aten::empty_strided         0.16%      84.534ms         0.22%     114.554ms      19.847us      79.299ms         0.15%      79.299ms      13.739us          5772  
                                       aten::as_strided         0.17%      87.270ms         0.29%     151.014ms      13.348us      76.833ms         0.15%      76.833ms       6.791us         11314  
                                            aten::fill_         0.13%      64.904ms         0.16%      83.334ms      60.739us      73.711ms         0.14%      73.711ms      53.725us          1372  
                                           aten::unbind         0.05%      26.067ms         0.14%      73.107ms     456.919us      31.654ms         0.06%      72.081ms     450.506us           160  
                                        aten::clamp_min         0.06%      32.263ms         0.13%      66.076ms      58.996us      43.668ms         0.08%      69.482ms      62.038us          1120  
autograd::engine::evaluate_function: FusedDropoutBac...         0.02%       9.165ms         0.12%      63.786ms     199.331us      11.914ms         0.02%      60.475ms     188.984us           320  
                        torch::autograd::AccumulateGrad         0.03%      15.714ms         0.14%      74.451ms      77.553us      24.780ms         0.05%      60.139ms      62.645us           960  
        autograd::engine::evaluate_function: TBackward0         0.02%      12.769ms         0.12%      64.324ms     134.008us      16.106ms         0.03%      57.513ms     119.819us           480  
                                asign frame to nodeflow         0.09%      46.583ms         0.11%      55.211ms      86.267us      49.640ms         0.10%      52.295ms      81.711us           640  
                                        aten::new_empty         0.06%      29.829ms         0.12%      60.965ms      47.629us      35.808ms         0.07%      52.057ms      40.670us          1280  
                                              aten::div         0.06%      30.313ms         0.09%      47.864ms      46.023us      51.870ms         0.10%      51.870ms      49.875us          1040  
                                             aten::add_         0.07%      37.284ms         0.13%      66.030ms      46.046us      50.416ms         0.10%      50.416ms      35.158us          1434  
                                            fetch label         0.02%       8.681ms         0.10%      50.554ms     315.962us      10.880ms         0.02%      50.073ms     312.956us           160  
                               aten::cross_entropy_loss         0.01%       5.500ms         0.08%      40.556ms     253.475us       6.694ms         0.01%      49.008ms     306.300us           160  
                                  FusedDropoutBackward0         0.01%       5.754ms         0.10%      51.280ms     160.250us       8.505ms         0.02%      48.561ms     151.753us           320  
                                             aten::relu         0.02%      11.524ms         0.10%      49.990ms     156.219us       7.709ms         0.01%      47.530ms     148.531us           320  
                                         aten::new_ones         0.02%      11.324ms         0.11%      55.605ms     115.844us       8.462ms         0.02%      46.852ms      97.608us           480  
                                              aten::sum         0.06%      30.475ms         0.09%      45.873ms      95.569us      44.866ms         0.09%      44.866ms      93.471us           480  
                                              aten::cat         0.02%       8.664ms         0.09%      44.953ms     280.956us       9.498ms         0.02%      43.958ms     274.738us           160  
                                             TBackward0         0.01%       6.531ms         0.09%      46.641ms      97.169us      11.447ms         0.02%      41.407ms      86.265us           480  
autograd::engine::evaluate_function: NllLossBackward...         0.01%       6.802ms         0.09%      45.908ms     286.925us       6.423ms         0.01%      41.226ms     257.663us           160  
                                           aten::select         0.06%      29.720ms         0.09%      46.128ms      48.050us      35.496ms         0.07%      40.427ms      42.111us           960  
                                    aten::_masked_scale         0.03%      13.242ms         0.08%      41.842ms     130.756us      23.162ms         0.04%      40.056ms     125.175us           320  
                                             aten::item         0.06%      29.484ms         0.09%      45.702ms      47.606us      34.217ms         0.07%      39.709ms      41.364us           960  
                                             aten::ones         0.04%      20.632ms         0.08%      41.891ms      87.273us      22.518ms         0.04%      38.390ms      79.979us           480  
     autograd::engine::evaluate_function: ReluBackward0         0.01%       7.716ms         0.08%      40.071ms     125.222us       9.574ms         0.02%      37.221ms     116.316us           320  
                                              aten::mul         0.05%      26.984ms         0.09%      47.349ms      49.322us      34.833ms         0.07%      34.833ms      36.284us           960  
                                       NllLossBackward0         0.01%       3.616ms         0.07%      35.324ms     220.775us       4.329ms         0.01%      34.803ms     217.519us           160  
                                             aten::_cat         0.03%      17.114ms         0.07%      35.422ms     221.387us      19.952ms         0.04%      34.460ms     215.375us           160  
                     Optimizer.zero_grad#Adam.zero_grad         0.02%      10.421ms         0.06%      31.651ms     791.275us      13.105ms         0.03%      31.257ms     781.425us            40  
                                aten::nll_loss_backward         0.02%       8.616ms         0.06%      29.728ms     185.800us      15.690ms         0.03%      30.474ms     190.463us           160  
                                      aten::nll_loss_nd         0.01%       3.011ms         0.04%      21.006ms     131.287us       3.196ms         0.01%      29.531ms     184.569us           160  
                                            aten::clamp         0.03%      17.011ms         0.06%      30.413ms      63.360us      18.907ms         0.04%      28.018ms      58.371us           480  
                                          ReluBackward0         0.01%       6.457ms         0.06%      29.067ms      90.834us       8.729ms         0.02%      27.647ms      86.397us           320  
                                         aten::nll_loss         0.01%       2.968ms         0.03%      17.320ms     108.250us       3.181ms         0.01%      26.335ms     164.594us           160  
                                 aten::nll_loss_forward         0.01%       7.637ms         0.03%      13.973ms      87.331us      22.091ms         0.04%      23.154ms     144.713us           160  
                                   aten::_reshape_alias         0.05%      26.273ms         0.07%      35.631ms      12.091us      20.485ms         0.04%      20.485ms       6.951us          2947  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.01%       4.192ms         0.04%      22.164ms     138.525us       5.891ms         0.01%      20.458ms     127.862us           160  
                               aten::threshold_backward         0.02%      12.134ms         0.04%      19.250ms      60.156us      18.918ms         0.04%      18.918ms      59.119us           320  
                                           aten::expand         0.03%      13.361ms         0.04%      20.187ms      42.056us      14.608ms         0.03%      16.517ms      34.410us           480  
                                             aten::mul_         0.02%      12.517ms         0.04%      21.555ms      44.906us      16.362ms         0.03%      16.362ms      34.087us           480  
                                    LogSoftmaxBackward0         0.01%       3.862ms         0.03%      16.281ms     101.756us       5.739ms         0.01%      14.567ms      91.044us           160  
                                         create sampler         0.02%      12.711ms         0.03%      13.411ms       1.341ms      12.979ms         0.03%      13.367ms       1.337ms            10  
                                      aten::log_softmax         0.01%       5.416ms         0.03%      13.519ms      84.494us       6.491ms         0.01%      12.783ms      79.894us           160  
                                           aten::narrow         0.01%       5.030ms         0.03%      13.343ms      83.394us       5.856ms         0.01%      12.389ms      77.431us           160  
                                        aten::ones_like         0.01%       4.888ms         0.03%      14.736ms      92.100us       4.772ms         0.01%      12.158ms      75.987us           160  
                                             aten::sqrt         0.01%       7.514ms         0.02%      11.780ms      49.083us       9.475ms         0.02%       9.475ms      39.479us           240  
                       aten::_log_softmax_backward_data         0.01%       6.112ms         0.02%      10.639ms      66.494us       8.828ms         0.02%       8.828ms      55.175us           160  
                                         aten::addcdiv_         0.01%       6.215ms         0.02%      10.436ms      43.483us       8.072ms         0.02%       8.072ms      33.633us           240  
                                         aten::addcmul_         0.01%       6.163ms         0.02%      10.486ms      43.692us       8.062ms         0.02%       8.062ms      33.592us           240  
                                             aten::view         0.01%       7.452ms         0.02%      12.759ms      26.581us       6.001ms         0.01%       6.001ms      12.502us           480  
                                     aten::_log_softmax         0.01%       4.317ms         0.01%       6.386ms      39.913us       5.759ms         0.01%       5.759ms      35.994us           160  
                              aten::_local_scalar_dense         0.01%       6.425ms         0.02%      11.177ms      11.643us       5.492ms         0.01%       5.492ms       5.721us           960  
                                          aten::resize_         0.01%       6.504ms         0.02%       9.218ms      11.523us       5.445ms         0.01%       5.445ms       6.806us           800  
                                     aten::resolve_conj         0.01%       5.543ms         0.02%       9.915ms      10.328us       4.355ms         0.01%       4.355ms       4.536us           960  
                                      aten::resolve_neg         0.01%       5.311ms         0.03%      13.237ms      13.789us       4.253ms         0.01%       4.253ms       4.430us           960  
                aten::_has_compatible_shallow_copy_type         0.01%       3.478ms         0.01%       5.228ms       8.169us       2.589ms         0.01%       2.589ms       4.045us           640  
                                             aten::set_         0.00%       2.138ms         0.01%       3.594ms      22.185us       2.109ms         0.00%       2.109ms      13.019us           162  
                                           aten::detach         0.00%      76.000us         0.00%     314.000us      52.333us     134.000us         0.00%     256.000us      42.667us             6  
                                          aten::detach_         0.00%     161.000us         0.00%     272.000us      27.200us     191.000us         0.00%     232.000us      23.200us            10  
                                                 detach         0.00%      83.000us         0.00%     180.000us      30.000us     122.000us         0.00%     122.000us      20.333us             6  
                                                detach_         0.00%      61.000us         0.00%      86.000us       8.600us      41.000us         0.00%      41.000us       4.100us            10  
                                        cudaEventCreate         0.52%     269.184ms         0.52%     269.184ms       1.228us       0.000us         0.00%       0.000us       0.000us        219162  
                                        cudaEventRecord         0.84%     432.546ms         0.84%     432.546ms       1.964us       0.000us         0.00%       0.000us       0.000us        220226  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 51.603s
Self CUDA time total: 51.511s

2023-04-05 06:07:30,079 - INFO - Rank 0 | wait sampler total time: 0.04884147644042969, total sub_iters: 16, avg sub_iter time:0.0030525922775268555
