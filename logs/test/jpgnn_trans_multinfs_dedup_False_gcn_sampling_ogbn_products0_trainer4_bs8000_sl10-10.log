2023-04-06 06:55:46,764 - INFO - Rank 0 | Client Args: Namespace(dataset='./dist/repgnn_data/ogbn_products0/', num_gpu=1, sampling='10-10', hidden_size=256, n_classes=6, batch_size=8000, dropout=0.5, lr=0.03, weight_decay=0, model_name='gcn', epoch=1, num_worker=1, cache_size=0, ckpt_path='/dev/shm', seed=None, log=True, dist_url='tcp://10.214.241.227:23457', world_size=4, rank=0, gpu=0, grpc_port='10.214.241.227:18112', deduplicate=False, distributed=True)
2023-04-06 06:55:58,056 - INFO - Rank 0 | Added key: store_based_barrier_key:1 to store for rank: 0
2023-04-06 06:55:58,086 - INFO - Rank 0 | Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
2023-04-06 06:55:58,086 - INFO - Rank 0 | Using 4 distributed GPUs in total for training...
2023-04-06 06:56:10,252 - INFO - Rank 0 | -> 调用不去冗余的 fetch_multiple_nfs_v2 函数
2023-04-06 06:56:11,717 - INFO - Rank 0 | n_sub_batches:397855
2023-04-06 06:56:27,803 - INFO - Rank 0 | Reducer buckets have been rebuilt in this iteration.
2023-04-06 07:01:47,639 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 0 on rank 0: 17437602 / 104155918 = 0.16741825462092322
2023-04-06 07:01:47,640 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 17.682 s, total_remote_feats_gather_time = 97.098 s
2023-04-06 07:01:47,640 - INFO - Rank 0 | => cur_epoch 0 finished on rank 0
2023-04-06 07:02:46,744 - INFO - Rank 0 | -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      total epochs time        11.84%       39.964s        99.52%      336.050s      336.050s       39.983s        11.84%      336.068s      336.068s             1  
                                             fetch feat         1.27%        4.275s        66.74%      225.343s        4.507s        4.311s         1.28%      225.355s        4.507s            50  
                           fetch feat from cache server        56.52%      190.848s        56.66%      191.325s     956.624ms      190.982s        56.57%      191.334s     956.672ms           200  
                                            gpu-compute        12.36%       41.751s        19.87%       67.084s     268.335ms       41.753s        12.37%       67.086s     268.342ms           250  
                        DistributedDataParallel.forward         6.20%       20.946s         7.43%       25.088s     125.442ms       21.632s         6.41%       25.088s     125.442ms           200  
                                      deduplicate tnids         2.79%        9.431s         2.79%        9.437s      47.186ms        9.436s         2.80%        9.436s      47.182ms           200  
                                            aten::copy_         0.80%        2.710s         2.26%        7.639s     848.197us        7.580s         2.25%        7.580s     841.679us          9006  
                               concat all fetched feats         0.53%        1.798s         2.02%        6.818s      34.089ms        1.800s         0.53%        6.817s      34.085ms           200  
                                            fill frames         0.47%        1.599s         1.95%        6.570s      32.852ms        1.623s         0.48%        6.570s      32.848ms           200  
                             move feats from CPU to GPU         0.50%        1.674s         1.81%        6.108s      30.538ms        1.686s         0.50%        6.107s      30.535ms           200  
                                               aten::to         0.04%     137.583ms         1.71%        5.771s     874.063us     162.784ms         0.05%        5.727s     867.428us          6602  
                                         aten::_to_copy         0.07%     243.912ms         1.66%        5.598s     999.588us     305.585ms         0.09%        5.564s     993.567us          5600  
                                              aten::cat         0.00%       8.532ms         1.49%        5.017s      25.085ms       9.364ms         0.00%        5.016s      25.081ms           200  
                                             aten::_cat         1.29%        4.357s         1.48%        5.008s      25.038ms        4.431s         1.31%        5.007s      25.034ms           200  
                                            aten::index         1.05%        3.553s         1.10%        3.719s       1.690ms        3.584s         1.06%        3.696s       1.680ms          2200  
                                         model transfer         0.73%        2.463s         0.92%        3.121s      15.607ms        2.506s         0.74%        3.120s      15.600ms           200  
                                             CopyReduce         0.11%     377.681ms         0.41%        1.382s       2.303ms        1.272s         0.38%        1.452s       2.420ms           600  
                                           aten::narrow         0.05%     173.201ms         0.19%     643.987ms      64.002us     208.129ms         0.06%     571.859ms      56.834us         10062  
                                            aten::slice         0.12%     403.305ms         0.19%     634.841ms      42.149us     469.424ms         0.14%     545.707ms      36.231us         15062  
autograd::engine::evaluate_function: CopyReduceBackw...         0.00%      12.330ms         0.16%     532.830ms       1.332ms      17.049ms         0.01%     528.967ms       1.322ms           400  
                                     CopyReduceBackward         0.06%     193.604ms         0.15%     516.154ms       1.290ms     458.561ms         0.14%     511.918ms       1.280ms           400  
    autograd::engine::evaluate_function: AddmmBackward0         0.01%      23.646ms         0.11%     360.668ms     601.113us      26.282ms         0.01%     454.427ms     757.378us           600  
                                          aten::reshape         0.10%     327.582ms         0.17%     584.651ms      45.456us     346.608ms         0.10%     440.892ms      34.279us         12862  
                                         AddmmBackward0         0.01%      22.244ms         0.08%     263.622ms     439.370us      33.219ms         0.01%     333.091ms     555.152us           600  
                                            get nf_nids         0.01%      27.005ms         0.09%     305.684ms       6.114ms      30.276ms         0.01%     305.050ms       6.101ms            50  
                                           aten::linear         0.01%      33.527ms         0.06%     195.930ms     326.550us      27.516ms         0.01%     257.244ms     428.740us           600  
                                          aten::dropout         0.01%      18.046ms         0.04%     141.528ms     235.880us      17.420ms         0.01%     235.693ms     392.822us           600  
                                               aten::mm         0.02%      78.370ms         0.04%     122.008ms     122.008us     227.653ms         0.07%     227.653ms     227.653us          1000  
                                   aten::_fused_dropout         0.01%      42.507ms         0.04%     119.155ms     198.592us     160.535ms         0.05%     218.273ms     363.788us           600  
                                            aten::addmm         0.02%      67.048ms         0.03%     109.017ms     181.695us     175.604ms         0.05%     193.845ms     323.075us           600  
                                            fetch label         0.00%      15.835ms         0.05%     183.994ms     919.970us      19.572ms         0.01%     182.809ms     914.045us           200  
                                       aten::zeros_like         0.01%      47.238ms         0.05%     179.605ms     148.189us      62.219ms         0.02%     171.252ms     141.297us          1212  
                                            aten::zeros         0.03%      99.098ms         0.05%     183.564ms      69.191us     129.127ms         0.04%     163.594ms      61.664us          2653  
autograd::engine::evaluate_function: torch::autograd...         0.02%      64.988ms         0.07%     250.993ms     209.161us      54.065ms         0.02%     158.903ms     132.419us          1200  
                                 sync for each sub_iter         0.04%     143.559ms         0.04%     148.106ms     740.530us     145.453ms         0.04%     146.731ms     733.655us           200  
                                                aten::t         0.02%      59.548ms         0.06%     205.273ms      73.312us      63.028ms         0.02%     136.313ms      48.683us          2800  
                                       aten::empty_like         0.02%      68.293ms         0.05%     151.956ms      50.450us      82.475ms         0.02%     130.702ms      43.394us          3012  
                                    aten::empty_strided         0.04%     126.899ms         0.05%     180.653ms      21.999us     129.917ms         0.04%     129.917ms      15.820us          8212  
                                       aten::as_strided         0.05%     153.792ms         0.08%     266.106ms      12.169us     126.790ms         0.04%     126.790ms       5.798us         21868  
                                        aten::clamp_min         0.01%      41.491ms         0.03%      87.628ms      62.591us      67.413ms         0.02%     123.289ms      88.064us          1400  
                               Optimizer.step#Adam.step         0.02%      57.708ms         0.04%     122.166ms       2.443ms      71.740ms         0.02%     121.894ms       2.438ms            50  
                                            aten::empty         0.04%     132.432ms         0.06%     192.384ms      16.423us     114.336ms         0.03%     114.336ms       9.761us         11714  
                                            aten::zero_         0.01%      42.938ms         0.04%     139.619ms      31.986us      42.512ms         0.01%     110.126ms      25.229us          4365  
                                     train data prepare         0.03%     108.755ms         0.03%     108.790ms     108.790ms     108.778ms         0.03%     108.783ms     108.783ms             1  
autograd::engine::evaluate_function: FusedDropoutBac...         0.00%      10.539ms         0.02%      79.265ms     198.162us       9.693ms         0.00%     105.489ms     263.723us           400  
                                  FusedDropoutBackward0         0.00%       6.989ms         0.02%      64.653ms     161.632us       8.327ms         0.00%      95.796ms     239.490us           400  
                                              aten::div         0.01%      34.019ms         0.02%      52.365ms      40.281us      94.370ms         0.03%      94.370ms      72.592us          1300  
                                   aten::_reshape_alias         0.03%     117.488ms         0.05%     161.929ms      12.590us      94.284ms         0.03%      94.284ms       7.330us         12862  
                                              aten::sum         0.01%      33.305ms         0.02%      51.882ms      86.470us      90.542ms         0.03%      90.542ms     150.903us           600  
                                    aten::_masked_scale         0.00%      15.993ms         0.02%      53.618ms     134.045us      63.833ms         0.02%      87.469ms     218.673us           400  
                                            aten::fill_         0.02%      74.823ms         0.03%      96.289ms      63.683us      79.193ms         0.02%      79.193ms      52.376us          1512  
     autograd::engine::evaluate_function: ReluBackward0         0.00%       8.852ms         0.01%      47.253ms     118.132us       5.421ms         0.00%      78.827ms     197.067us           400  
                                             aten::relu         0.01%      27.203ms         0.02%      76.935ms     192.338us      15.375ms         0.00%      77.905ms     194.762us           400  
                                          ReluBackward0         0.00%       7.543ms         0.01%      34.564ms      86.410us       5.855ms         0.00%      73.406ms     183.515us           400  
                                        aten::transpose         0.01%      46.261ms         0.04%     120.488ms      43.031us      52.133ms         0.02%      73.285ms      26.173us          2800  
                               aten::threshold_backward         0.00%      14.314ms         0.01%      23.153ms      57.883us      67.551ms         0.02%      67.551ms     168.877us           400  
                               aten::cross_entropy_loss         0.00%       7.054ms         0.02%      53.998ms     269.990us       8.327ms         0.00%      66.492ms     332.460us           200  
                                        aten::new_empty         0.01%      37.461ms         0.02%      82.892ms      51.807us      38.456ms         0.01%      62.607ms      39.129us          1600  
                        torch::autograd::AccumulateGrad         0.01%      18.840ms         0.03%      88.251ms      73.543us      26.282ms         0.01%      61.041ms      50.867us          1200  
autograd::engine::evaluate_function: NllLossBackward...         0.00%       9.312ms         0.02%      60.258ms     301.290us       7.678ms         0.00%      53.425ms     267.125us           200  
        autograd::engine::evaluate_function: TBackward0         0.00%      11.346ms         0.02%      71.263ms     118.772us      13.042ms         0.00%      51.950ms      86.583us           600  
                                       NllLossBackward0         0.00%       4.755ms         0.01%      45.508ms     227.540us       5.412ms         0.00%      45.747ms     228.735us           200  
                                             aten::add_         0.01%      38.078ms         0.02%      71.627ms      39.926us      45.382ms         0.01%      45.382ms      25.297us          1794  
                                          create frames         0.01%      31.270ms         0.01%      46.042ms     230.210us      37.108ms         0.01%      45.069ms     225.345us           200  
                                      aten::nll_loss_nd         0.00%       3.974ms         0.01%      28.454ms     142.270us       4.158ms         0.00%      41.466ms     207.330us           200  
                                aten::nll_loss_backward         0.00%      11.481ms         0.01%      38.445ms     192.225us      20.710ms         0.01%      40.335ms     201.675us           200  
                                asign frame to nodeflow         0.01%      36.015ms         0.01%      40.437ms     202.185us      38.558ms         0.01%      39.411ms     197.055us           200  
                                             TBackward0         0.00%       7.623ms         0.02%      54.232ms      90.387us      10.697ms         0.00%      38.908ms      64.847us           600  
                                         aten::nll_loss         0.00%       3.960ms         0.01%      23.958ms     119.790us       4.713ms         0.00%      37.308ms     186.540us           200  
                                         aten::new_ones         0.00%      15.337ms         0.02%      76.460ms     127.433us       9.063ms         0.00%      35.350ms      58.917us           600  
                                              aten::mul         0.01%      31.227ms         0.02%      57.685ms      48.071us      33.128ms         0.01%      33.128ms      27.607us          1200  
                                 aten::nll_loss_forward         0.00%      10.026ms         0.01%      18.858ms      94.290us      31.169ms         0.01%      32.595ms     162.975us           200  
                                            aten::clamp         0.01%      25.574ms         0.01%      43.422ms      72.370us      20.113ms         0.01%      29.672ms      49.453us           600  
                                             aten::ones         0.01%      26.343ms         0.02%      57.157ms      95.262us      14.826ms         0.00%      26.287ms      43.812us           600  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%       4.935ms         0.01%      26.226ms     131.130us       6.930ms         0.00%      24.095ms     120.475us           200  
                     Optimizer.zero_grad#Adam.zero_grad         0.00%       7.341ms         0.01%      22.563ms     451.260us       9.197ms         0.00%      22.277ms     445.540us            50  
                                           aten::expand         0.01%      17.368ms         0.01%      25.453ms      42.422us      15.772ms         0.00%      18.241ms      30.402us           600  
                                         create sampler         0.01%      17.569ms         0.01%      17.672ms      17.672ms      17.620ms         0.01%      17.667ms      17.667ms             1  
                                    LogSoftmaxBackward0         0.00%       4.493ms         0.01%      19.168ms      95.840us       6.665ms         0.00%      17.165ms      85.825us           200  
                                      aten::log_softmax         0.00%       6.792ms         0.01%      17.660ms      88.300us       8.277ms         0.00%      16.699ms      83.495us           200  
                                        aten::ones_like         0.00%       6.202ms         0.01%      18.743ms      93.715us       5.759ms         0.00%      13.917ms      69.585us           200  
                                             aten::mul_         0.00%       9.002ms         0.00%      14.929ms      24.882us      11.512ms         0.00%      11.512ms      19.187us           600  
                       aten::_log_softmax_backward_data         0.00%       7.403ms         0.00%      12.545ms      62.725us      10.500ms         0.00%      10.500ms      52.500us           200  
                                      aten::resolve_neg         0.00%       9.062ms         0.00%      11.773ms      14.716us       7.844ms         0.00%       7.844ms       9.805us           800  
                                          aten::resize_         0.00%      11.016ms         0.00%      14.533ms      14.533us       7.772ms         0.00%       7.772ms       7.772us          1000  
                                     aten::_log_softmax         0.00%       5.720ms         0.00%       8.449ms      42.245us       7.593ms         0.00%       7.593ms      37.965us           200  
                                             aten::sqrt         0.00%       5.424ms         0.00%       8.639ms      28.797us       7.060ms         0.00%       7.060ms      23.533us           300  
                                         aten::addcdiv_         0.00%       4.701ms         0.00%       8.350ms      27.833us       6.266ms         0.00%       6.266ms      20.887us           300  
                                         aten::addcmul_         0.00%       4.548ms         0.00%       7.744ms      25.813us       6.086ms         0.00%       6.086ms      20.287us           300  
                                             aten::view         0.00%       8.684ms         0.00%      14.470ms      24.117us       4.512ms         0.00%       4.512ms       7.520us           600  
                aten::_has_compatible_shallow_copy_type         0.00%       4.641ms         0.00%       7.570ms       9.463us       3.637ms         0.00%       3.637ms       4.546us           800  
                                     aten::resolve_conj         0.00%       4.865ms         0.00%       7.274ms       9.092us       3.287ms         0.00%       3.287ms       4.109us           800  
                                             aten::set_         0.00%       2.705ms         0.00%       4.369ms      21.629us       1.056ms         0.00%       1.056ms       5.228us           202  
                                           aten::detach         0.00%      62.000us         0.00%     238.000us      39.667us      96.000us         0.00%     152.000us      25.333us             6  
                                                 detach         0.00%      72.000us         0.00%     117.000us      19.500us      56.000us         0.00%      56.000us       9.333us             6  
                                          aten::detach_         0.00%      17.000us         0.00%      30.000us      30.000us      20.000us         0.00%      26.000us      26.000us             1  
                                                detach_         0.00%       8.000us         0.00%      10.000us      10.000us       6.000us         0.00%       6.000us       6.000us             1  
                                        cudaEventCreate         0.11%     382.800ms         0.11%     382.800ms       1.118us       0.000us         0.00%       0.000us       0.000us        342538  
                                        cudaEventRecord         0.20%     671.429ms         0.20%     671.429ms       1.953us       0.000us         0.00%       0.000us       0.000us        343811  
                                  cudaStreamIsCapturing         0.00%     753.000us         0.00%     753.000us       1.167us       0.000us         0.00%       0.000us       0.000us           645  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 337.664s
Self CUDA time total: 337.575s

2023-04-06 07:02:46,744 - INFO - Rank 0 | wait sampler total time: 39.885427713394165, total sub_iters: 50, avg sub_iter time:0.7977085542678833
