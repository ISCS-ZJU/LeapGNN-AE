2023-04-06 07:21:32,691 - INFO - Rank 0 | Client Args: Namespace(dataset='./dist/repgnn_data/ogbn_products0/', num_gpu=1, sampling='10-10', hidden_size=256, n_classes=6, batch_size=8000, dropout=0.5, lr=0.03, weight_decay=0, model_name='gcn', epoch=1, num_worker=1, cache_size=0, ckpt_path='/dev/shm', seed=None, log=True, dist_url='tcp://10.214.241.227:23457', world_size=4, rank=0, gpu=0, grpc_port='10.214.241.227:18112', deduplicate=True, distributed=True)
2023-04-06 07:21:39,954 - INFO - Rank 0 | Added key: store_based_barrier_key:1 to store for rank: 0
2023-04-06 07:21:39,985 - INFO - Rank 0 | Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
2023-04-06 07:21:39,985 - INFO - Rank 0 | Using 4 distributed GPUs in total for training...
2023-04-06 07:21:54,198 - INFO - Rank 0 | -> 调用去冗余的 fetch_multiple_nfs_elimredun 函数
2023-04-06 07:21:56,160 - INFO - Rank 0 | n_sub_batches:397855
2023-04-06 07:22:11,700 - INFO - Rank 0 | Reducer buckets have been rebuilt in this iteration.
2023-04-06 07:26:08,733 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 0 on rank 0: 12530609 / 53109755 = 0.23593799293557277
2023-04-06 07:26:08,734 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 7.956 s, total_remote_feats_gather_time = 64.696 s
2023-04-06 07:26:08,734 - INFO - Rank 0 | => cur_epoch 0 finished on rank 0
2023-04-06 07:27:00,416 - INFO - Rank 0 | -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      total epochs time        16.39%       41.696s        99.34%      252.708s      252.708s       41.715s        16.40%      252.710s      252.710s             1  
                                             fetch feat         1.68%        4.276s        57.22%      145.552s        2.911s        4.312s         1.70%      145.552s        2.911s            50  
                           fetch feat from cache server        42.03%      106.908s        42.12%      107.140s     535.701ms      106.976s        42.07%      107.140s     535.700ms           200  
                                            gpu-compute        13.68%       34.807s        24.25%       61.700s     246.800ms       34.808s        13.69%       61.698s     246.791ms           250  
                        DistributedDataParallel.forward         8.86%       22.547s        10.47%       26.639s     133.195ms       23.332s         9.18%       26.638s     133.189ms           200  
                                      deduplicate tnids         5.82%       14.796s         5.82%       14.802s      74.012ms       14.800s         5.82%       14.801s      74.006ms           200  
                                            aten::copy_         1.10%        2.806s         3.43%        8.734s     969.797us        8.675s         3.41%        8.675s     963.194us          9006  
                             move feats from CPU to GPU         0.72%        1.826s         2.92%        7.428s      37.139ms        1.839s         0.72%        7.427s      37.135ms           200  
                                            fill frames         0.75%        1.900s         2.86%        7.279s      36.396ms        1.928s         0.76%        7.278s      36.391ms           200  
                                               aten::to         0.06%     142.679ms         2.73%        6.956s       1.054ms     168.504ms         0.07%        6.908s       1.046ms          6602  
                                         aten::_to_copy         0.10%     251.232ms         2.66%        6.774s       1.210ms     312.368ms         0.12%        6.740s       1.204ms          5600  
                                            aten::index         1.50%        3.828s         1.57%        4.001s       1.819ms        3.859s         1.52%        3.980s       1.809ms          2200  
                               concat all fetched feats         0.39%     981.529ms         1.49%        3.800s      18.999ms     983.519ms         0.39%        3.799s      18.993ms           200  
                                         model transfer         1.00%        2.542s         1.27%        3.234s      16.169ms        2.586s         1.02%        3.232s      16.161ms           200  
                                              aten::cat         0.00%       7.269ms         1.11%        2.815s      14.076ms       8.130ms         0.00%        2.814s      14.071ms           200  
                                             aten::_cat         0.97%        2.461s         1.10%        2.807s      14.035ms        2.496s         0.98%        2.806s      14.030ms           200  
                                             CopyReduce         0.12%     313.683ms         0.48%        1.224s       2.040ms        1.119s         0.44%        1.299s       2.165ms           600  
    autograd::engine::evaluate_function: AddmmBackward0         0.01%      23.064ms         0.17%     444.902ms     741.503us      24.392ms         0.01%     542.332ms     903.887us           600  
autograd::engine::evaluate_function: CopyReduceBackw...         0.00%      11.427ms         0.20%     518.722ms       1.297ms      15.410ms         0.01%     515.001ms       1.288ms           400  
                                     CopyReduceBackward         0.07%     190.339ms         0.20%     503.488ms       1.259ms     444.725ms         0.17%     499.591ms       1.249ms           400  
                                         AddmmBackward0         0.05%     115.228ms         0.14%     349.477ms     582.462us     125.928ms         0.05%     421.414ms     702.357us           600  
                                            get nf_nids         0.01%      28.142ms         0.13%     323.300ms       6.466ms      31.656ms         0.01%     322.613ms       6.452ms            50  
                                            aten::slice         0.08%     212.776ms         0.15%     380.417ms      37.398us     260.317ms         0.10%     313.823ms      30.852us         10172  
                                           aten::narrow         0.06%     146.942ms         0.13%     337.456ms      65.247us     165.159ms         0.06%     303.591ms      58.699us          5172  
                                    aten::empty_strided         0.05%     132.463ms         0.14%     350.216ms      42.647us     300.271ms         0.12%     300.271ms      36.565us          8212  
                                          aten::reshape         0.07%     187.617ms         0.14%     349.266ms      43.812us     202.683ms         0.08%     261.978ms      32.862us          7972  
                                           aten::linear         0.01%      33.945ms         0.08%     198.915ms     331.525us      27.368ms         0.01%     254.532ms     424.220us           600  
                                          aten::dropout         0.01%      18.058ms         0.05%     135.877ms     226.462us      17.444ms         0.01%     230.608ms     384.347us           600  
                                               aten::mm         0.03%      77.362ms         0.05%     118.895ms     118.895us     227.152ms         0.09%     227.152ms     227.152us          1000  
                                   aten::_fused_dropout         0.02%      41.789ms         0.04%     113.856ms     189.760us     159.021ms         0.06%     213.164ms     355.273us           600  
                                            aten::addmm         0.03%      67.588ms         0.04%     109.274ms     182.123us     173.706ms         0.07%     191.435ms     319.058us           600  
                                       aten::zeros_like         0.02%      50.253ms         0.07%     189.580ms     156.419us      70.018ms         0.03%     180.779ms     149.158us          1212  
                                 sync for each sub_iter         0.07%     174.873ms         0.07%     179.705ms     898.525us     176.808ms         0.07%     178.201ms     891.005us           200  
                                            aten::zeros         0.04%     102.934ms         0.07%     187.753ms      70.770us     131.288ms         0.05%     167.022ms      62.956us          2653  
autograd::engine::evaluate_function: torch::autograd...         0.02%      62.245ms         0.09%     240.490ms     200.408us      47.012ms         0.02%     149.496ms     124.580us          1200  
                                                aten::t         0.02%      58.127ms         0.08%     199.964ms      71.416us      59.545ms         0.02%     130.820ms      46.721us          2800  
                                       aten::empty_like         0.03%      69.560ms         0.06%     151.772ms      50.389us      84.190ms         0.03%     129.319ms      42.935us          3012  
                               Optimizer.step#Adam.step         0.02%      62.085ms         0.05%     129.535ms       2.591ms      77.929ms         0.03%     129.214ms       2.584ms            50  
                                            fetch label         0.01%      14.838ms         0.05%     129.139ms     645.695us      18.506ms         0.01%     127.976ms     639.880us           200  
                                        aten::clamp_min         0.02%      42.095ms         0.04%      91.954ms      65.681us      68.245ms         0.03%     125.246ms      89.461us          1400  
                                            aten::empty         0.05%     136.820ms         0.08%     199.102ms      16.997us     117.566ms         0.05%     117.566ms      10.036us         11714  
                                     train data prepare         0.05%     114.740ms         0.05%     114.770ms     114.770ms     114.761ms         0.05%     114.765ms     114.765ms             1  
                                            aten::zero_         0.02%      44.525ms         0.05%     139.400ms      31.936us      44.551ms         0.02%     110.068ms      25.216us          4365  
autograd::engine::evaluate_function: FusedDropoutBac...         0.00%      10.141ms         0.03%      77.257ms     193.143us       9.234ms         0.00%     104.154ms     260.385us           400  
                                       aten::as_strided         0.05%     127.162ms         0.09%     217.914ms      12.835us     102.930ms         0.04%     102.930ms       6.063us         16978  
                                              aten::div         0.01%      33.406ms         0.02%      53.230ms      40.946us      95.066ms         0.04%      95.066ms      73.128us          1300  
                                  FusedDropoutBackward0         0.00%       6.697ms         0.02%      63.295ms     158.238us       8.084ms         0.00%      94.920ms     237.300us           400  
                                              aten::sum         0.01%      31.925ms         0.02%      51.071ms      85.118us      91.994ms         0.04%      91.994ms     153.323us           600  
                                    aten::_masked_scale         0.01%      15.162ms         0.02%      52.613ms     131.532us      64.420ms         0.03%      86.836ms     217.090us           400  
     autograd::engine::evaluate_function: ReluBackward0         0.00%       8.592ms         0.02%      47.362ms     118.405us       6.933ms         0.00%      79.779ms     199.447us           400  
                                            aten::fill_         0.03%      73.326ms         0.04%      94.349ms      62.400us      77.007ms         0.03%      77.007ms      50.931us          1512  
                                          ReluBackward0         0.00%       8.397ms         0.01%      35.083ms      87.707us       5.880ms         0.00%      72.846ms     182.115us           400  
                                        aten::transpose         0.02%      45.578ms         0.05%     118.514ms      42.326us      51.395ms         0.02%      71.275ms      25.455us          2800  
                                          create frames         0.02%      52.900ms         0.03%      72.164ms     360.820us      62.613ms         0.02%      71.135ms     355.675us           200  
                                             aten::relu         0.01%      14.850ms         0.03%      67.196ms     167.990us       3.204ms         0.00%      67.014ms     167.535us           400  
                               aten::threshold_backward         0.01%      13.729ms         0.01%      22.095ms      55.237us      66.966ms         0.03%      66.966ms     167.415us           400  
                               aten::cross_entropy_loss         0.00%       7.055ms         0.02%      53.335ms     266.675us       8.373ms         0.00%      66.186ms     330.930us           200  
                                        aten::new_empty         0.01%      37.353ms         0.03%      85.519ms      53.449us      40.178ms         0.02%      65.065ms      40.666us          1600  
                        torch::autograd::AccumulateGrad         0.01%      21.957ms         0.03%      87.102ms      72.585us      27.168ms         0.01%      60.966ms      50.805us          1200  
                                   aten::_reshape_alias         0.03%      72.127ms         0.04%     103.914ms      13.035us      59.295ms         0.02%      59.295ms       7.438us          7972  
autograd::engine::evaluate_function: NllLossBackward...         0.00%      10.207ms         0.03%      64.183ms     320.915us       8.071ms         0.00%      56.063ms     280.315us           200  
        autograd::engine::evaluate_function: TBackward0         0.00%      10.779ms         0.03%      68.020ms     113.367us      12.578ms         0.00%      49.759ms      82.932us           600  
                                       NllLossBackward0         0.00%       4.955ms         0.02%      47.972ms     239.860us       5.668ms         0.00%      47.992ms     239.960us           200  
                                             aten::add_         0.02%      38.548ms         0.03%      68.725ms      38.308us      44.995ms         0.02%      44.995ms      25.081us          1794  
                                aten::nll_loss_backward         0.00%      12.238ms         0.02%      40.513ms     202.565us      21.583ms         0.01%      42.324ms     211.620us           200  
                                      aten::nll_loss_nd         0.00%       3.919ms         0.01%      27.013ms     135.065us       4.121ms         0.00%      40.353ms     201.765us           200  
                                             TBackward0         0.00%       7.359ms         0.02%      51.625ms      86.042us      10.424ms         0.00%      37.181ms      61.968us           600  
                                         aten::nll_loss         0.00%       3.901ms         0.01%      22.556ms     112.780us       4.123ms         0.00%      36.232ms     181.160us           200  
                                asign frame to nodeflow         0.01%      34.442ms         0.01%      37.159ms     185.795us      35.295ms         0.01%      36.147ms     180.735us           200  
                                         aten::new_ones         0.01%      15.124ms         0.03%      77.713ms     129.522us       9.463ms         0.00%      35.988ms      59.980us           600  
                                 aten::nll_loss_forward         0.00%       9.743ms         0.01%      18.149ms      90.745us      30.657ms         0.01%      32.109ms     160.545us           200  
                                              aten::mul         0.01%      31.767ms         0.02%      56.441ms      47.034us      32.108ms         0.01%      32.108ms      26.757us          1200  
                                            aten::clamp         0.01%      22.837ms         0.02%      41.737ms      69.562us      18.269ms         0.01%      27.869ms      46.448us           600  
                                             aten::ones         0.01%      26.967ms         0.02%      59.424ms      99.040us      15.055ms         0.01%      26.525ms      44.208us           600  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%       4.879ms         0.01%      25.697ms     128.485us       6.776ms         0.00%      23.584ms     117.920us           200  
                     Optimizer.zero_grad#Adam.zero_grad         0.00%       7.315ms         0.01%      22.741ms     454.820us       9.344ms         0.00%      22.428ms     448.560us            50  
                                         create sampler         0.01%      19.183ms         0.01%      19.296ms      19.296ms      19.245ms         0.01%      19.292ms      19.292ms             1  
                                           aten::expand         0.01%      17.323ms         0.01%      25.719ms      42.865us      15.323ms         0.01%      17.729ms      29.548us           600  
                                      aten::log_softmax         0.00%       6.920ms         0.01%      18.425ms      92.125us       8.410ms         0.00%      17.460ms      87.300us           200  
                                    LogSoftmaxBackward0         0.00%       4.445ms         0.01%      18.737ms      93.685us       6.445ms         0.00%      16.808ms      84.040us           200  
                                        aten::ones_like         0.00%       6.218ms         0.01%      18.727ms      93.635us       5.729ms         0.00%      14.182ms      70.910us           200  
                                             aten::mul_         0.00%       9.304ms         0.01%      15.641ms      26.068us      11.997ms         0.00%      11.997ms      19.995us           600  
                       aten::_log_softmax_backward_data         0.00%       7.167ms         0.00%      12.325ms      61.625us      10.363ms         0.00%      10.363ms      51.815us           200  
                                          aten::resize_         0.01%      13.156ms         0.01%      16.888ms      16.888us       9.861ms         0.00%       9.861ms       9.861us          1000  
                                     aten::_log_softmax         0.00%       5.507ms         0.00%       8.248ms      41.240us       7.398ms         0.00%       7.398ms      36.990us           200  
                                             aten::sqrt         0.00%       5.709ms         0.00%       8.961ms      29.870us       7.233ms         0.00%       7.233ms      24.110us           300  
                                         aten::addcdiv_         0.00%       4.807ms         0.00%       8.683ms      28.943us       6.403ms         0.00%       6.403ms      21.343us           300  
                                         aten::addcmul_         0.00%       4.693ms         0.00%       8.829ms      29.430us       6.285ms         0.00%       6.285ms      20.950us           300  
                                             aten::view         0.00%       8.408ms         0.01%      15.455ms      25.758us       4.532ms         0.00%       4.532ms       7.553us           600  
                                     aten::resolve_conj         0.00%       4.843ms         0.00%       8.458ms      10.572us       4.320ms         0.00%       4.320ms       5.400us           800  
                aten::_has_compatible_shallow_copy_type         0.00%       4.727ms         0.00%       8.408ms      10.510us       3.627ms         0.00%       3.627ms       4.534us           800  
                                      aten::resolve_neg         0.00%       4.691ms         0.00%       7.090ms       8.863us       3.173ms         0.00%       3.173ms       3.966us           800  
                                             aten::set_         0.00%       2.637ms         0.00%       4.291ms      21.243us     837.000us         0.00%     837.000us       4.144us           202  
                                           aten::detach         0.00%      64.000us         0.00%     244.000us      40.667us     104.000us         0.00%     163.000us      27.167us             6  
                                                 detach         0.00%      74.000us         0.00%     118.000us      19.667us      59.000us         0.00%      59.000us       9.833us             6  
                                          aten::detach_         0.00%      16.000us         0.00%      30.000us      30.000us      20.000us         0.00%      26.000us      26.000us             1  
                                                detach_         0.00%       8.000us         0.00%      11.000us      11.000us       6.000us         0.00%       6.000us       6.000us             1  
                                        cudaEventCreate         0.15%     381.414ms         0.15%     381.414ms       1.299us       0.000us         0.00%       0.000us       0.000us        293638  
                                        cudaEventRecord         0.22%     560.565ms         0.22%     560.565ms       1.901us       0.000us         0.00%       0.000us       0.000us        294911  
                                  cudaStreamIsCapturing         0.00%     696.000us         0.00%     696.000us       1.079us       0.000us         0.00%       0.000us       0.000us           645  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 254.382s
Self CUDA time total: 254.283s

2023-04-06 07:27:00,416 - INFO - Rank 0 | wait sampler total time: 41.61499619483948, total sub_iters: 50, avg sub_iter time:0.8322999238967895
