2023-04-05 06:17:40,066 - INFO - Rank 0 | Client Args: Namespace(dataset='./dist/repgnn_data/ogbn_arxiv0/', num_gpu=1, sampling='10-10', hidden_size=256, n_classes=6, batch_size=800, dropout=0.5, lr=0.03, weight_decay=0, model_name='gcn', epoch=10, num_worker=1, cache_size=0, ckpt_path='/dev/shm', seed=None, log=True, dist_url='tcp://10.214.241.227:23457', world_size=4, rank=0, gpu=0, grpc_port='10.214.241.227:18112', distributed=True)
2023-04-05 06:17:50,992 - INFO - Rank 0 | Added key: store_based_barrier_key:1 to store for rank: 0
2023-04-05 06:17:51,013 - INFO - Rank 0 | Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
2023-04-05 06:17:51,013 - INFO - Rank 0 | Using 4 distributed GPUs in total for training...
2023-04-05 06:17:57,536 - INFO - Rank 0 | n_sub_batches:27559
2023-04-05 06:17:58,579 - INFO - Rank 0 | Reducer buckets have been rebuilt in this iteration.
2023-04-05 06:18:11,151 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 0 on rank 0: 357348 / 1033722 = 0.34569062088259706
2023-04-05 06:18:11,152 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 0.044 s, total_remote_feats_gather_time = 3.0180000000000002 s
2023-04-05 06:18:11,152 - INFO - Rank 0 | => cur_epoch 0 finished on rank 0
2023-04-05 06:18:11,394 - INFO - Rank 0 | n_sub_batches:27559
2023-04-05 06:18:24,109 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 1 on rank 0: 714902 / 2070267 = 0.3453187439108096
2023-04-05 06:18:24,110 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 0.068 s, total_remote_feats_gather_time = 6.013 s
2023-04-05 06:18:24,110 - INFO - Rank 0 | => cur_epoch 1 finished on rank 0
2023-04-05 06:18:24,358 - INFO - Rank 0 | n_sub_batches:27559
2023-04-05 06:18:37,155 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 2 on rank 0: 1071132 / 3104490 = 0.34502671936453333
2023-04-05 06:18:37,156 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 0.088 s, total_remote_feats_gather_time = 9.028 s
2023-04-05 06:18:37,157 - INFO - Rank 0 | => cur_epoch 2 finished on rank 0
2023-04-05 06:18:37,398 - INFO - Rank 0 | n_sub_batches:27559
2023-04-05 06:18:50,100 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 3 on rank 0: 1429869 / 4140905 = 0.3453035024952275
2023-04-05 06:18:50,102 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 0.10200000000000001 s, total_remote_feats_gather_time = 12.062 s
2023-04-05 06:18:50,102 - INFO - Rank 0 | => cur_epoch 3 finished on rank 0
2023-04-05 06:18:50,344 - INFO - Rank 0 | n_sub_batches:27559
2023-04-05 06:19:02,903 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 4 on rank 0: 1788270 / 5179044 = 0.3452895939868439
2023-04-05 06:19:02,904 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 0.121 s, total_remote_feats_gather_time = 15.05 s
2023-04-05 06:19:02,904 - INFO - Rank 0 | => cur_epoch 4 finished on rank 0
2023-04-05 06:19:03,149 - INFO - Rank 0 | n_sub_batches:27559
2023-04-05 06:19:16,147 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 5 on rank 0: 2146471 / 6215800 = 0.3453249782811545
2023-04-05 06:19:16,148 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 0.14200000000000002 s, total_remote_feats_gather_time = 18.117 s
2023-04-05 06:19:16,149 - INFO - Rank 0 | => cur_epoch 5 finished on rank 0
2023-04-05 06:19:16,394 - INFO - Rank 0 | n_sub_batches:27559
2023-04-05 06:19:29,238 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 6 on rank 0: 2503542 / 7253472 = 0.345150846380878
2023-04-05 06:19:29,240 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 0.161 s, total_remote_feats_gather_time = 21.189 s
2023-04-05 06:19:29,240 - INFO - Rank 0 | => cur_epoch 6 finished on rank 0
2023-04-05 06:19:29,485 - INFO - Rank 0 | n_sub_batches:27559
2023-04-05 06:19:42,123 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 7 on rank 0: 2862924 / 8289146 = 0.3453822625394703
2023-04-05 06:19:42,124 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 0.176 s, total_remote_feats_gather_time = 24.185000000000002 s
2023-04-05 06:19:42,124 - INFO - Rank 0 | => cur_epoch 7 finished on rank 0
2023-04-05 06:19:42,372 - INFO - Rank 0 | n_sub_batches:27559
2023-04-05 06:19:54,959 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 8 on rank 0: 3219946 / 9326234 = 0.34525683142842006
2023-04-05 06:19:54,961 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 0.199 s, total_remote_feats_gather_time = 27.217000000000002 s
2023-04-05 06:19:54,961 - INFO - Rank 0 | => cur_epoch 8 finished on rank 0
2023-04-05 06:19:55,207 - INFO - Rank 0 | n_sub_batches:27559
2023-04-05 06:20:07,754 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 9 on rank 0: 3577718 / 10362367 = 0.34526069188632286
2023-04-05 06:20:07,756 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 0.225 s, total_remote_feats_gather_time = 30.214000000000002 s
2023-04-05 06:20:07,756 - INFO - Rank 0 | => cur_epoch 9 finished on rank 0
2023-04-05 06:26:07,905 - INFO - Rank 0 | -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      total epochs time         1.03%        1.430s        93.76%      130.459s      130.459s        1.556s         1.12%      130.459s      130.459s             1  
                                             fetch feat         0.81%        1.126s        39.79%       55.371s      39.551ms        1.396s         1.01%       55.358s      39.542ms          1400  
                           fetch feat from cache server        32.16%       44.744s        33.37%       46.434s       8.292ms       44.892s        32.43%       46.407s       8.287ms          5600  
                                            gpu-compute        20.25%       28.177s        33.26%       46.283s      26.447ms       28.236s        20.40%       46.271s      26.441ms          1750  
                                         model transfer        12.69%       17.664s        16.51%       22.971s      16.408ms       17.994s        13.00%       22.958s      16.398ms          1400  
                        DistributedDataParallel.forward         4.20%        5.839s        11.12%       15.480s      11.057ms        6.490s         4.69%       15.473s      11.052ms          1400  
                                               aten::to         0.57%     797.501ms         3.99%        5.550s     165.083us     947.941ms         0.68%        5.330s     158.528us         33620  
                                         aten::_to_copy         1.05%        1.468s         3.29%        4.575s     142.083us        1.824s         1.32%        4.382s     136.079us         32200  
                                            aten::copy_         1.36%        1.895s         2.96%        4.119s      73.550us        3.782s         2.73%        3.782s      67.525us         56006  
                                             CopyReduce         1.07%        1.492s         2.62%        3.643s     867.282us        2.396s         1.73%        3.610s     859.610us          4200  
                                            get nf_nids         0.83%        1.149s         2.19%        3.047s       2.177ms        1.322s         0.96%        3.037s       2.170ms          1400  
                                     train data prepare         1.74%        2.418s         1.74%        2.418s     241.840ms        2.418s         1.75%        2.418s     241.829ms            10  
    autograd::engine::evaluate_function: AddmmBackward0         0.12%     160.250ms         1.65%        2.301s     547.814us     249.015ms         0.18%        2.261s     538.351us          4200  
                                            aten::zeros         1.05%        1.462s         1.66%        2.312s      69.484us        1.757s         1.27%        2.117s      63.637us         33271  
                                            aten::index         1.13%        1.570s         1.53%        2.133s     217.683us        1.674s         1.21%        2.068s     211.000us          9800  
autograd::engine::evaluate_function: CopyReduceBackw...         0.06%      80.487ms         1.47%        2.042s     729.376us     111.624ms         0.08%        2.016s     719.852us          2800  
                             move feats from CPU to GPU         0.23%     318.562ms         1.41%        1.965s     350.911us     389.999ms         0.28%        1.937s     345.853us          5600  
                                     CopyReduceBackward         0.86%        1.199s         1.39%        1.933s     690.420us        1.619s         1.17%        1.904s     679.986us          2800  
                                         AddmmBackward0         0.11%     147.518ms         1.23%        1.709s     406.900us     319.985ms         0.23%        1.670s     397.577us          4200  
autograd::engine::evaluate_function: torch::autograd...         0.30%     411.503ms         1.13%        1.575s     187.495us     619.085ms         0.45%        1.491s     177.501us          8400  
                               Optimizer.step#Adam.step         0.54%     754.529ms         1.05%        1.463s       4.181ms     924.661ms         0.67%        1.460s       4.172ms           350  
                                       aten::zeros_like         0.29%     406.377ms         1.09%        1.522s     180.922us     546.029ms         0.39%        1.454s     172.871us          8412  
                                                aten::t         0.29%     397.594ms         1.14%        1.588s      81.044us     590.545ms         0.43%        1.424s      72.672us         19600  
                                            aten::slice         0.71%     988.250ms         1.13%        1.573s      43.220us        1.139s         0.82%        1.343s      36.901us         36400  
                                           aten::linear         0.16%     217.893ms         0.82%        1.141s     271.644us     240.920ms         0.17%        1.143s     272.032us          4200  
                                 sync for each sub_iter         0.68%     939.929ms         0.71%     982.987ms     702.134us     955.501ms         0.69%     968.453ms     691.752us          1400  
                                            aten::zero_         0.31%     433.903ms         0.87%        1.208s      26.730us     450.726ms         0.33%     941.146ms      20.830us         45183  
                                          create frames         0.46%     637.079ms         0.63%     875.096ms     156.267us     734.985ms         0.53%     847.421ms     151.325us          5600  
                                       aten::empty_like         0.35%     489.541ms         0.71%     990.949ms      47.161us     594.180ms         0.43%     843.075ms      40.124us         21012  
                                        aten::transpose         0.35%     487.115ms         0.73%        1.022s      52.161us     638.564ms         0.46%     833.829ms      42.542us         19600  
                                          aten::reshape         0.42%     582.238ms         0.66%     917.538ms      43.692us     625.311ms         0.45%     763.882ms      36.375us         21000  
                                            aten::empty         0.64%     891.441ms         0.95%        1.321s      12.486us     742.638ms         0.54%     742.638ms       7.022us        105759  
                                          aten::dropout         0.07%     103.087ms         0.53%     735.780ms     175.186us     101.739ms         0.07%     710.458ms     169.157us          4200  
                                           aten::unbind         0.17%     235.819ms         0.47%     659.612ms     471.151us     285.874ms         0.21%     650.367ms     464.548us          1400  
                                               aten::mm         0.34%     472.324ms         0.51%     710.772ms     101.539us     646.918ms         0.47%     646.918ms      92.417us          7000  
                                    aten::empty_strided         0.49%     685.233ms         0.67%     933.090ms      18.509us     640.153ms         0.46%     640.153ms      12.698us         50412  
        autograd::engine::evaluate_function: TBackward0         0.06%      82.769ms         0.48%     667.430ms     158.912us     124.832ms         0.09%     625.770ms     148.993us          4200  
                                   aten::_fused_dropout         0.17%     230.763ms         0.44%     613.169ms     145.993us     315.352ms         0.23%     608.719ms     144.933us          4200  
                                       aten::as_strided         0.48%     670.548ms         0.84%        1.165s      13.424us     601.390ms         0.43%     601.390ms       6.928us         86806  
                                            aten::fill_         0.38%     534.099ms         0.48%     671.647ms      56.384us     595.115ms         0.43%     595.115ms      49.959us         11912  
                                            aten::addmm         0.24%     337.857ms         0.41%     573.300ms     136.500us     445.809ms         0.32%     588.603ms     140.144us          4200  
                                        aten::clamp_min         0.20%     280.513ms         0.40%     555.042ms      56.637us     336.878ms         0.24%     523.474ms      53.416us          9800  
                                             TBackward0         0.04%      54.623ms         0.39%     543.838ms     129.485us      92.497ms         0.07%     500.938ms     119.271us          4200  
                        torch::autograd::AccumulateGrad         0.09%     127.492ms         0.41%     577.100ms      68.702us     206.239ms         0.15%     492.573ms      58.640us          8400  
autograd::engine::evaluate_function: FusedDropoutBac...         0.05%      73.565ms         0.37%     512.664ms     183.094us     101.585ms         0.07%     485.215ms     173.291us          2800  
                                        aten::new_empty         0.18%     255.068ms         0.37%     515.744ms      46.049us     309.808ms         0.22%     443.871ms      39.631us         11200  
                                         aten::new_ones         0.07%      96.693ms         0.33%     459.441ms     109.391us     108.743ms         0.08%     432.760ms     103.038us          4200  
                                             aten::add_         0.21%     292.420ms         0.38%     525.654ms      41.738us     406.702ms         0.29%     406.702ms      32.293us         12594  
                                             aten::relu         0.07%      93.073ms         0.30%     417.881ms     149.243us      94.782ms         0.07%     402.926ms     143.902us          2800  
                                asign frame to nodeflow         0.25%     351.967ms         0.30%     422.596ms      75.464us     374.114ms         0.27%     397.136ms      70.917us          5600  
                                  FusedDropoutBackward0         0.03%      45.657ms         0.30%     410.825ms     146.723us      73.467ms         0.05%     383.630ms     137.011us          2800  
                                           aten::select         0.19%     266.987ms         0.30%     415.654ms      49.483us     320.051ms         0.23%     364.493ms      43.392us          8400  
                                             aten::item         0.19%     265.650ms         0.30%     416.711ms      49.608us     311.017ms         0.22%     361.513ms      43.037us          8400  
                                              aten::cat         0.04%      51.914ms         0.26%     355.344ms     253.817us      59.697ms         0.04%     345.664ms     246.903us          1400  
                                            fetch label         0.05%      71.234ms         0.24%     338.952ms     242.109us      87.268ms         0.06%     335.115ms     239.368us          1400  
                                              aten::div         0.17%     243.162ms         0.27%     370.646ms      40.730us     327.754ms         0.24%     327.754ms      36.017us          9100  
                                             aten::ones         0.13%     174.092ms         0.25%     342.636ms      81.580us     199.497ms         0.14%     324.017ms      77.147us          4200  
                               aten::cross_entropy_loss         0.03%      46.482ms         0.23%     314.491ms     224.636us      54.569ms         0.04%     311.200ms     222.286us          1400  
                                    aten::_masked_scale         0.08%     106.809ms         0.24%     336.425ms     120.152us     176.486ms         0.13%     310.163ms     110.772us          2800  
autograd::engine::evaluate_function: NllLossBackward...         0.03%      46.925ms         0.24%     329.430ms     235.307us      56.939ms         0.04%     300.211ms     214.436us          1400  
                                              aten::sum         0.14%     190.716ms         0.21%     286.904ms      68.310us     293.236ms         0.21%     293.236ms      69.818us          4200  
                                             aten::_cat         0.09%     129.544ms         0.21%     294.696ms     210.497us     158.780ms         0.11%     285.967ms     204.262us          1400  
     autograd::engine::evaluate_function: ReluBackward0         0.04%      60.081ms         0.22%     309.797ms     110.642us      85.043ms         0.06%     283.416ms     101.220us          2800  
                                              aten::mul         0.15%     209.366ms         0.26%     361.135ms      42.992us     276.518ms         0.20%     276.518ms      32.919us          8400  
                                       NllLossBackward0         0.02%      26.112ms         0.19%     258.357ms     184.541us      41.974ms         0.03%     243.272ms     173.766us          1400  
                     Optimizer.zero_grad#Adam.zero_grad         0.06%      80.038ms         0.18%     245.537ms     701.534us     101.970ms         0.07%     242.464ms     692.754us           350  
                                            aten::clamp         0.10%     140.432ms         0.17%     239.007ms      56.906us     148.987ms         0.11%     220.680ms      52.543us          4200  
                                aten::nll_loss_backward         0.05%      63.117ms         0.16%     215.983ms     154.274us      93.796ms         0.07%     201.298ms     143.784us          1400  
                                          ReluBackward0         0.04%      50.534ms         0.16%     222.974ms      79.634us      76.439ms         0.06%     198.373ms      70.847us          2800  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.03%      35.790ms         0.13%     179.841ms     128.458us      51.615ms         0.04%     163.256ms     116.611us          1400  
                                      aten::nll_loss_nd         0.02%      25.081ms         0.11%     153.174ms     109.410us      26.696ms         0.02%     152.312ms     108.794us          1400  
                                           aten::expand         0.08%     117.532ms         0.12%     162.587ms      38.711us     126.258ms         0.09%     142.794ms      33.999us          4200  
                                   aten::_reshape_alias         0.13%     177.628ms         0.17%     240.028ms      11.430us     138.571ms         0.10%     138.571ms       6.599us         21000  
                                             aten::mul_         0.07%      97.667ms         0.12%     173.336ms      41.270us     129.650ms         0.09%     129.650ms      30.869us          4200  
                                         aten::nll_loss         0.02%      24.721ms         0.09%     125.051ms      89.322us      27.781ms         0.02%     125.616ms      89.726us          1400  
                               aten::threshold_backward         0.07%      93.011ms         0.11%     146.969ms      52.489us     121.934ms         0.09%     121.934ms      43.548us          2800  
                                        aten::ones_like         0.03%      43.010ms         0.09%     126.431ms      90.308us      53.122ms         0.04%     118.883ms      84.916us          1400  
                                    LogSoftmaxBackward0         0.02%      28.622ms         0.09%     127.377ms      90.984us      45.028ms         0.03%     111.641ms      79.744us          1400  
                                           aten::narrow         0.03%      43.021ms         0.09%     120.846ms      86.319us      50.389ms         0.04%     108.795ms      77.711us          1400  
                                      aten::log_softmax         0.03%      45.281ms         0.08%     110.561ms      78.972us      54.085ms         0.04%     104.319ms      74.514us          1400  
                                 aten::nll_loss_forward         0.05%      63.310ms         0.07%      96.614ms      69.010us      89.042ms         0.06%      97.835ms      69.882us          1400  
                                             aten::sqrt         0.04%      60.276ms         0.07%      95.545ms      45.498us      76.960ms         0.06%      76.960ms      36.648us          2100  
                       aten::_log_softmax_backward_data         0.03%      47.234ms         0.06%      82.535ms      58.954us      66.613ms         0.05%      66.613ms      47.581us          1400  
                                         aten::addcdiv_         0.04%      48.735ms         0.06%      83.292ms      39.663us      64.218ms         0.05%      64.218ms      30.580us          2100  
                                         aten::addcmul_         0.04%      49.228ms         0.06%      83.288ms      39.661us      63.971ms         0.05%      63.971ms      30.462us          2100  
                              aten::_local_scalar_dense         0.04%      53.436ms         0.07%     101.720ms      12.110us      50.496ms         0.04%      50.496ms       6.011us          8400  
                                             aten::view         0.04%      58.661ms         0.07%     103.013ms      24.527us      48.998ms         0.04%      48.998ms      11.666us          4200  
                                     aten::_log_softmax         0.02%      32.992ms         0.04%      50.107ms      35.791us      44.436ms         0.03%      44.436ms      31.740us          1400  
                                          aten::resize_         0.04%      54.641ms         0.06%      77.663ms      11.095us      44.290ms         0.03%      44.290ms       6.327us          7000  
                                     aten::resolve_conj         0.03%      47.874ms         0.06%      84.314ms      10.037us      37.974ms         0.03%      37.974ms       4.521us          8400  
                                      aten::resolve_neg         0.03%      45.958ms         0.06%      78.813ms       9.383us      37.246ms         0.03%      37.246ms       4.434us          8400  
                aten::_has_compatible_shallow_copy_type         0.02%      31.565ms         0.04%      49.806ms       8.894us      23.034ms         0.02%      23.034ms       4.113us          5600  
                                             aten::set_         0.01%      16.817ms         0.02%      28.337ms      20.212us      16.061ms         0.01%      16.061ms      11.456us          1402  
                                         create sampler         0.01%      13.469ms         0.01%      14.173ms       1.417ms      13.732ms         0.01%      14.127ms       1.413ms            10  
                                          aten::detach_         0.00%     173.000us         0.00%     280.000us      28.000us     197.000us         0.00%     237.000us      23.700us            10  
                                           aten::detach         0.00%      73.000us         0.00%     287.000us      47.833us     146.000us         0.00%     231.000us      38.500us             6  
                                                 detach         0.00%      76.000us         0.00%     149.000us      24.833us      85.000us         0.00%      85.000us      14.167us             6  
                                                detach_         0.00%      61.000us         0.00%      84.000us       8.400us      40.000us         0.00%      40.000us       4.000us            10  
                                        cudaEventCreate         1.50%        2.086s         1.50%        2.086s       1.136us       0.000us         0.00%       0.000us       0.000us       1836588  
                                        cudaEventRecord         2.40%        3.333s         2.40%        3.333s       1.807us       0.000us         0.00%       0.000us       0.000us       1844209  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 139.145s
Self CUDA time total: 138.413s

2023-04-05 06:26:07,906 - INFO - Rank 0 | wait sampler total time: 0.0653231143951416, total sub_iters: 140, avg sub_iter time:0.0004665936742510114
