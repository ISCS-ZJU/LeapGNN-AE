2023-04-06 06:39:43,994 - INFO - Rank 0 | Client Args: Namespace(dataset='./dist/repgnn_data/ogbn_products0/', num_gpu=1, sampling='10-10', hidden_size=256, n_classes=6, batch_size=8000, dropout=0.5, lr=0.03, weight_decay=0, model_name='gcn', epoch=1, num_worker=1, cache_size=0, ckpt_path='/dev/shm', seed=None, log=True, dist_url='tcp://10.214.241.227:23457', world_size=4, rank=0, gpu=0, grpc_port='10.214.241.227:18112', distributed=True)
2023-04-06 06:39:51,121 - INFO - Rank 0 | Added key: store_based_barrier_key:1 to store for rank: 0
2023-04-06 06:39:51,142 - INFO - Rank 0 | Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
2023-04-06 06:39:51,142 - INFO - Rank 0 | Using 4 distributed GPUs in total for training...
2023-04-06 06:40:04,562 - INFO - Rank 0 | n_sub_batches:397855
2023-04-06 06:40:16,501 - INFO - Rank 0 | Reducer buckets have been rebuilt in this iteration.
2023-04-06 06:44:49,820 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 0 on rank 0: 17437734 / 104153835 = 0.16742287021884503
2023-04-06 06:44:49,822 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 16.533 s, total_remote_feats_gather_time = 96.229 s
2023-04-06 06:44:49,822 - INFO - Rank 0 | => cur_epoch 0 finished on rank 0
2023-04-06 06:45:58,930 - INFO - Rank 0 | -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      total epochs time         3.07%        8.820s        99.43%      285.385s      285.385s        8.837s         3.08%      285.383s      285.383s             1  
                                             fetch feat         0.33%     958.934ms        69.12%      198.380s     991.902ms        1.004s         0.35%      198.377s     991.887ms           200  
                           fetch feat from cache server        62.70%      179.961s        65.46%      187.879s     234.849ms      180.256s        62.83%      187.874s     234.842ms           800  
                                            gpu-compute        17.10%       49.083s        25.93%       74.431s     297.725ms       49.081s        17.11%       74.429s     297.717ms           250  
                        DistributedDataParallel.forward         7.23%       20.747s         8.70%       24.978s     124.889ms       21.433s         7.47%       24.977s     124.883ms           200  
                                            aten::copy_         2.45%        7.044s         4.07%       11.668s     663.334us       11.562s         4.03%       11.562s     657.319us         17590  
                             move feats from CPU to GPU         0.65%        1.858s         2.22%        6.360s       7.950ms        1.871s         0.65%        6.355s       7.944ms           800  
                                               aten::to         0.04%     120.252ms         1.87%        5.354s       1.115ms     145.559ms         0.05%        5.319s       1.108ms          4802  
                                         aten::_to_copy         0.08%     226.719ms         1.81%        5.204s       1.131ms     282.403ms         0.10%        5.173s       1.125ms          4600  
                                         model transfer         0.85%        2.434s         1.13%        3.233s      16.167ms        2.485s         0.87%        3.232s      16.159ms           200  
                                          create frames         0.82%        2.368s         0.84%        2.415s       3.018ms        2.387s         0.83%        2.410s       3.013ms           800  
                                             CopyReduce         0.13%     363.379ms         0.50%        1.437s       2.396ms        1.328s         0.46%        1.507s       2.512ms           600  
                                            aten::index         0.37%        1.071s         0.41%        1.177s     840.384us        1.090s         0.38%        1.156s     825.728us          1400  
                                            aten::slice         0.21%     593.873ms         0.33%     939.332ms      37.621us     681.598ms         0.24%     798.109ms      31.965us         24968  
autograd::engine::evaluate_function: CopyReduceBackw...         0.00%      11.953ms         0.18%     524.115ms       1.310ms      16.101ms         0.01%     520.363ms       1.301ms           400  
                                     CopyReduceBackward         0.07%     188.764ms         0.18%     508.281ms       1.271ms     451.192ms         0.16%     504.262ms       1.261ms           400  
    autograd::engine::evaluate_function: AddmmBackward0         0.01%      23.819ms         0.12%     354.818ms     591.363us      25.168ms         0.01%     451.762ms     752.937us           600  
                                            get nf_nids         0.06%     176.789ms         0.16%     447.145ms       2.236ms     204.905ms         0.07%     445.713ms       2.229ms           200  
                                          aten::reshape         0.10%     289.796ms         0.19%     553.944ms      44.020us     297.108ms         0.10%     404.461ms      32.141us         12584  
                                         AddmmBackward0         0.01%      22.389ms         0.09%     261.011ms     435.018us      34.712ms         0.01%     331.424ms     552.373us           600  
                                            aten::zeros         0.06%     171.096ms         0.11%     302.385ms      63.620us     214.542ms         0.07%     270.398ms      56.890us          4753  
                                           aten::linear         0.01%      33.437ms         0.07%     194.675ms     324.458us      27.269ms         0.01%     255.211ms     425.352us           600  
                               Optimizer.step#Adam.step         0.04%     109.414ms         0.08%     230.922ms       4.618ms     141.905ms         0.05%     230.498ms       4.610ms            50  
                                               aten::mm         0.03%      78.424ms         0.04%     121.464ms     121.464us     227.121ms         0.08%     227.121ms     227.121us          1000  
                                          aten::dropout         0.01%      16.577ms         0.04%     128.275ms     213.792us      15.919ms         0.01%     225.874ms     376.457us           600  
                                       aten::zeros_like         0.02%      60.678ms         0.08%     223.615ms     184.501us      79.406ms         0.03%     213.216ms     175.921us          1212  
                                   aten::_fused_dropout         0.01%      40.593ms         0.04%     108.519ms     180.865us     160.743ms         0.06%     209.955ms     349.925us           600  
                                            aten::addmm         0.02%      67.152ms         0.04%     107.132ms     178.553us     173.272ms         0.06%     192.072ms     320.120us           600  
                                       aten::as_strided         0.08%     225.641ms         0.13%     359.456ms      11.172us     169.030ms         0.06%     169.030ms       5.254us         32174  
                                 sync for each sub_iter         0.06%     158.887ms         0.06%     164.227ms     821.135us     161.135ms         0.06%     162.634ms     813.170us           200  
autograd::engine::evaluate_function: torch::autograd...         0.02%      64.247ms         0.09%     248.199ms     206.833us      51.938ms         0.02%     158.287ms     131.906us          1200  
                                            aten::zero_         0.02%      64.129ms         0.06%     183.534ms      28.389us      63.301ms         0.02%     142.493ms      22.041us          6465  
                                            fetch label         0.00%      11.967ms         0.05%     140.865ms     704.325us      14.666ms         0.01%     140.234ms     701.170us           200  
                                                aten::t         0.02%      59.336ms         0.07%     204.828ms      73.153us      61.216ms         0.02%     135.375ms      48.348us          2800  
                                       aten::empty_like         0.03%      73.164ms         0.05%     154.834ms      51.406us      89.898ms         0.03%     133.656ms      44.375us          3012  
                                            aten::empty         0.05%     151.829ms         0.08%     221.037ms      14.625us     125.126ms         0.04%     125.126ms       8.279us         15114  
                                        aten::clamp_min         0.01%      42.535ms         0.03%      88.968ms      63.549us      68.162ms         0.02%     124.397ms      88.855us          1400  
                                    aten::empty_strided         0.04%     120.466ms         0.06%     165.083ms      22.890us     119.326ms         0.04%     119.326ms      16.545us          7212  
                                   aten::_reshape_alias         0.05%     130.133ms         0.06%     172.031ms      13.671us     107.353ms         0.04%     107.353ms       8.531us         12584  
                                     train data prepare         0.04%     106.604ms         0.04%     106.633ms     106.633ms     106.623ms         0.04%     106.627ms     106.627ms             1  
autograd::engine::evaluate_function: FusedDropoutBac...         0.00%      10.368ms         0.03%      74.396ms     185.990us       9.552ms         0.00%     101.413ms     253.532us           400  
                                              aten::div         0.01%      37.705ms         0.02%      60.137ms      46.259us     100.579ms         0.04%     100.579ms      77.368us          1300  
                                  FusedDropoutBackward0         0.00%       7.001ms         0.02%      60.210ms     150.525us       8.107ms         0.00%      91.861ms     229.653us           400  
                                            aten::fill_         0.03%      84.737ms         0.04%     109.867ms      72.663us      91.032ms         0.03%      91.032ms      60.206us          1512  
                                           aten::unbind         0.01%      31.299ms         0.03%      92.803ms     464.015us      38.754ms         0.01%      90.666ms     453.330us           200  
                                              aten::sum         0.01%      31.842ms         0.02%      49.784ms      82.973us      90.462ms         0.03%      90.462ms     150.770us           600  
autograd::engine::evaluate_function: NllLossBackward...         0.01%      37.801ms         0.03%      94.820ms     474.100us      38.575ms         0.01%      86.515ms     432.575us           200  
                                asign frame to nodeflow         0.03%      77.368ms         0.03%      89.412ms     111.765us      81.704ms         0.03%      85.059ms     106.324us           800  
                                    aten::_masked_scale         0.01%      15.889ms         0.02%      49.293ms     123.233us      63.743ms         0.02%      83.754ms     209.385us           400  
     autograd::engine::evaluate_function: ReluBackward0         0.00%       8.723ms         0.02%      46.130ms     115.325us       5.342ms         0.00%      78.694ms     196.735us           400  
                                        aten::transpose         0.02%      46.336ms         0.04%     121.407ms      43.360us      54.331ms         0.02%      74.159ms      26.485us          2800  
                                          ReluBackward0         0.00%       7.434ms         0.01%      33.686ms      84.215us       5.796ms         0.00%      73.352ms     183.380us           400  
                               aten::threshold_backward         0.00%      14.156ms         0.01%      22.715ms      56.788us      67.556ms         0.02%      67.556ms     168.890us           400  
                                             aten::relu         0.01%      14.748ms         0.02%      65.094ms     162.735us       3.350ms         0.00%      66.303ms     165.757us           400  
                               aten::cross_entropy_loss         0.00%       6.926ms         0.02%      52.410ms     262.050us       8.423ms         0.00%      65.291ms     326.455us           200  
                                        aten::new_empty         0.01%      37.693ms         0.03%      82.735ms      51.709us      39.281ms         0.01%      62.811ms      39.257us          1600  
                        torch::autograd::AccumulateGrad         0.01%      18.667ms         0.03%      91.735ms      76.446us      23.868ms         0.01%      62.591ms      52.159us          1200  
                                             aten::add_         0.02%      44.365ms         0.03%      84.366ms      47.027us      57.900ms         0.02%      57.900ms      32.274us          1794  
        autograd::engine::evaluate_function: TBackward0         0.00%      11.219ms         0.03%      74.027ms     123.378us      15.001ms         0.01%      55.401ms      92.335us           600  
                                           aten::select         0.01%      35.695ms         0.02%      59.428ms      49.523us      45.300ms         0.02%      51.912ms      43.260us          1200  
                                             aten::item         0.01%      35.541ms         0.02%      58.357ms      48.631us      42.273ms         0.01%      50.849ms      42.374us          1200  
                                              aten::cat         0.00%       7.501ms         0.02%      50.757ms     253.785us       8.651ms         0.00%      49.481ms     247.405us           200  
                                       NllLossBackward0         0.00%       5.101ms         0.02%      48.351ms     241.755us       5.685ms         0.00%      47.940ms     239.700us           200  
                                aten::nll_loss_backward         0.00%      11.817ms         0.01%      40.590ms     202.950us      21.121ms         0.01%      42.255ms     211.275us           200  
                     Optimizer.zero_grad#Adam.zero_grad         0.00%      13.528ms         0.01%      41.615ms     832.300us      17.089ms         0.01%      41.086ms     821.720us            50  
                                             aten::_cat         0.01%      18.391ms         0.01%      42.056ms     210.280us      22.748ms         0.01%      40.830ms     204.150us           200  
                                      aten::nll_loss_nd         0.00%       3.973ms         0.01%      27.068ms     135.340us       4.176ms         0.00%      40.410ms     202.050us           200  
                                             TBackward0         0.00%       7.572ms         0.02%      56.326ms      93.877us      10.486ms         0.00%      40.400ms      67.333us           600  
                                         aten::nll_loss         0.00%       3.936ms         0.01%      22.646ms     113.230us       4.103ms         0.00%      36.234ms     181.170us           200  
                                         aten::new_ones         0.01%      15.389ms         0.03%      77.350ms     128.917us       8.659ms         0.00%      35.892ms      59.820us           600  
                                              aten::mul         0.01%      33.050ms         0.02%      55.803ms      46.502us      33.949ms         0.01%      33.949ms      28.291us          1200  
                                 aten::nll_loss_forward         0.00%       9.744ms         0.01%      18.235ms      91.175us      30.748ms         0.01%      32.131ms     160.655us           200  
                                             aten::ones         0.01%      26.619ms         0.02%      58.109ms      96.848us      14.914ms         0.01%      27.233ms      45.388us           600  
                                            aten::clamp         0.01%      23.015ms         0.01%      40.777ms      67.962us      17.161ms         0.01%      27.046ms      45.077us           600  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%       5.151ms         0.01%      27.526ms     137.630us       8.318ms         0.00%      25.440ms     127.200us           200  
                                             aten::mul_         0.01%      14.890ms         0.01%      26.386ms      43.977us      20.235ms         0.01%      20.235ms      33.725us           600  
                                           aten::expand         0.01%      17.345ms         0.01%      25.277ms      42.128us      15.688ms         0.01%      18.800ms      31.333us           600  
                                         create sampler         0.01%      17.615ms         0.01%      17.715ms      17.715ms      17.666ms         0.01%      17.711ms      17.711ms             1  
                                    LogSoftmaxBackward0         0.00%       4.618ms         0.01%      19.048ms      95.240us       6.754ms         0.00%      17.122ms      85.610us           200  
                                      aten::log_softmax         0.00%       6.853ms         0.01%      17.407ms      87.035us       8.244ms         0.00%      16.458ms      82.290us           200  
                                           aten::narrow         0.00%       5.882ms         0.01%      16.548ms      82.740us       6.987ms         0.00%      15.332ms      76.660us           200  
                                        aten::ones_like         0.00%       6.073ms         0.01%      18.547ms      92.735us       5.784ms         0.00%      15.240ms      76.200us           200  
                                             aten::sqrt         0.00%       9.288ms         0.01%      15.439ms      51.463us      12.510ms         0.00%      12.510ms      41.700us           300  
                                         aten::addcmul_         0.00%       7.690ms         0.01%      19.941ms      66.470us      10.619ms         0.00%      10.619ms      35.397us           300  
                                         aten::addcdiv_         0.00%       7.806ms         0.01%      14.913ms      49.710us      10.554ms         0.00%      10.554ms      35.180us           300  
                       aten::_log_softmax_backward_data         0.00%       7.401ms         0.00%      12.431ms      62.155us      10.368ms         0.00%      10.368ms      51.840us           200  
                              aten::_local_scalar_dense         0.00%       7.666ms         0.01%      15.895ms      13.246us       8.576ms         0.00%       8.576ms       7.147us          1200  
                                     aten::_log_softmax         0.00%       5.672ms         0.00%       8.205ms      41.025us       7.394ms         0.00%       7.394ms      36.970us           200  
                                      aten::resolve_neg         0.00%       7.102ms         0.01%      14.411ms      12.009us       5.829ms         0.00%       5.829ms       4.857us          1200  
                                          aten::resize_         0.00%       8.930ms         0.00%      12.399ms      12.399us       5.732ms         0.00%       5.732ms       5.732us          1000  
                                     aten::resolve_conj         0.00%       7.105ms         0.00%      13.228ms      11.023us       5.585ms         0.00%       5.585ms       4.654us          1200  
                                             aten::view         0.00%       8.757ms         0.01%      14.462ms      24.103us       4.708ms         0.00%       4.708ms       7.847us           600  
                aten::_has_compatible_shallow_copy_type         0.00%       4.630ms         0.00%       7.230ms       9.037us       3.293ms         0.00%       3.293ms       4.116us           800  
                                             aten::set_         0.00%       2.652ms         0.00%       4.255ms      21.064us     893.000us         0.00%     893.000us       4.421us           202  
                                           aten::detach         0.00%      68.000us         0.00%     264.000us      44.000us     124.000us         0.00%     195.000us      32.500us             6  
                                                 detach         0.00%      73.000us         0.00%     125.000us      20.833us      71.000us         0.00%      71.000us      11.833us             6  
                                          aten::detach_         0.00%      17.000us         0.00%      29.000us      29.000us      20.000us         0.00%      25.000us      25.000us             1  
                                                detach_         0.00%       8.000us         0.00%      10.000us      10.000us       5.000us         0.00%       5.000us       5.000us             1  
                                        cudaEventCreate         0.14%     398.000ms         0.14%     398.010ms       0.998us       0.000us         0.00%       0.000us       0.000us        398694  
                                        cudaEventRecord         0.27%     778.637ms         0.27%     778.637ms       1.947us       0.000us         0.00%       0.000us       0.000us        399967  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 287.025s
Self CUDA time total: 286.917s

2023-04-06 06:45:58,930 - INFO - Rank 0 | wait sampler total time: 8.739659309387207, total sub_iters: 200, avg sub_iter time:0.043698296546936036
