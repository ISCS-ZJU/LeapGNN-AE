2023-03-18 12:59:58,880 - INFO - Rank 1 | Client Args: Namespace(dataset='./dist/repgnn_data/ogbn_products0/', sampling='2', hidden_size=256, n_classes=60, batch_size=256, dropout=0.2, lr=0.03, weight_decay=0, model_name='gcn', epoch=1, num_worker=1, cache_size=0, seed=None, log=True, dist_url='tcp://10.214.242.140:23456', world_size=2, rank=1, gpu=0, grpc_port='10.214.243.19:18110', mlp_layers=1, block='res+', conv='gen', gcn_aggr='max', norm='batch', t=1.0, p=1.0, y=0.0, learn_t=False, learn_p=False, learn_y=False, msg_norm=False, learn_msg_scale=False, distributed=True)
2023-03-18 12:59:59,909 - INFO - Rank 1 | Added key: store_based_barrier_key:1 to store for rank: 1
2023-03-18 12:59:59,920 - INFO - Rank 1 | Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
2023-03-18 12:59:59,921 - INFO - Rank 1 | Using 2 distributed GPUs in total for training...
2023-03-18 13:00:33,249 - INFO - Rank 1 | Reducer buckets have been rebuilt in this iteration.
2023-03-18 13:03:45,981 - INFO - Rank 1 | rank: 1, iter_num: 3110
2023-03-18 13:03:45,982 - INFO - Rank 1 | Epoch miss rate ( miss_num/try_num ) for epoch 0 on rank 1: 4710695 / 9523381 = 0.49464523156219414
2023-03-18 13:03:45,983 - INFO - Rank 1 | Up to now, total_local_feats_gather_time = 0.07100000000000001 s, total_remote_feats_gather_time = 29.514 s
2023-03-18 13:03:45,983 - INFO - Rank 1 | => cur_epoch 0 finished on rank 1
2023-03-18 13:11:58,601 - INFO - Rank 1 | -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      total epochs time         3.72%        8.235s        94.65%      209.768s      209.768s        8.406s         3.81%      209.767s      209.767s             1  
                        gpu-compute with optimizer.step         2.47%        5.481s        59.07%      130.911s      42.094ms        5.696s         2.58%      130.887s      42.086ms          3110  
                                           DDP backward        44.53%       98.691s        44.65%       98.963s      31.821ms       98.752s        44.78%       98.944s      31.815ms          3110  
                                             fetch feat         0.53%        1.172s        31.22%       69.187s      22.246ms        1.855s         0.84%       69.158s      22.237ms          3110  
                           fetch feat from cache server        24.56%       54.426s        25.92%       57.437s       6.156ms       54.833s        24.86%       57.369s       6.149ms          9330  
                                            DDP forward         0.06%     142.640ms         9.39%       20.819s       6.694ms     226.151ms         0.10%       20.796s       6.687ms          3110  
                        DistributedDataParallel.forward         4.15%        9.205s         9.23%       20.462s       6.579ms       10.725s         4.86%       20.438s       6.572ms          3110  
                                             CopyReduce         0.96%        2.137s         2.51%        5.555s     893.103us        4.113s         1.86%        5.492s     882.997us          6220  
                                            aten::copy_         1.13%        2.511s         1.86%        4.118s      82.752us        3.739s         1.70%        3.739s      75.128us         49764  
                                   DDP optimizer.step()         0.05%     106.622ms         1.60%        3.537s       1.137ms     158.070ms         0.07%        3.519s       1.132ms          3110  
                                            get nf_nids         0.59%        1.298s         1.53%        3.396s       1.092ms        1.673s         0.76%        3.373s       1.085ms          3110  
                               Optimizer.step#Adam.step         0.35%     786.474ms         1.47%        3.258s       1.048ms        1.360s         0.62%        3.240s       1.042ms          3110  
    autograd::engine::evaluate_function: AddmmBackward0         0.09%     208.315ms         1.40%        3.092s     497.115us     348.202ms         0.16%        3.037s     488.286us          6220  
                                            aten::zeros         0.40%     876.233ms         1.49%        3.313s      44.387us        1.802s         0.82%        2.771s      37.120us         74642  
                                               aten::to         0.11%     240.714ms         1.31%        2.897s     103.508us     380.713ms         0.17%        2.718s      97.099us         27991  
                             move feats from CPU to GPU         0.20%     441.404ms         1.19%        2.635s     282.383us     655.149ms         0.30%        2.560s     274.355us          9330  
                                         aten::_to_copy         0.15%     322.881ms         1.12%        2.486s      99.915us     617.029ms         0.28%        2.337s      93.938us         24880  
autograd::engine::evaluate_function: torch::autograd...         0.28%     609.571ms         1.08%        2.402s     193.114us     981.305ms         0.44%        2.283s     183.488us         12440  
                                         AddmmBackward0         0.07%     164.534ms         1.03%        2.274s     365.556us     397.421ms         0.18%        2.217s     356.482us          6220  
autograd::engine::evaluate_function: CopyReduceBackw...         0.04%      87.896ms         1.00%        2.212s     711.125us     122.832ms         0.06%        2.182s     701.682us          3110  
                                     CopyReduceBackward         0.58%        1.274s         0.94%        2.090s     672.068us        1.785s         0.81%        2.059s     662.186us          3110  
                                                aten::t         0.19%     415.359ms         0.89%        1.977s      70.638us     658.450ms         0.30%        1.747s      62.399us         27990  
                                            aten::empty         0.82%        1.822s         1.38%        3.054s      14.656us        1.645s         0.75%        1.645s       7.895us        208381  
                                            aten::index         0.25%     557.040ms         0.68%        1.510s      97.083us     829.741ms         0.38%        1.385s      89.064us         15550  
                                            aten::slice         0.28%     624.308ms         0.72%        1.595s      32.064us     888.501ms         0.40%        1.220s      24.530us         49755  
                                          create frames         0.30%     662.118ms         0.56%        1.235s     132.377us     911.907ms         0.41%        1.165s     124.851us          9330  
                                           aten::linear         0.03%      69.638ms         0.52%        1.143s     183.832us     117.893ms         0.05%        1.106s     177.824us          6220  
                                        aten::transpose         0.25%     552.591ms         0.60%        1.324s      47.305us     822.722ms         0.37%        1.088s      38.875us         27990  
                                       aten::as_strided         0.48%        1.055s         0.91%        2.015s      15.389us        1.036s         0.47%        1.036s       7.907us        130968  
                                          aten::reshape         0.19%     416.652ms         0.59%        1.312s      38.348us     556.512ms         0.25%     944.900ms      27.621us         34210  
                                            aten::zero_         0.29%     649.400ms         0.69%        1.528s      16.945us     647.906ms         0.29%     941.986ms      10.444us         90196  
                                asign frame to nodeflow         0.36%     789.117ms         0.46%        1.013s     108.569us     874.213ms         0.40%     938.363ms     100.575us          9330  
                                               aten::mm         0.29%     651.753ms         0.45%        1.003s     107.545us     920.264ms         0.42%     920.264ms      98.635us          9330  
        autograd::engine::evaluate_function: TBackward0         0.05%     115.111ms         0.44%     972.216ms     156.305us     166.581ms         0.08%     885.314ms     142.333us          6220  
                                          aten::dropout         0.04%      80.448ms         0.41%     917.860ms     147.566us     121.590ms         0.06%     854.862ms     137.438us          6220  
                                             aten::add_         0.28%     624.376ms         0.49%        1.087s      29.138us     840.372ms         0.38%     840.372ms      22.520us         37316  
                                            fetch label         0.06%     123.367ms         0.38%     844.155ms     271.432us     185.991ms         0.08%     826.563ms     265.776us          3110  
                                   DDP optimizer.zero()         0.03%      77.253ms         0.36%     795.695ms     255.850us     124.838ms         0.06%     778.458ms     250.308us          3110  
                                   aten::_fused_dropout         0.09%     208.890ms         0.35%     769.411ms     123.700us     363.258ms         0.16%     733.272ms     117.889us          6220  
                                            aten::addmm         0.21%     457.671ms         0.34%     752.324ms     120.952us     626.068ms         0.28%     731.339ms     117.579us          6220  
                                             TBackward0         0.03%      69.389ms         0.35%     771.301ms     124.003us     128.643ms         0.06%     718.733ms     115.552us          6220  
                        torch::autograd::AccumulateGrad         0.08%     172.049ms         0.37%     823.694ms      66.213us     293.539ms         0.13%     708.424ms      56.947us         12440  
                                     DDP calculate loss         0.06%     143.078ms         0.31%     679.880ms     218.611us     194.296ms         0.09%     663.180ms     213.241us          3110  
                                       aten::empty_like         0.08%     181.812ms         0.33%     727.413ms      38.966us     316.251ms         0.14%     610.531ms      32.705us         18668  
autograd::engine::evaluate_function: FusedDropoutBac...         0.04%      79.555ms         0.29%     638.200ms     205.209us     107.479ms         0.05%     607.829ms     195.443us          3110  
                                    aten::empty_strided         0.28%     630.427ms         0.38%     841.113ms      20.800us     599.124ms         0.27%     599.124ms      14.816us         40438  
autograd::engine::evaluate_function: NllLossBackward...         0.04%      88.433ms         0.29%     639.933ms     205.766us     113.635ms         0.05%     582.445ms     187.281us          3110  
                                              aten::div         0.20%     436.868ms         0.31%     685.905ms      31.507us     574.769ms         0.26%     574.769ms      26.402us         21770  
                                           aten::unbind         0.03%      72.399ms         0.26%     565.516ms     181.838us     184.133ms         0.08%     545.287ms     175.333us          3110  
                     Optimizer.zero_grad#Adam.zero_grad         0.05%     114.293ms         0.25%     560.270ms     180.151us     191.121ms         0.09%     543.700ms     174.823us          3110  
                                  FusedDropoutBackward0         0.06%     127.438ms         0.24%     528.038ms     169.787us     160.969ms         0.07%     500.350ms     160.884us          3110  
                                            aten::fill_         0.16%     355.769ms         0.28%     623.625ms      25.061us     492.224ms         0.22%     492.224ms      19.781us         24884  
                                       NllLossBackward0         0.02%      49.020ms         0.23%     501.442ms     161.235us      83.347ms         0.04%     468.810ms     150.743us          3110  
                                        aten::clamp_min         0.08%     178.170ms         0.23%     520.322ms      41.827us     277.861ms         0.13%     455.886ms      36.647us         12440  
                               aten::cross_entropy_loss         0.01%      33.184ms         0.21%     469.928ms     151.102us      56.964ms         0.03%     454.856ms     146.256us          3110  
                                             aten::mul_         0.15%     337.906ms         0.27%     589.826ms      23.707us     446.236ms         0.20%     446.236ms      17.936us         24880  
                                        aten::new_empty         0.07%     151.153ms         0.25%     550.922ms      35.429us     235.836ms         0.11%     444.514ms      28.586us         15550  
                                         aten::new_ones         0.03%      61.470ms         0.22%     491.154ms      78.964us      83.722ms         0.04%     440.588ms      70.834us          6220  
                                              aten::mul         0.13%     294.103ms         0.23%     509.419ms      40.950us     388.918ms         0.18%     388.918ms      31.264us         12440  
                                   aten::_reshape_alias         0.16%     346.471ms         0.27%     606.628ms      17.732us     388.388ms         0.18%     388.388ms      11.353us         34210  
                                aten::nll_loss_backward         0.06%     123.216ms         0.19%     417.826ms     134.349us     179.845ms         0.08%     385.463ms     123.943us          3110  
                                              aten::sum         0.11%     246.950ms         0.17%     373.749ms      60.088us     384.652ms         0.17%     384.652ms      61.841us          6220  
                                             aten::item         0.07%     161.419ms         0.22%     498.088ms      26.203us     249.880ms         0.11%     373.301ms      19.638us         19009  
                                           aten::select         0.07%     158.062ms         0.21%     474.590ms      24.967us     263.635ms         0.12%     361.154ms      18.999us         19009  
                                             aten::ones         0.03%      73.783ms         0.18%     390.173ms      62.729us     135.725ms         0.06%     356.866ms      57.374us          6220  
                                    aten::_masked_scale         0.05%     109.217ms         0.17%     369.992ms     118.968us     178.093ms         0.08%     339.381ms     109.126us          3110  
                                              aten::cat         0.02%      39.921ms         0.16%     349.839ms     112.525us      57.297ms         0.03%     330.377ms     106.265us          3109  
     autograd::engine::evaluate_function: ReluBackward0         0.03%      66.467ms         0.15%     339.077ms     109.028us      94.970ms         0.04%     310.381ms      99.801us          3110  
                                             aten::sqrt         0.09%     206.220ms         0.17%     371.006ms      29.824us     302.099ms         0.14%     302.099ms      24.284us         12440  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.03%      65.608ms         0.15%     329.753ms     106.030us      95.997ms         0.04%     301.291ms      96.878us          3110  
                                            aten::clamp         0.06%     125.621ms         0.14%     313.139ms      50.344us     151.839ms         0.07%     279.581ms      44.949us          6220  
                                             aten::relu         0.02%      49.571ms         0.13%     290.982ms      93.563us      64.547ms         0.03%     273.111ms      87.817us          3110  
                                             aten::_cat         0.03%      74.423ms         0.13%     291.789ms      93.853us     131.435ms         0.06%     273.080ms      87.835us          3109  
                                      aten::nll_loss_nd         0.01%      25.195ms         0.11%     233.560ms      75.100us      31.871ms         0.01%     222.731ms      71.618us          3110  
                                         aten::addcmul_         0.08%     166.586ms         0.13%     290.023ms      23.314us     218.121ms         0.10%     218.121ms      17.534us         12440  
                                         aten::addcdiv_         0.08%     167.917ms         0.13%     285.832ms      22.977us     217.807ms         0.10%     217.807ms      17.509us         12440  
                                          ReluBackward0         0.02%      51.226ms         0.11%     242.834ms      78.082us      83.527ms         0.04%     215.411ms      69.264us          3110  
                                    LogSoftmaxBackward0         0.02%      54.460ms         0.11%     234.878ms      75.523us      85.376ms         0.04%     205.294ms      66.011us          3110  
                                         aten::nll_loss         0.01%      24.421ms         0.09%     197.168ms      63.398us      29.608ms         0.01%     190.860ms      61.370us          3110  
                                        aten::ones_like         0.01%      27.984ms         0.09%     194.930ms      62.678us      51.734ms         0.02%     178.015ms      57.240us          3110  
                                      aten::log_softmax         0.02%      33.392ms         0.09%     190.156ms      61.143us      60.934ms         0.03%     175.161ms      56.322us          3110  
                                 aten::nll_loss_forward         0.03%      74.685ms         0.07%     162.929ms      52.389us     136.844ms         0.06%     161.252ms      51.850us          3110  
                               aten::threshold_backward         0.05%     100.319ms         0.07%     160.121ms      51.486us     131.884ms         0.06%     131.884ms      42.406us          3110  
                              aten::_local_scalar_dense         0.06%     127.973ms         0.11%     233.569ms      12.287us     123.421ms         0.06%     123.421ms       6.493us         19009  
                       aten::_log_softmax_backward_data         0.04%      88.387ms         0.07%     148.844ms      47.860us     119.918ms         0.05%     119.918ms      38.559us          3110  
                                           aten::expand         0.02%      51.240ms         0.06%     138.301ms      22.235us      76.591ms         0.03%     105.271ms      16.925us          6220  
                                     aten::_log_softmax         0.04%      77.840ms         0.05%     117.008ms      37.623us     101.325ms         0.05%     101.325ms      32.580us          3110  
                                           aten::narrow         0.01%      26.482ms         0.05%     119.524ms      38.445us      41.216ms         0.02%     100.367ms      32.283us          3109  
                                             aten::view         0.04%      86.412ms         0.08%     175.386ms      28.197us      86.967ms         0.04%      86.967ms      13.982us          6220  
                                     aten::resolve_conj         0.05%     102.576ms         0.09%     189.794ms      12.206us      84.237ms         0.04%      84.237ms       5.418us         15549  
                                      aten::resolve_neg         0.04%      98.731ms         0.08%     180.233ms      11.591us      80.123ms         0.04%      80.123ms       5.153us         15549  
                                          aten::resize_         0.04%      99.149ms         0.07%     149.053ms      11.981us      79.673ms         0.04%      79.673ms       6.404us         12441  
                aten::_has_compatible_shallow_copy_type         0.03%      64.431ms         0.06%     142.926ms      15.319us      55.961ms         0.03%      55.961ms       5.998us          9330  
                                             aten::set_         0.02%      35.895ms         0.03%      62.797ms      20.179us      35.913ms         0.02%      35.913ms      11.540us          3112  
                                     train data prepare         0.01%      32.832ms         0.01%      32.851ms      32.851ms      32.840ms         0.01%      32.845ms      32.845ms             1  
                                         aten::randperm         0.01%      11.379ms         0.01%      22.745ms      11.373ms      11.400ms         0.01%      22.730ms      11.365ms             2  
                                       aten::zeros_like         0.00%     133.000us         0.00%       1.334ms     166.750us     297.000us         0.00%       1.242ms     155.250us             8  
                                           aten::detach         0.00%      50.000us         0.00%     191.000us      47.750us      90.000us         0.00%     151.000us      37.750us             4  
                                                 detach         0.00%      61.000us         0.00%     101.000us      25.250us      61.000us         0.00%      61.000us      15.250us             4  
                                    aten::scalar_tensor         0.00%      10.000us         0.00%      12.000us      12.000us       8.000us         0.00%       8.000us       8.000us             1  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 221.629s
Self CUDA time total: 220.548s

2023-03-18 13:11:58,601 - INFO - Rank 1 | wait sampler total time: 7.841322660446167, total iters: 3110, avg iter time:0.002521325614291372
