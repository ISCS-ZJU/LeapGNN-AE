2023-03-16 18:45:50,445 - INFO - Rank 1 | Client Args: Namespace(dataset='./dist/repgnn_data/ogbn_products0/', sampling='10-10', hidden_size=256, n_classes=60, batch_size=8000, dropout=0.2, lr=0.03, weight_decay=0, model_name='gcn', epoch=1, num_worker=1, cache_size=0, seed=None, log=True, dist_url='tcp://10.214.242.140:23456', world_size=2, rank=1, gpu=0, grpc_port='10.214.243.19:18110', mlp_layers=1, block='res+', conv='gen', gcn_aggr='max', norm='batch', t=1.0, p=1.0, y=0.0, learn_t=False, learn_p=False, learn_y=False, msg_norm=False, learn_msg_scale=False, distributed=True)
2023-03-16 18:45:50,470 - INFO - Rank 1 | Added key: store_based_barrier_key:1 to store for rank: 1
2023-03-16 18:45:50,470 - INFO - Rank 1 | Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
2023-03-16 18:45:50,472 - INFO - Rank 1 | Using 2 distributed GPUs in total for training...
2023-03-16 18:46:45,552 - INFO - Rank 1 | Reducer buckets have been rebuilt in this iteration.
2023-03-16 19:03:06,407 - INFO - Rank 1 | rank: 1, iter_num: 100
2023-03-16 19:03:06,409 - INFO - Rank 1 | Epoch miss rate ( miss_num/try_num ) for epoch 0 on rank 1: 90444810 / 190412650 = 0.47499370446238737
2023-03-16 19:03:06,410 - INFO - Rank 1 | Up to now, total_local_feats_gather_time = 19.905 s, total_remote_feats_gather_time = 450.958 s
2023-03-16 19:03:06,410 - INFO - Rank 1 | => cur_epoch 0 finished on rank 1
2023-03-16 19:04:05,405 - INFO - Rank 1 | -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      total epochs time         1.03%       10.545s        99.86%     1021.276s     1021.276s       10.551s         1.03%     1021.270s     1021.270s             1  
                                             fetch feat         0.18%        1.861s        61.44%      628.372s        6.284s        1.886s         0.18%      628.368s        6.284s           100  
                           fetch feat from cache server        58.24%      595.572s        59.61%      609.660s        1.524s      596.242s        58.31%      609.654s        1.524s           400  
                        gpu-compute with optimizer.step         0.02%     169.092ms        37.37%      382.184s        3.822s     174.268ms         0.02%      382.181s        3.822s           100  
                                           DDP backward        30.69%      313.865s        30.69%      313.874s        3.139s      313.853s        30.69%      313.856s        3.139s           100  
                                            DDP forward         0.00%       6.017ms         6.63%       67.779s     677.787ms       9.086ms         0.00%       67.778s     677.777ms           100  
                        DistributedDataParallel.forward         6.08%       62.172s         6.63%       67.767s     677.670ms       62.031s         6.07%       67.765s     677.647ms           100  
                                            aten::copy_         1.21%       12.385s         2.06%       21.044s       1.042ms       20.912s         2.04%       20.912s       1.035ms         20201  
                             move feats from CPU to GPU         0.26%        2.666s         1.10%       11.226s      28.065ms        2.674s         0.26%       11.223s      28.058ms           400  
                                               aten::to         0.00%      11.052ms         0.87%        8.912s       7.420ms      16.446ms         0.00%        8.905s       7.415ms          1201  
                                         aten::_to_copy         0.00%      18.314ms         0.87%        8.895s       8.086ms      29.143ms         0.00%        8.888s       8.080ms          1100  
                                          create frames         0.52%        5.366s         0.53%        5.389s      13.473ms        5.376s         0.53%        5.387s      13.467ms           400  
                                             CopyReduce         0.01%     114.377ms         0.15%        1.540s       5.134ms        3.144s         0.31%        3.266s      10.888ms           300  
                                            aten::index         0.15%        1.581s         0.16%        1.632s       2.332ms        1.593s         0.16%        1.620s       2.315ms           700  
                                            aten::slice         0.04%     416.019ms         0.11%        1.132s      29.552us     632.018ms         0.06%     856.610ms      22.369us         38294  
autograd::engine::evaluate_function: CopyReduceBackw...         0.00%       4.058ms         0.08%     798.471ms       3.992ms       4.882ms         0.00%     752.345ms       3.762ms           200  
                                     CopyReduceBackward         0.01%      58.215ms         0.08%     792.595ms       3.963ms     718.130ms         0.07%     747.463ms       3.737ms           200  
                                          aten::reshape         0.03%     267.799ms         0.08%     846.834ms      43.434us     314.904ms         0.03%     547.025ms      28.057us         19497  
                                   DDP optimizer.step()         0.00%       6.795ms         0.03%     286.972ms       2.870ms      11.000ms         0.00%     285.957ms       2.860ms           100  
                               Optimizer.step#Adam.step         0.01%      66.356ms         0.03%     269.870ms       2.699ms     112.734ms         0.01%     268.838ms       2.688ms           100  
    autograd::engine::evaluate_function: AddmmBackward0         0.00%       7.062ms         0.01%     106.005ms     353.350us       6.461ms         0.00%     260.778ms     869.260us           300  
                                           aten::linear         0.00%       3.538ms         0.01%      63.925ms     213.083us       3.596ms         0.00%     255.482ms     851.607us           300  
                                            aten::addmm         0.00%      31.630ms         0.00%      46.491ms     154.970us     242.151ms         0.02%     246.127ms     820.423us           300  
                                       aten::as_strided         0.02%     233.611ms         0.05%     495.630ms      11.829us     244.256ms         0.02%     244.256ms       5.829us         41900  
                                          aten::dropout         0.00%       4.054ms         0.00%      49.653ms     165.510us       3.511ms         0.00%     238.983ms     796.610us           300  
                                   aten::_fused_dropout         0.00%      13.857ms         0.00%      42.419ms     141.397us     218.751ms         0.02%     235.472ms     784.907us           300  
                                   aten::_reshape_alias         0.02%     220.011ms         0.03%     353.670ms      18.140us     232.121ms         0.02%     232.121ms      11.905us         19497  
                                        aten::clamp_min         0.00%       9.966ms         0.00%      30.605ms      43.721us      86.562ms         0.01%     169.327ms     241.896us           700  
                                         AddmmBackward0         0.00%       5.825ms         0.01%      76.904ms     256.347us       8.278ms         0.00%     168.448ms     561.493us           300  
                                               aten::mm         0.00%      25.845ms         0.00%      37.256ms      74.512us     141.685ms         0.01%     141.685ms     283.370us           500  
                                              aten::div         0.00%      27.639ms         0.00%      42.720ms      38.836us     133.212ms         0.01%     133.212ms     121.102us          1100  
     autograd::engine::evaluate_function: ReluBackward0         0.00%       2.772ms         0.00%      13.889ms      69.445us       1.550ms         0.00%     122.424ms     612.120us           200  
                                          ReluBackward0         0.00%       2.391ms         0.00%      10.288ms      51.440us       1.560ms         0.00%     120.874ms     604.370us           200  
                               aten::threshold_backward         0.00%       4.625ms         0.00%       7.088ms      35.440us     119.314ms         0.01%     119.314ms     596.570us           200  
                                            fetch label         0.00%       5.267ms         0.01%     113.335ms       1.133ms       7.243ms         0.00%     112.821ms       1.128ms           100  
autograd::engine::evaluate_function: FusedDropoutBac...         0.00%       3.440ms         0.00%      28.393ms     141.965us       2.287ms         0.00%     110.873ms     554.365us           200  
                                  FusedDropoutBackward0         0.00%       2.294ms         0.00%      22.832ms     114.160us       2.748ms         0.00%     108.586ms     542.930us           200  
                                    aten::_masked_scale         0.00%       6.066ms         0.00%      19.636ms      98.180us      96.947ms         0.01%     105.838ms     529.190us           200  
                                            aten::zeros         0.00%      35.159ms         0.01%     122.659ms      43.776us      64.192ms         0.01%      99.339ms      35.453us          2802  
                                            get nf_nids         0.00%      46.920ms         0.01%      98.341ms     983.410us      55.657ms         0.01%      97.797ms     977.970us           100  
                                             aten::relu         0.00%       3.559ms         0.00%      17.735ms      88.675us       1.559ms         0.00%      86.185ms     430.925us           200  
                                              aten::sum         0.00%      10.880ms         0.00%      16.600ms      55.333us      84.661ms         0.01%      84.661ms     282.203us           300  
                                            aten::empty         0.01%      83.268ms         0.01%     125.276ms      14.893us      71.686ms         0.01%      71.686ms       8.522us          8412  
                                     DDP calculate loss         0.00%       6.934ms         0.00%      25.832ms     258.320us       4.478ms         0.00%      52.200ms     522.000us           100  
                               aten::cross_entropy_loss         0.00%       1.285ms         0.00%      17.766ms     177.660us       1.873ms         0.00%      47.336ms     473.360us           100  
                                asign frame to nodeflow         0.00%      43.406ms         0.00%      49.406ms     123.515us      45.244ms         0.00%      47.184ms     117.960us           400  
                                             aten::add_         0.00%      37.019ms         0.01%      63.760ms      35.541us      45.830ms         0.00%      45.830ms      25.546us          1794  
                                      aten::nll_loss_nd         0.00%     899.000us         0.00%       9.877ms      98.770us       1.045ms         0.00%      39.607ms     396.070us           100  
                                         aten::nll_loss         0.00%     887.000us         0.00%       8.742ms      87.420us       1.041ms         0.00%      38.562ms     385.620us           100  
                                    aten::empty_strided         0.00%      38.144ms         0.00%      50.141ms      27.672us      38.490ms         0.00%      38.490ms      21.242us          1812  
                                 aten::nll_loss_forward         0.00%       2.707ms         0.00%       7.622ms      76.220us      36.879ms         0.00%      37.521ms     375.210us           100  
autograd::engine::evaluate_function: torch::autograd...         0.00%      20.409ms         0.01%      71.316ms     118.860us       7.822ms         0.00%      37.468ms      62.447us           600  
                                             aten::mul_         0.00%      27.345ms         0.00%      48.544ms      40.453us      37.097ms         0.00%      37.097ms      30.914us          1200  
                                     train data prepare         0.00%      32.747ms         0.00%      32.767ms      32.767ms      32.755ms         0.00%      32.759ms      32.759ms             1  
                                                aten::t         0.00%      16.736ms         0.01%      56.153ms      40.109us      12.749ms         0.00%      31.294ms      22.353us          1400  
                                            aten::zero_         0.00%      23.206ms         0.01%      53.132ms      15.146us      20.117ms         0.00%      28.992ms       8.265us          3508  
                                       aten::empty_like         0.00%       8.424ms         0.00%      35.416ms      38.833us      12.017ms         0.00%      27.769ms      30.448us           912  
autograd::engine::evaluate_function: NllLossBackward...         0.00%       3.395ms         0.00%      19.409ms     194.090us       1.269ms         0.00%      25.035ms     250.350us           100  
                                       NllLossBackward0         0.00%       1.718ms         0.00%      14.082ms     140.820us       1.302ms         0.00%      23.766ms     237.660us           100  
                                         aten::randperm         0.00%      11.841ms         0.00%      23.629ms      11.815ms      11.864ms         0.00%      23.612ms      11.806ms             2  
                                aten::nll_loss_backward         0.00%       3.813ms         0.00%      11.802ms     118.020us      17.053ms         0.00%      22.464ms     224.640us           100  
                                             aten::sqrt         0.00%      16.706ms         0.00%      27.194ms      45.323us      21.567ms         0.00%      21.567ms      35.945us           600  
                                        aten::new_empty         0.00%       7.044ms         0.00%      27.590ms      34.487us       8.830ms         0.00%      19.615ms      24.519us           800  
                                         aten::addcdiv_         0.00%      13.696ms         0.00%      24.319ms      40.532us      18.651ms         0.00%      18.651ms      31.085us           600  
                                        aten::transpose         0.00%      11.299ms         0.00%      32.935ms      23.525us      13.680ms         0.00%      18.545ms      13.246us          1400  
                                         aten::addcmul_         0.00%      13.490ms         0.00%      23.987ms      39.978us      18.389ms         0.00%      18.389ms      30.648us           600  
                                   DDP optimizer.zero()         0.00%       2.447ms         0.00%      26.585ms     265.850us       1.725ms         0.00%      17.271ms     172.710us           100  
                        torch::autograd::AccumulateGrad         0.00%       5.861ms         0.00%      23.920ms      39.867us       6.175ms         0.00%      14.998ms      24.997us           600  
                                           aten::unbind         0.00%       2.024ms         0.00%      13.924ms     139.240us       4.516ms         0.00%      13.427ms     134.270us           100  
                     Optimizer.zero_grad#Adam.zero_grad         0.00%       4.475ms         0.00%      20.687ms     206.870us       3.421ms         0.00%      13.328ms     133.280us           100  
                                            aten::fill_         0.00%      16.690ms         0.00%      25.760ms      23.291us      13.256ms         0.00%      13.256ms      11.986us          1106  
        autograd::engine::evaluate_function: TBackward0         0.00%       3.479ms         0.00%      19.017ms      63.390us       3.249ms         0.00%      13.105ms      43.683us           300  
                                         aten::new_ones         0.00%       2.879ms         0.00%      24.358ms      81.193us       2.322ms         0.00%      10.569ms      35.230us           300  
                                             TBackward0         0.00%       2.355ms         0.00%      14.323ms      47.743us       2.806ms         0.00%       9.856ms      32.853us           300  
                                              aten::mul         0.00%      10.044ms         0.00%      16.780ms      27.967us       9.796ms         0.00%       9.796ms      16.327us           600  
                                              aten::cat         0.00%       1.392ms         0.00%       9.738ms      97.380us       1.726ms         0.00%       9.244ms      92.440us           100  
                                           aten::select         0.00%       4.068ms         0.00%      11.540ms      19.233us       6.717ms         0.00%       8.911ms      14.852us           600  
                                             aten::item         0.00%       4.069ms         0.00%      11.109ms      18.515us       5.860ms         0.00%       8.327ms      13.878us           600  
                                             aten::ones         0.00%       4.100ms         0.00%      20.011ms      66.703us       3.780ms         0.00%       8.247ms      27.490us           300  
                                             aten::_cat         0.00%       2.622ms         0.00%       7.994ms      79.940us       3.891ms         0.00%       7.518ms      75.180us           100  
                                      aten::log_softmax         0.00%       1.177ms         0.00%       6.266ms      62.660us       1.767ms         0.00%       5.856ms      58.560us           100  
                                            aten::clamp         0.00%       6.810ms         0.00%      15.402ms      51.340us       2.374ms         0.00%       5.525ms      18.417us           300  
                                           aten::expand         0.00%       2.343ms         0.00%       6.351ms      21.170us       3.054ms         0.00%       3.976ms      13.253us           300  
                                     aten::_log_softmax         0.00%       2.732ms         0.00%       4.046ms      40.460us       3.711ms         0.00%       3.711ms      37.110us           100  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%       1.368ms         0.00%       7.089ms      70.890us       1.002ms         0.00%       3.393ms      33.930us           100  
                                        aten::ones_like         0.00%     849.000us         0.00%       5.239ms      52.390us       1.243ms         0.00%       3.209ms      32.090us           100  
                                           aten::narrow         0.00%     822.000us         0.00%       3.005ms      30.050us       1.149ms         0.00%       2.544ms      25.440us           100  
                              aten::_local_scalar_dense         0.00%       3.355ms         0.00%       5.148ms       8.580us       2.467ms         0.00%       2.467ms       4.112us           600  
                                    LogSoftmaxBackward0         0.00%       1.452ms         0.00%       5.347ms      53.470us     928.000us         0.00%       2.391ms      23.910us           100  
                                     aten::resolve_conj         0.00%       3.320ms         0.00%       6.183ms      10.305us       2.387ms         0.00%       2.387ms       3.978us           600  
                                      aten::resolve_neg         0.00%       3.049ms         0.00%       5.038ms       8.397us       2.323ms         0.00%       2.323ms       3.872us           600  
                                       aten::zeros_like         0.00%     178.000us         0.00%       2.179ms     181.583us     403.000us         0.00%       2.060ms     171.667us            12  
                aten::_has_compatible_shallow_copy_type         0.00%       2.511ms         0.00%       4.149ms      10.373us       1.911ms         0.00%       1.911ms       4.777us           400  
                                          aten::resize_         0.00%       4.265ms         0.00%       7.065ms      14.074us       1.862ms         0.00%       1.862ms       3.709us           502  
                       aten::_log_softmax_backward_data         0.00%       2.234ms         0.00%       3.517ms      35.170us       1.463ms         0.00%       1.463ms      14.630us           100  
                                             aten::view         0.00%       2.955ms         0.00%       4.242ms      14.140us       1.208ms         0.00%       1.208ms       4.027us           300  
                                             aten::set_         0.00%     996.000us         0.00%       1.357ms      13.304us     394.000us         0.00%     394.000us       3.863us           102  
                                           aten::detach         0.00%      46.000us         0.00%     147.000us      24.500us      66.000us         0.00%     101.000us      16.833us             6  
                                                 detach         0.00%      54.000us         0.00%      78.000us      13.000us      35.000us         0.00%      35.000us       5.833us             6  
                                    aten::scalar_tensor         0.00%      11.000us         0.00%      13.000us      13.000us       8.000us         0.00%       8.000us       8.000us             1  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 1022.668s
Self CUDA time total: 1022.623s

2023-03-16 19:04:05,405 - INFO - Rank 1 | wait sampler total time: 10.512939691543579, total iters: 100, avg iter time:0.1051293969154358
