2023-03-17 14:31:31,153 - INFO - Rank 0 | Client Args: Namespace(dataset='./dist/repgnn_data/ogbn_products0/', num_gpu=1, sampling='10-10', hidden_size=256, n_classes=60, batch_size=8000, dropout=0.2, lr=0.03, weight_decay=0, model_name='gcn', epoch=1, num_worker=1, cache_size=0, ckpt_path='/dev/shm', seed=None, log=True, dist_url='tcp://10.214.242.140:23456', world_size=2, rank=0, gpu=0, grpc_port='10.214.242.140:18110', deduplicate=True, distributed=True)
2023-03-17 14:31:32,968 - INFO - Rank 0 | Added key: store_based_barrier_key:1 to store for rank: 0
2023-03-17 14:31:32,968 - INFO - Rank 0 | Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
2023-03-17 14:31:32,969 - INFO - Rank 0 | Using 2 distributed GPUs in total for training...
2023-03-17 14:31:48,002 - INFO - Rank 0 | n_sub_batches:796102
2023-03-17 14:32:13,192 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:32:13,222 - INFO - Rank 0 | Reducer buckets have been rebuilt in this iteration.
2023-03-17 14:32:13,889 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:32:18,845 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:32:19,684 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:32:25,777 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:32:26,571 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:32:32,081 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:32:32,879 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:32:38,433 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:32:39,255 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:32:44,451 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:32:45,225 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:32:50,601 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:32:51,405 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:32:56,363 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:32:57,162 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:33:02,346 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:33:03,085 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:33:08,444 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:33:09,221 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:33:18,187 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:33:18,881 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:33:23,903 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:33:29,580 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:33:34,644 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:33:35,467 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:33:40,937 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:33:41,794 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:33:46,745 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:33:47,503 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:33:52,277 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:33:52,799 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:33:57,483 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:33:58,230 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:34:02,906 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:34:03,589 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:34:08,464 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:34:09,171 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:34:14,051 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:34:14,720 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:34:19,341 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:34:20,022 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:34:24,625 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:34:25,341 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:34:30,994 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:34:31,670 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:35:18,431 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:35:19,221 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:35:24,271 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:35:25,001 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:35:29,774 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:35:30,418 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:35:34,905 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:35:35,606 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:35:40,250 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:35:40,968 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:35:45,616 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:35:46,269 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:35:50,698 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:35:51,357 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:35:56,195 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:35:56,930 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:36:01,541 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:36:02,190 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:36:06,730 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:36:07,389 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:36:12,170 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:36:12,820 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:36:17,651 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:36:18,292 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:36:22,677 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:36:23,311 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:36:27,973 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:36:28,701 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:36:33,383 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:36:34,271 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:36:39,098 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:36:39,834 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:36:44,562 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:36:46,155 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:36:50,863 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:36:51,498 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:36:56,199 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:36:56,884 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:37:01,545 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:37:02,228 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:37:06,757 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:37:07,402 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:37:12,100 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:37:12,590 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:37:16,968 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:37:17,603 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:37:22,097 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:37:22,748 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:37:27,658 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:37:28,555 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:37:33,327 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:37:34,006 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:37:38,474 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:37:39,132 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:37:43,651 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:37:44,379 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:37:49,019 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:37:49,650 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:37:54,352 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:37:55,021 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:37:59,514 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:38:00,186 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:38:04,553 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:38:05,328 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:38:10,390 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:38:11,051 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:38:15,904 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:38:16,676 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:38:21,380 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:38:22,207 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:38:27,055 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:38:27,852 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:38:32,317 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:38:33,010 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:38:37,624 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:38:38,291 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:38:43,159 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:38:43,866 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:38:48,304 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:38:48,993 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:38:53,648 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:38:54,405 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:38:59,063 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:38:59,741 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:39:08,440 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:39:09,306 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:39:14,265 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:39:15,054 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:39:19,636 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:39:20,319 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:39:24,860 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:39:25,357 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:39:30,386 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:39:31,073 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:39:35,813 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:39:36,526 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:39:41,382 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:39:42,089 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:39:47,052 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:39:47,787 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:39:52,528 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:39:53,212 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:39:57,867 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:39:58,650 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:40:03,431 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:40:04,199 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:40:08,789 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:40:09,618 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:40:14,174 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:40:14,860 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:40:19,575 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:40:20,402 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:40:25,036 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:40:25,726 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:40:30,233 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:40:30,940 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:40:35,723 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:40:36,494 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:40:41,004 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:40:41,683 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:40:46,513 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:40:47,301 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:40:51,609 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:40:52,396 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:40:57,206 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:40:57,925 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:41:02,526 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:41:03,052 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:41:07,658 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:41:08,445 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:41:13,292 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:41:14,039 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:41:18,757 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:41:19,373 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:41:24,163 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:41:24,977 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:41:29,880 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:41:30,666 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:41:35,504 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:41:36,327 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:41:41,041 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:41:41,565 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:41:46,118 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:41:46,888 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:41:51,577 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:41:52,326 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:41:59,767 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:42:00,501 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:42:05,444 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:42:06,264 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:42:11,134 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:42:11,843 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:42:14,772 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:42:15,087 - INFO - Rank 0 | rank: 0 sub_batch backward done.
2023-03-17 14:42:15,108 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 0 on rank 0: 17266960 / 141644661 = 0.12190335928016376
2023-03-17 14:42:15,108 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 36.195 s, total_remote_feats_gather_time = 118.163 s
2023-03-17 14:42:15,109 - INFO - Rank 0 | => cur_epoch 0 finished on rank 0
2023-03-17 14:43:28,256 - INFO - Rank 0 | -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      total epochs time         3.17%       19.992s        99.47%      627.312s      627.312s       20.036s         3.18%      627.326s      627.326s             1  
                                             fetch feat         1.46%        9.229s        67.99%      428.782s        4.288s        9.297s         1.47%      428.790s        4.288s           100  
                fetch feat from cache server and concat        49.92%      314.806s        52.54%      331.350s     828.376ms      315.357s        50.02%      331.355s     828.387ms           400  
                                            gpu-compute         6.08%       38.334s        27.52%      173.573s     578.576ms       38.340s         6.08%      173.573s     578.577ms           300  
                        DistributedDataParallel.forward        19.67%      124.049s        21.36%      134.714s     673.570ms      127.462s        20.22%      134.714s     673.572ms           200  
                                            aten::copy_         1.09%        6.875s         5.99%       37.780s       4.195ms       37.688s         5.98%       37.688s       4.185ms          9006  
                                      deduplicate tnids         5.55%       34.993s         5.55%       35.013s      87.533ms       35.009s         5.55%       35.011s      87.527ms           400  
                                               aten::to         0.03%     198.265ms         5.18%       32.673s       4.949ms     240.965ms         0.04%       32.602s       4.938ms          6602  
                             move feats from CPU to GPU         0.53%        3.340s         5.13%       32.371s      80.927ms        3.362s         0.53%       32.368s      80.920ms           400  
                                         aten::_to_copy         0.06%     368.294ms         5.14%       32.409s       5.787ms     470.067ms         0.07%       32.361s       5.779ms          5600  
                                            fill frames         0.67%        4.218s         2.92%       18.426s      46.064ms        4.268s         0.68%       18.422s      46.055ms           400  
                                              aten::cat         0.01%      32.595ms         2.30%       14.494s      36.234ms      37.064ms         0.01%       14.486s      36.216ms           400  
                                             aten::_cat         2.01%       12.694s         2.29%       14.454s      36.135ms       12.927s         2.05%       14.449s      36.123ms           400  
                                            aten::index         1.73%       10.911s         1.78%       11.196s       5.089ms       10.968s         1.74%       11.160s       5.073ms          2200  
                                         model transfer         0.46%        2.907s         0.64%        4.031s      20.154ms        2.979s         0.47%        4.029s      20.144ms           200  
                                             CopyReduce         0.06%     391.767ms         0.18%        1.129s       1.882ms        1.840s         0.29%        2.035s       3.392ms           600  
                                          aten::reshape         0.18%        1.126s         0.35%        2.188s     131.986us        1.232s         0.20%        1.620s      97.718us         16580  
                                           aten::narrow         0.09%     543.479ms         0.27%        1.717s     124.579us     661.600ms         0.10%        1.494s     108.435us         13780  
autograd::engine::evaluate_function: CopyReduceBackw...         0.00%      18.362ms         0.21%        1.344s       3.360ms      26.545ms         0.00%        1.338s       3.345ms           400  
                                     CopyReduceBackward         0.04%     282.650ms         0.21%        1.318s       3.295ms        1.227s         0.19%        1.312s       3.279ms           400  
                                            aten::slice         0.12%     736.425ms         0.21%        1.337s      71.188us     945.061ms         0.15%        1.137s      60.555us         18780  
                                            get nf_nids         0.01%      36.170ms         0.16%        1.026s      10.256ms      40.533ms         0.01%        1.024s      10.243ms           100  
    autograd::engine::evaluate_function: AddmmBackward0         0.01%      35.545ms         0.08%     512.322ms     853.870us      22.684ms         0.00%     848.143ms       1.414ms           600  
                                         AddmmBackward0         0.01%      31.840ms         0.06%     373.905ms     623.175us      33.913ms         0.01%     699.034ms       1.165ms           600  
                                          aten::dropout         0.00%      26.820ms         0.03%     215.177ms     358.628us      18.689ms         0.00%     657.501ms       1.096ms           600  
                                   aten::_fused_dropout         0.01%      65.221ms         0.03%     181.326ms     302.210us     565.905ms         0.09%     638.812ms       1.065ms           600  
                                               aten::mm         0.02%     111.970ms         0.03%     170.964ms     170.964us     597.343ms         0.09%     597.343ms     597.343us          1000  
                                           aten::linear         0.01%      37.841ms         0.04%     239.894ms     399.823us      16.033ms         0.00%     592.436ms     987.393us           600  
                                            aten::addmm         0.01%      86.321ms         0.02%     136.971ms     228.285us     543.226ms         0.09%     553.709ms     922.848us           600  
                                        aten::clamp_min         0.01%      51.460ms         0.02%     116.615ms      83.296us     203.639ms         0.03%     400.709ms     286.221us          1400  
                                            fetch label         0.01%      33.708ms         0.06%     398.159ms       1.991ms      41.024ms         0.01%     395.689ms       1.978ms           200  
                               Optimizer.step#Adam.step         0.03%     192.458ms         0.06%     389.453ms       3.895ms     241.110ms         0.04%     388.519ms       3.885ms           100  
                                   aten::_reshape_alias         0.06%     374.987ms         0.10%     614.522ms      37.064us     388.287ms         0.06%     388.287ms      23.419us         16580  
                                            aten::zeros         0.04%     254.390ms         0.07%     438.449ms     115.290us     310.422ms         0.05%     383.869ms     100.938us          3803  
autograd::engine::evaluate_function: FusedDropoutBac...         0.00%      15.629ms         0.02%     119.053ms     297.632us       9.981ms         0.00%     302.354ms     755.885us           400  
     autograd::engine::evaluate_function: ReluBackward0         0.00%      12.948ms         0.01%      68.890ms     172.225us       1.375ms         0.00%     299.640ms     749.100us           400  
                                          ReluBackward0         0.00%      10.736ms         0.01%      49.832ms     124.580us       1.928ms         0.00%     298.265ms     745.663us           400  
                               aten::threshold_backward         0.00%      20.180ms         0.01%      33.466ms      83.665us     296.337ms         0.05%     296.337ms     740.842us           400  
                                  FusedDropoutBackward0         0.00%      10.236ms         0.02%      97.315ms     243.287us      12.749ms         0.00%     292.373ms     730.933us           400  
                                    aten::_masked_scale         0.00%      24.951ms         0.01%      79.505ms     198.762us     249.743ms         0.04%     279.624ms     699.060us           400  
                                       aten::zeros_like         0.01%      80.887ms         0.05%     289.242ms     238.649us     105.449ms         0.02%     274.810ms     226.741us          1212  
                                       aten::as_strided         0.04%     267.657ms         0.09%     540.666ms      21.131us     248.578ms         0.04%     248.578ms       9.715us         25586  
                                    aten::empty_strided         0.03%     216.286ms         0.05%     310.088ms      37.760us     233.259ms         0.04%     233.259ms      28.405us          8212  
                                            aten::empty         0.04%     234.922ms         0.06%     355.612ms      25.018us     221.917ms         0.04%     221.917ms      15.613us         14214  
                                             aten::relu         0.00%      18.388ms         0.01%      85.654ms     214.135us       1.229ms         0.00%     199.951ms     499.877us           400  
                                       aten::empty_like         0.02%     102.341ms         0.04%     233.328ms      77.466us     121.211ms         0.02%     188.548ms      62.599us          3012  
                                              aten::div         0.01%      53.385ms         0.01%      85.337ms      53.336us     176.568ms         0.03%     176.568ms     110.355us          1600  
                                     train data prepare         0.03%     165.860ms         0.03%     165.892ms     165.892ms     165.886ms         0.03%     165.890ms     165.890ms             1  
autograd::engine::evaluate_function: torch::autograd...         0.01%      92.245ms         0.06%     351.358ms     292.798us      51.443ms         0.01%     156.550ms     130.458us          1200  
                                            aten::zero_         0.01%      59.851ms         0.03%     190.754ms      36.578us      63.909ms         0.01%     145.490ms      27.898us          5215  
                                 sync for each sub_iter         0.02%     119.223ms         0.02%     135.359ms     676.795us     130.462ms         0.02%     133.402ms     667.010us           200  
                                              aten::sum         0.01%      45.834ms         0.01%      70.717ms     117.862us     121.290ms         0.02%     121.290ms     202.150us           600  
                                                aten::t         0.01%      81.283ms         0.05%     285.694ms     102.034us      56.672ms         0.01%     121.141ms      43.265us          2800  
                                            aten::fill_         0.01%      91.360ms         0.02%     113.493ms      93.641us      92.467ms         0.01%      92.467ms      76.293us          1212  
                                asign frame to nodeflow         0.01%      78.256ms         0.01%      86.836ms     217.090us      81.147ms         0.01%      83.771ms     209.428us           400  
                                        aten::new_empty         0.01%      44.777ms         0.02%     105.266ms      65.791us      46.406ms         0.01%      76.573ms      47.858us          1600  
autograd::engine::evaluate_function: NllLossBackward...         0.00%      12.518ms         0.01%      83.348ms     416.740us      14.978ms         0.00%      73.717ms     368.585us           200  
                               aten::cross_entropy_loss         0.00%       8.581ms         0.01%      63.318ms     316.590us       9.543ms         0.00%      72.476ms     362.380us           200  
                                          create frames         0.01%      46.433ms         0.01%      71.765ms     179.412us      54.291ms         0.01%      69.407ms     173.518us           400  
                                             aten::add_         0.01%      66.704ms         0.02%     126.068ms      52.660us      67.139ms         0.01%      67.139ms      28.045us          2394  
                                        aten::transpose         0.01%      59.265ms         0.03%     167.516ms      59.827us      44.932ms         0.01%      64.469ms      23.025us          2800  
                        torch::autograd::AccumulateGrad         0.00%      26.369ms         0.02%     127.933ms     106.611us      26.490ms         0.00%      61.450ms      51.208us          1200  
                                       NllLossBackward0         0.00%       6.560ms         0.01%      63.513ms     317.565us       6.809ms         0.00%      58.739ms     293.695us           200  
        autograd::engine::evaluate_function: TBackward0         0.00%      15.827ms         0.02%     104.900ms     174.833us      14.277ms         0.00%      58.103ms      96.838us           600  
                                aten::nll_loss_backward         0.00%      15.020ms         0.01%      51.852ms     259.260us      25.223ms         0.00%      51.930ms     259.650us           200  
                                             TBackward0         0.00%      10.494ms         0.01%      80.153ms     133.588us      13.157ms         0.00%      43.826ms      73.043us           600  
                                      aten::nll_loss_nd         0.00%       4.353ms         0.00%      31.177ms     155.885us       4.369ms         0.00%      41.631ms     208.155us           200  
                                         create sampler         0.01%      38.752ms         0.01%      38.865ms      38.865ms      38.810ms         0.01%      38.860ms      38.860ms             1  
                                         aten::nll_loss         0.00%       4.351ms         0.00%      25.856ms     129.280us       4.377ms         0.00%      37.262ms     186.310us           200  
                                             aten::mul_         0.00%      25.880ms         0.01%      48.508ms      40.423us      34.713ms         0.01%      34.713ms      28.927us          1200  
                                              aten::mul         0.01%      45.328ms         0.01%      82.794ms      68.995us      34.510ms         0.01%      34.510ms      28.758us          1200  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%       7.048ms         0.01%      36.870ms     184.350us       9.950ms         0.00%      34.028ms     170.140us           200  
                                 aten::nll_loss_forward         0.00%      11.836ms         0.00%      20.559ms     102.795us      31.120ms         0.00%      32.885ms     164.425us           200  
                                    LogSoftmaxBackward0         0.00%       6.141ms         0.00%      26.733ms     133.665us       9.314ms         0.00%      24.078ms     120.390us           200  
                                          aten::resize_         0.00%      27.839ms         0.01%      38.284ms      31.903us      22.627ms         0.00%      22.627ms      18.856us          1200  
                                        aten::ones_like         0.00%       7.672ms         0.00%      23.182ms     115.910us       9.512ms         0.00%      21.784ms     108.920us           200  
                                      aten::log_softmax         0.00%       8.071ms         0.00%      22.461ms     112.305us      10.245ms         0.00%      21.302ms     106.510us           200  
                                             aten::sqrt         0.00%      15.544ms         0.00%      25.759ms      42.932us      20.456ms         0.00%      20.456ms      34.093us           600  
                                         aten::addcdiv_         0.00%      13.625ms         0.00%      24.900ms      41.500us      18.243ms         0.00%      18.243ms      30.405us           600  
                                         aten::new_ones         0.00%      17.239ms         0.01%      89.504ms     149.173us       2.826ms         0.00%      18.062ms      30.103us           600  
                                         aten::addcmul_         0.00%      12.830ms         0.00%      22.972ms      38.287us      17.704ms         0.00%      17.704ms      29.507us           600  
                                            aten::clamp         0.00%      27.095ms         0.01%      48.311ms      80.518us      10.709ms         0.00%      16.430ms      27.383us           600  
                                             aten::ones         0.00%      29.794ms         0.01%      67.425ms     112.375us       7.158ms         0.00%      15.236ms      25.393us           600  
                       aten::_log_softmax_backward_data         0.00%       9.448ms         0.00%      17.566ms      87.830us      14.764ms         0.00%      14.764ms      73.820us           200  
                                           aten::expand         0.00%      18.825ms         0.00%      28.669ms      47.782us       9.014ms         0.00%      10.483ms      17.472us           600  
                                     aten::_log_softmax         0.00%       7.176ms         0.00%      11.227ms      56.135us      10.089ms         0.00%      10.089ms      50.445us           200  
                                     aten::resolve_conj         0.00%       4.801ms         0.00%      10.218ms      12.773us       5.217ms         0.00%       5.217ms       6.521us           800  
                                             aten::view         0.00%      12.460ms         0.00%      21.376ms      35.627us       5.135ms         0.00%       5.135ms       8.558us           600  
                aten::_has_compatible_shallow_copy_type         0.00%       5.483ms         0.00%      10.635ms      13.294us       4.605ms         0.00%       4.605ms       5.756us           800  
                                      aten::resolve_neg         0.00%       4.555ms         0.00%       8.781ms      10.976us       3.813ms         0.00%       3.813ms       4.766us           800  
                                             aten::set_         0.00%       3.305ms         0.00%       5.661ms      28.025us     256.000us         0.00%     256.000us       1.267us           202  
                                           aten::detach         0.00%      91.000us         0.00%     363.000us      60.500us     106.000us         0.00%     186.000us      31.000us             6  
                                                 detach         0.00%     105.000us         0.00%     196.000us      32.667us      80.000us         0.00%      80.000us      13.333us             6  
                                          aten::detach_         0.00%      18.000us         0.00%      34.000us      34.000us      22.000us         0.00%      28.000us      28.000us             1  
                                                detach_         0.00%       7.000us         0.00%      11.000us      11.000us       6.000us         0.00%       6.000us       6.000us             1  
                                        cudaEventCreate         0.15%     961.718ms         0.15%     961.718ms       2.426us       0.000us         0.00%       0.000us       0.000us        396418  
                                        cudaEventRecord         0.26%        1.636s         0.26%        1.636s       4.115us       0.000us         0.00%       0.000us       0.000us        397687  
                                  cudaStreamIsCapturing         0.00%       1.053ms         0.00%       1.053ms       1.661us       0.000us         0.00%       0.000us       0.000us           634  
                                             cudaMalloc         0.08%     495.832ms         0.08%     495.832ms     134.774us       0.000us         0.00%       0.000us       0.000us          3679  
                                        cudaMemcpyAsync         4.88%       30.757s         4.88%       30.757s       4.267ms       0.000us         0.00%       0.000us       0.000us          7208  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 630.637s
Self CUDA time total: 630.504s

2023-03-17 14:43:28,257 - INFO - Rank 0 | wait sampler total time: 19.65479326248169, total sub_iters: 100, avg sub_iter time:0.1965479326248169
