2023-03-16 18:44:48,002 - INFO - Rank 0 | Client Args: Namespace(dataset='./dist/repgnn_data/ogbn_products0/', sampling='10-10', hidden_size=256, n_classes=60, batch_size=8000, dropout=0.2, lr=0.03, weight_decay=0, model_name='gcn', epoch=1, num_worker=1, cache_size=0, seed=None, log=True, dist_url='tcp://10.214.242.140:23456', world_size=2, rank=0, gpu=0, grpc_port='10.214.242.140:18110', mlp_layers=1, block='res+', conv='gen', gcn_aggr='max', norm='batch', t=1.0, p=1.0, y=0.0, learn_t=False, learn_p=False, learn_y=False, msg_norm=False, learn_msg_scale=False, distributed=True)
2023-03-16 18:44:48,504 - INFO - Rank 0 | Added key: store_based_barrier_key:1 to store for rank: 0
2023-03-16 18:44:48,504 - INFO - Rank 0 | Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
2023-03-16 18:44:48,505 - INFO - Rank 0 | Using 2 distributed GPUs in total for training...
2023-03-16 18:45:43,585 - INFO - Rank 0 | Reducer buckets have been rebuilt in this iteration.
2023-03-16 19:02:04,427 - INFO - Rank 0 | rank: 0, iter_num: 100
2023-03-16 19:02:04,430 - INFO - Rank 0 | Epoch miss rate ( miss_num/try_num ) for epoch 0 on rank 0: 99876247 / 190371031 = 0.5246399437737982
2023-03-16 19:02:04,430 - INFO - Rank 0 | Up to now, total_local_feats_gather_time = 25.976 s, total_remote_feats_gather_time = 530.803 s
2023-03-16 19:02:04,431 - INFO - Rank 0 | => cur_epoch 0 finished on rank 0
2023-03-16 19:03:06,561 - INFO - Rank 0 | -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      total epochs time         2.08%       21.338s        99.74%     1021.396s     1021.396s       21.368s         2.09%     1021.419s     1021.419s             1  
                                             fetch feat         0.22%        2.269s        80.00%      819.237s        8.192s        2.312s         0.23%      819.254s        8.193s           100  
                           fetch feat from cache server        72.29%      740.324s        74.81%      766.083s        1.915s      741.908s        72.45%      766.096s        1.915s           400  
                        gpu-compute with optimizer.step         0.01%      77.329ms        17.62%      180.405s        1.804s      85.279ms         0.01%      180.408s        1.804s           100  
                                            DDP forward         0.00%      12.529ms        17.25%      176.606s        1.766s      16.424ms         0.00%      176.609s        1.766s           100  
                        DistributedDataParallel.forward        16.22%      166.097s        17.24%      176.580s        1.766s      170.137s        16.61%      176.583s        1.766s           100  
                                            aten::copy_         2.08%       21.330s         6.08%       62.273s       3.083ms       61.960s         6.05%       61.960s       3.067ms         20200  
                             move feats from CPU to GPU         0.31%        3.157s         4.27%       43.778s     109.446ms        3.174s         0.31%       43.773s     109.433ms           400  
                                               aten::to         0.00%      15.555ms         4.04%       41.339s      34.420ms      26.286ms         0.00%       41.328s      34.411ms          1201  
                                         aten::_to_copy         0.00%      28.262ms         4.03%       41.312s      37.556ms      49.833ms         0.00%       41.302s      37.547ms          1100  
                                          create frames         0.65%        6.672s         0.65%        6.706s      16.765ms        6.686s         0.65%        6.703s      16.757ms           400  
                                           DDP backward         0.32%        3.279s         0.32%        3.290s      32.895ms        3.282s         0.32%        3.289s      32.889ms           100  
                                            aten::index         0.27%        2.747s         0.27%        2.816s       4.022ms        2.762s         0.27%        2.800s       4.000ms           700  
                                            aten::slice         0.10%        1.043s         0.27%        2.748s      71.764us        1.588s         0.16%        2.127s      55.540us         38288  
                                             CopyReduce         0.01%     129.538ms         0.07%     692.366ms       2.308ms        1.734s         0.17%        1.866s       6.219ms           300  
                                          aten::reshape         0.07%     707.991ms         0.20%        2.075s     106.462us     852.944ms         0.08%        1.392s      71.427us         19494  
autograd::engine::evaluate_function: CopyReduceBackw...         0.00%       9.319ms         0.12%        1.252s       6.261ms      10.851ms         0.00%        1.179s       5.896ms           200  
                                     CopyReduceBackward         0.01%     145.861ms         0.12%        1.240s       6.199ms        1.122s         0.11%        1.168s       5.842ms           200  
    autograd::engine::evaluate_function: AddmmBackward0         0.00%      18.496ms         0.02%     247.274ms     824.247us      13.807ms         0.00%     723.066ms       2.410ms           300  
                                         AddmmBackward0         0.00%      13.768ms         0.02%     176.390ms     587.967us      13.689ms         0.00%     590.977ms       1.970ms           300  
                                       aten::as_strided         0.05%     513.842ms         0.11%        1.127s      26.910us     567.080ms         0.06%     567.080ms      13.536us         41894  
                                          aten::dropout         0.00%       6.309ms         0.01%      86.411ms     288.037us       3.687ms         0.00%     555.130ms       1.850ms           300  
                                   aten::_fused_dropout         0.00%      20.043ms         0.01%      75.791ms     252.637us     518.941ms         0.05%     551.443ms       1.838ms           300  
                                           aten::linear         0.00%       4.385ms         0.01%      85.537ms     285.123us       4.031ms         0.00%     548.921ms       1.830ms           300  
                                               aten::mm         0.01%      56.895ms         0.01%      85.110ms     170.220us     547.980ms         0.05%     547.980ms       1.096ms           500  
                                   aten::_reshape_alias         0.05%     519.708ms         0.08%     819.129ms      42.020us     539.459ms         0.05%     539.459ms      27.673us         19494  
                                            aten::addmm         0.00%      39.934ms         0.01%      60.992ms     203.307us     536.556ms         0.05%     539.160ms       1.797ms           300  
                                        aten::clamp_min         0.00%      12.702ms         0.00%      41.353ms      59.076us     204.799ms         0.02%     406.032ms     580.046us           700  
                                   DDP optimizer.step()         0.00%       7.251ms         0.03%     327.502ms       3.275ms      10.526ms         0.00%     326.352ms       3.264ms           100  
                               Optimizer.step#Adam.step         0.01%      75.053ms         0.03%     310.398ms       3.104ms     128.382ms         0.01%     309.279ms       3.093ms           100  
     autograd::engine::evaluate_function: ReluBackward0         0.00%       5.920ms         0.00%      31.885ms     159.425us     620.000us         0.00%     296.249ms       1.481ms           200  
                                            fetch label         0.00%      12.270ms         0.03%     297.109ms       2.971ms      16.861ms         0.00%     295.649ms       2.956ms           100  
                                          ReluBackward0         0.00%       4.835ms         0.00%      23.227ms     116.135us     641.000us         0.00%     295.629ms       1.478ms           200  
                               aten::threshold_backward         0.00%       9.555ms         0.00%      16.002ms      80.010us     294.988ms         0.03%     294.988ms       1.475ms           200  
autograd::engine::evaluate_function: FusedDropoutBac...         0.00%       7.433ms         0.01%      58.490ms     292.450us       3.803ms         0.00%     266.043ms       1.330ms           200  
                                  FusedDropoutBackward0         0.00%       4.836ms         0.00%      48.302ms     241.510us       4.794ms         0.00%     262.240ms       1.311ms           200  
                                    aten::_masked_scale         0.00%      11.029ms         0.00%      40.867ms     204.335us     237.644ms         0.02%     257.446ms       1.287ms           200  
                                             aten::relu         0.00%       4.497ms         0.00%      24.265ms     121.325us     634.000us         0.00%     202.740ms       1.014ms           200  
                                            get nf_nids         0.01%      79.252ms         0.02%     180.635ms       1.806ms      98.544ms         0.01%     179.590ms       1.796ms           100  
                                            aten::zeros         0.01%      54.305ms         0.02%     224.702ms      80.193us     108.821ms         0.01%     169.945ms      60.651us          2802  
                                              aten::div         0.00%      37.159ms         0.01%      62.214ms      56.558us     164.046ms         0.02%     164.046ms     149.133us          1100  
                                            aten::empty         0.01%     118.677ms         0.02%     208.601ms      24.798us     118.017ms         0.01%     118.017ms      14.030us          8412  
                                              aten::sum         0.00%      24.890ms         0.00%      38.508ms     128.360us     115.705ms         0.01%     115.705ms     385.683us           300  
                                    aten::empty_strided         0.01%      63.557ms         0.01%      99.490ms      54.906us      79.988ms         0.01%      79.988ms      44.143us          1812  
                                asign frame to nodeflow         0.01%      60.020ms         0.01%      71.166ms     177.915us      63.843ms         0.01%      67.325ms     168.312us           400  
autograd::engine::evaluate_function: torch::autograd...         0.00%      42.151ms         0.02%     164.640ms     274.400us      17.736ms         0.00%      61.278ms     102.130us           600  
                                       aten::empty_like         0.00%      12.692ms         0.01%      70.717ms      77.541us      18.540ms         0.00%      56.393ms      61.834us           912  
                                            aten::zero_         0.00%      32.482ms         0.01%      88.678ms      25.279us      37.633ms         0.00%      54.574ms      15.557us          3508  
                                             aten::add_         0.00%      47.471ms         0.01%      90.169ms      50.261us      54.362ms         0.01%      54.362ms      30.302us          1794  
                                         aten::randperm         0.00%      25.565ms         0.01%      51.224ms      25.612ms      25.601ms         0.00%      51.197ms      25.599ms             2  
                                                aten::t         0.00%      29.731ms         0.01%     119.089ms      85.064us      20.302ms         0.00%      44.986ms      32.133us          1400  
                                     DDP calculate loss         0.00%      13.215ms         0.00%      36.899ms     368.990us       9.565ms         0.00%      44.137ms     441.370us           100  
                                             aten::mul_         0.00%      28.721ms         0.01%      53.684ms      44.737us      40.498ms         0.00%      40.498ms      33.748us          1200  
autograd::engine::evaluate_function: NllLossBackward...         0.00%       7.972ms         0.00%      46.120ms     461.200us       4.421ms         0.00%      39.547ms     395.470us           100  
                                     train data prepare         0.00%      39.051ms         0.00%      39.080ms      39.080ms      39.070ms         0.00%      39.074ms      39.074ms             1  
                                       NllLossBackward0         0.00%       3.640ms         0.00%      33.347ms     333.470us       3.541ms         0.00%      35.126ms     351.260us           100  
                               aten::cross_entropy_loss         0.00%       1.562ms         0.00%      21.970ms     219.700us       2.121ms         0.00%      34.045ms     340.450us           100  
                                aten::nll_loss_backward         0.00%       8.886ms         0.00%      28.098ms     280.980us      18.028ms         0.00%      31.585ms     315.850us           100  
                                   DDP optimizer.zero()         0.00%       2.878ms         0.00%      34.349ms     343.490us       2.702ms         0.00%      30.658ms     306.580us           100  
                                        aten::new_empty         0.00%       9.710ms         0.00%      50.113ms      62.641us       9.915ms         0.00%      26.573ms      33.216us           800  
                                         aten::addcdiv_         0.00%      20.254ms         0.00%      32.868ms      54.780us      26.295ms         0.00%      26.295ms      43.825us           600  
                     Optimizer.zero_grad#Adam.zero_grad         0.00%       5.540ms         0.00%      26.709ms     267.090us       9.125ms         0.00%      26.107ms     261.070us           100  
                                           aten::unbind         0.00%       3.414ms         0.00%      26.722ms     267.220us       8.485ms         0.00%      25.782ms     257.820us           100  
                        torch::autograd::AccumulateGrad         0.00%      14.001ms         0.01%      62.379ms     103.965us      11.368ms         0.00%      25.308ms      42.180us           600  
                                        aten::transpose         0.00%      20.159ms         0.01%      71.507ms      51.076us      16.622ms         0.00%      24.684ms      17.631us          1400  
                                             aten::sqrt         0.00%      17.981ms         0.00%      30.966ms      51.610us      24.618ms         0.00%      24.618ms      41.030us           600  
                                      aten::nll_loss_nd         0.00%       1.013ms         0.00%      10.950ms     109.500us       1.039ms         0.00%      23.558ms     235.580us           100  
                                         aten::nll_loss         0.00%       1.001ms         0.00%       9.468ms      94.680us       1.009ms         0.00%      22.519ms     225.190us           100  
                                 aten::nll_loss_forward         0.00%       3.180ms         0.00%       8.022ms      80.220us      20.633ms         0.00%      21.510ms     215.100us           100  
                                         aten::addcmul_         0.00%      14.712ms         0.00%      27.193ms      45.322us      20.814ms         0.00%      20.814ms      34.690us           600  
                                            aten::fill_         0.00%      19.869ms         0.00%      36.557ms      33.053us      20.456ms         0.00%      20.456ms      18.495us          1106  
        autograd::engine::evaluate_function: TBackward0         0.00%       7.230ms         0.00%      48.615ms     162.050us       4.885ms         0.00%      19.410ms      64.700us           300  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%       3.497ms         0.00%      19.575ms     195.750us       4.985ms         0.00%      18.162ms     181.620us           100  
                                           aten::select         0.00%       6.256ms         0.00%      22.343ms      37.238us      12.528ms         0.00%      17.297ms      28.828us           600  
                                              aten::cat         0.00%       2.114ms         0.00%      17.639ms     176.390us       3.048ms         0.00%      16.700ms     167.000us           100  
                                             aten::item         0.00%       6.300ms         0.00%      23.070ms      38.450us      11.389ms         0.00%      16.643ms      27.738us           600  
                                             TBackward0         0.00%       4.592ms         0.00%      37.332ms     124.440us       4.577ms         0.00%      14.525ms      48.417us           300  
                                              aten::mul         0.00%      22.043ms         0.00%      39.377ms      65.628us      14.091ms         0.00%      14.091ms      23.485us           600  
                                             aten::_cat         0.00%       3.988ms         0.00%      14.529ms     145.290us       6.689ms         0.00%      13.652ms     136.520us           100  
                                    LogSoftmaxBackward0         0.00%       3.318ms         0.00%      14.506ms     145.060us       4.891ms         0.00%      13.177ms     131.770us           100  
                                      aten::log_softmax         0.00%       1.388ms         0.00%       8.896ms      88.960us       2.424ms         0.00%       8.366ms      83.660us           100  
                       aten::_log_softmax_backward_data         0.00%       5.111ms         0.00%       9.708ms      97.080us       8.286ms         0.00%       8.286ms      82.860us           100  
                                            aten::clamp         0.00%       8.107ms         0.00%      21.120ms      70.400us       3.048ms         0.00%       6.143ms      20.477us           300  
                                        aten::ones_like         0.00%     919.000us         0.00%       6.652ms      66.520us       1.848ms         0.00%       6.093ms      60.930us           100  
                                     aten::_log_softmax         0.00%       3.832ms         0.00%       5.985ms      59.850us       5.424ms         0.00%       5.424ms      54.240us           100  
                              aten::_local_scalar_dense         0.00%       5.164ms         0.00%      10.286ms      17.143us       5.254ms         0.00%       5.254ms       8.757us           600  
                                         aten::new_ones         0.00%       3.226ms         0.00%      30.226ms     100.753us     956.000us         0.00%       4.951ms      16.503us           300  
                                           aten::narrow         0.00%       1.187ms         0.00%       5.775ms      57.750us       2.084ms         0.00%       4.912ms      49.120us           100  
                                     aten::resolve_conj         0.00%       4.267ms         0.00%       8.928ms      14.880us       4.220ms         0.00%       4.220ms       7.033us           600  
                                             aten::ones         0.00%       4.599ms         0.00%      24.834ms      82.780us       1.563ms         0.00%       3.995ms      13.317us           300  
                                      aten::resolve_neg         0.00%       3.924ms         0.00%       8.335ms      13.892us       3.877ms         0.00%       3.877ms       6.462us           600  
                aten::_has_compatible_shallow_copy_type         0.00%       4.348ms         0.00%       7.926ms      19.815us       3.152ms         0.00%       3.152ms       7.880us           400  
                                       aten::zeros_like         0.00%     245.000us         0.00%       2.817ms     234.750us     539.000us         0.00%       2.649ms     220.750us            12  
                                           aten::expand         0.00%       2.532ms         0.00%       7.043ms      23.477us       1.887ms         0.00%       2.604ms       8.680us           300  
                                             aten::view         0.00%       5.852ms         0.00%       9.716ms      32.387us       2.577ms         0.00%       2.577ms       8.590us           300  
                                          aten::resize_         0.00%       5.107ms         0.00%       9.429ms      18.783us       2.180ms         0.00%       2.180ms       4.343us           502  
                                             aten::set_         0.00%       1.392ms         0.00%       2.325ms      22.794us     126.000us         0.00%     126.000us       1.235us           102  
                                           aten::detach         0.00%      68.000us         0.00%     278.000us      46.333us      67.000us         0.00%     108.000us      18.000us             6  
                                                 detach         0.00%      82.000us         0.00%     143.000us      23.833us      41.000us         0.00%      41.000us       6.833us             6  
                                    aten::scalar_tensor         0.00%       8.000us         0.00%      13.000us      13.000us       8.000us         0.00%       8.000us       8.000us             1  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 1024.070s
Self CUDA time total: 1024.052s

2023-03-16 19:03:06,561 - INFO - Rank 0 | wait sampler total time: 21.294522523880005, total iters: 100, avg iter time:0.21294522523880005
